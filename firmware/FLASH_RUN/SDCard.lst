   1              	 .syntax unified
   2              	 .cpu cortex-m3
   3              	 .fpu softvfp
   4              	 .eabi_attribute 20,1
   5              	 .eabi_attribute 21,1
   6              	 .eabi_attribute 23,3
   7              	 .eabi_attribute 24,1
   8              	 .eabi_attribute 25,1
   9              	 .eabi_attribute 26,1
  10              	 .eabi_attribute 30,1
  11              	 .eabi_attribute 34,1
  12              	 .eabi_attribute 18,4
  13              	 .thumb
  14              	 .file "SDCard.cc"
  15              	 .text
  16              	.Ltext0:
  17              	 .cfi_sections .debug_frame
  18              	 .section .text._ZN6sdcard13openPartitionEv,"ax",%progbits
  19              	 .align 2
  20              	 .global _ZN6sdcard13openPartitionEv
  21              	 .thumb
  22              	 .thumb_func
  24              	_ZN6sdcard13openPartitionEv:
  25              	.LFB101:
  26              	 .file 1 "src/MightyBoard/Motherboard/SDCard.cc"
   1:src/MightyBoard/Motherboard/SDCard.cc **** 	/*
   2:src/MightyBoard/Motherboard/SDCard.cc ****  * Copyright 2010 by Adam Mayer <adam@makerbot.com>
   3:src/MightyBoard/Motherboard/SDCard.cc ****  *
   4:src/MightyBoard/Motherboard/SDCard.cc ****  * This program is free software: you can redistribute it and/or modify
   5:src/MightyBoard/Motherboard/SDCard.cc ****  * it under the terms of the GNU General Public License as published by
   6:src/MightyBoard/Motherboard/SDCard.cc ****  * the Free Software Foundation, either version 3 of the License, or
   7:src/MightyBoard/Motherboard/SDCard.cc ****  * (at your option) any later version.
   8:src/MightyBoard/Motherboard/SDCard.cc ****  *
   9:src/MightyBoard/Motherboard/SDCard.cc ****  * This program is distributed in the hope that it will be useful,
  10:src/MightyBoard/Motherboard/SDCard.cc ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:src/MightyBoard/Motherboard/SDCard.cc ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:src/MightyBoard/Motherboard/SDCard.cc ****  * GNU General Public License for more details.
  13:src/MightyBoard/Motherboard/SDCard.cc ****  *
  14:src/MightyBoard/Motherboard/SDCard.cc ****  * You should have received a copy of the GNU General Public License
  15:src/MightyBoard/Motherboard/SDCard.cc ****  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  16:src/MightyBoard/Motherboard/SDCard.cc ****  */
  17:src/MightyBoard/Motherboard/SDCard.cc **** 
  18:src/MightyBoard/Motherboard/SDCard.cc **** #define __STDC_LIMIT_MACROS
  19:src/MightyBoard/Motherboard/SDCard.cc **** #include <stdint.h>
  20:src/MightyBoard/Motherboard/SDCard.cc **** #include "SDCard.hh"
  21:src/MightyBoard/Motherboard/SDCard.cc **** #include "Motherboard.hh"
  22:src/MightyBoard/Motherboard/SDCard.cc **** //#include <avr/io.h>
  23:src/MightyBoard/Motherboard/SDCard.cc **** #include <string.h>
  24:src/MightyBoard/Motherboard/SDCard.cc **** #include "lib_sd/sd-reader_config.h"
  25:src/MightyBoard/Motherboard/SDCard.cc **** #include "lib_sd/fat.h"
  26:src/MightyBoard/Motherboard/SDCard.cc **** #include "lib_sd/sd_raw.h"
  27:src/MightyBoard/Motherboard/SDCard.cc **** #include "lib_sd/partition.h"
  28:src/MightyBoard/Motherboard/SDCard.cc **** 
  29:src/MightyBoard/Motherboard/SDCard.cc **** #ifndef USE_DYNAMIC_MEMORY
  30:src/MightyBoard/Motherboard/SDCard.cc **** #error Dynamic memory should be explicitly disabled in the G3 mobo.
  31:src/MightyBoard/Motherboard/SDCard.cc **** #endif
  32:src/MightyBoard/Motherboard/SDCard.cc **** 
  33:src/MightyBoard/Motherboard/SDCard.cc **** #if (USE_DYNAMIC_MEMORY == 1)
  34:src/MightyBoard/Motherboard/SDCard.cc **** #error Dynamic memory should be explicitly disabled in the G3 mobo.
  35:src/MightyBoard/Motherboard/SDCard.cc **** #endif
  36:src/MightyBoard/Motherboard/SDCard.cc **** 
  37:src/MightyBoard/Motherboard/SDCard.cc **** namespace sdcard {
  38:src/MightyBoard/Motherboard/SDCard.cc **** 
  39:src/MightyBoard/Motherboard/SDCard.cc **** struct partition_struct* partition = 0;
  40:src/MightyBoard/Motherboard/SDCard.cc **** struct fat_fs_struct* fs = 0;
  41:src/MightyBoard/Motherboard/SDCard.cc **** struct fat_dir_struct* dd = 0;
  42:src/MightyBoard/Motherboard/SDCard.cc **** struct fat_file_struct* file = 0;
  43:src/MightyBoard/Motherboard/SDCard.cc **** 
  44:src/MightyBoard/Motherboard/SDCard.cc **** bool openPartition()
  45:src/MightyBoard/Motherboard/SDCard.cc **** {
  27              	 .loc 1 45 0
  28              	 .cfi_startproc
  29              	 
  30              	 
  31 0000 00B5     	 push {lr}
  32              	.LCFI0:
  33              	 .cfi_def_cfa_offset 4
  34              	 .cfi_offset 14,-4
  35 0002 83B0     	 sub sp,sp,#12
  36              	.LCFI1:
  37              	 .cfi_def_cfa_offset 16
  46:src/MightyBoard/Motherboard/SDCard.cc ****   /* open first partition */
  47:src/MightyBoard/Motherboard/SDCard.cc ****   partition = partition_open(sd_raw_read,
  48:src/MightyBoard/Motherboard/SDCard.cc ****                              sd_raw_read_interval,
  49:src/MightyBoard/Motherboard/SDCard.cc ****                              sd_raw_write,
  50:src/MightyBoard/Motherboard/SDCard.cc ****                              sd_raw_write_interval,
  51:src/MightyBoard/Motherboard/SDCard.cc ****                              0);
  38              	 .loc 1 51 0
  39 0004 4FF00003 	 mov r3,#0
  40 0008 0093     	 str r3,[sp,#0]
  41 000a 40F20000 	 movw r0,#:lower16:sd_raw_read
  42 000e C0F20000 	 movt r0,#:upper16:sd_raw_read
  43 0012 40F20001 	 movw r1,#:lower16:sd_raw_read_interval
  44 0016 C0F20001 	 movt r1,#:upper16:sd_raw_read_interval
  45 001a 40F20002 	 movw r2,#:lower16:sd_raw_write
  46 001e C0F20002 	 movt r2,#:upper16:sd_raw_write
  47 0022 40F20003 	 movw r3,#:lower16:sd_raw_write_interval
  48 0026 C0F20003 	 movt r3,#:upper16:sd_raw_write_interval
  49 002a FFF7FEFF 	 bl partition_open
  50 002e 40F20003 	 movw r3,#:lower16:.LANCHOR0
  51 0032 C0F20003 	 movt r3,#:upper16:.LANCHOR0
  52 0036 1860     	 str r0,[r3,#0]
  52:src/MightyBoard/Motherboard/SDCard.cc ****                              
  53:src/MightyBoard/Motherboard/SDCard.cc ****   if(!partition)
  53              	 .loc 1 53 0
  54 0038 C8B9     	 cbnz r0,.L2
  54:src/MightyBoard/Motherboard/SDCard.cc ****   {
  55:src/MightyBoard/Motherboard/SDCard.cc ****     /* If the partition did not open, assume the storage device
  56:src/MightyBoard/Motherboard/SDCard.cc ****     * is a "superfloppy", i.e. has no MBR.
  57:src/MightyBoard/Motherboard/SDCard.cc ****     */
  58:src/MightyBoard/Motherboard/SDCard.cc ****     partition = partition_open(sd_raw_read,
  59:src/MightyBoard/Motherboard/SDCard.cc ****                                sd_raw_read_interval,
  60:src/MightyBoard/Motherboard/SDCard.cc ****                                sd_raw_write,
  61:src/MightyBoard/Motherboard/SDCard.cc ****                                sd_raw_write_interval,
  62:src/MightyBoard/Motherboard/SDCard.cc ****                                -1);
  55              	 .loc 1 62 0
  56 003a 4FF0FF33 	 mov r3,#-1
  57 003e 0093     	 str r3,[sp,#0]
  58 0040 40F20000 	 movw r0,#:lower16:sd_raw_read
  59 0044 C0F20000 	 movt r0,#:upper16:sd_raw_read
  60 0048 40F20001 	 movw r1,#:lower16:sd_raw_read_interval
  61 004c C0F20001 	 movt r1,#:upper16:sd_raw_read_interval
  62 0050 40F20002 	 movw r2,#:lower16:sd_raw_write
  63 0054 C0F20002 	 movt r2,#:upper16:sd_raw_write
  64 0058 40F20003 	 movw r3,#:lower16:sd_raw_write_interval
  65 005c C0F20003 	 movt r3,#:upper16:sd_raw_write_interval
  66 0060 FFF7FEFF 	 bl partition_open
  67 0064 40F20003 	 movw r3,#:lower16:.LANCHOR0
  68 0068 C0F20003 	 movt r3,#:upper16:.LANCHOR0
  69 006c 1860     	 str r0,[r3,#0]
  70              	.L2:
  44:src/MightyBoard/Motherboard/SDCard.cc **** bool openPartition()
  71              	 .loc 1 44 0
  72 006e 40F20003 	 movw r3,#:lower16:.LANCHOR0
  73 0072 C0F20003 	 movt r3,#:upper16:.LANCHOR0
  74 0076 1868     	 ldr r0,[r3,#0]
  63:src/MightyBoard/Motherboard/SDCard.cc ****   }
  64:src/MightyBoard/Motherboard/SDCard.cc ****   if(!partition)
  65:src/MightyBoard/Motherboard/SDCard.cc ****     return false;
  66:src/MightyBoard/Motherboard/SDCard.cc ****   return true;
  67:src/MightyBoard/Motherboard/SDCard.cc **** }
  75              	 .loc 1 67 0
  76 0078 0030     	 adds r0,r0,#0
  77 007a 18BF     	 it ne
  78 007c 0120     	 movne r0,#1
  79 007e 03B0     	 add sp,sp,#12
  80 0080 00BD     	 pop {pc}
  81              	 .cfi_endproc
  82              	.LFE101:
  84 0082 00BF     	 .section .text._ZN6sdcard11openFilesysEv,"ax",%progbits
  85              	 .align 2
  86              	 .global _ZN6sdcard11openFilesysEv
  87              	 .thumb
  88              	 .thumb_func
  90              	_ZN6sdcard11openFilesysEv:
  91              	.LFB102:
  68:src/MightyBoard/Motherboard/SDCard.cc **** 
  69:src/MightyBoard/Motherboard/SDCard.cc **** bool openFilesys()
  70:src/MightyBoard/Motherboard/SDCard.cc **** {
  92              	 .loc 1 70 0
  93              	 .cfi_startproc
  94              	 
  95              	 
  96 0000 08B5     	 push {r3,lr}
  97              	.LCFI2:
  98              	 .cfi_def_cfa_offset 8
  99              	 .cfi_offset 14,-4
 100              	 .cfi_offset 3,-8
  71:src/MightyBoard/Motherboard/SDCard.cc ****   /* open file system */
  72:src/MightyBoard/Motherboard/SDCard.cc ****   fs = fat_open(partition);
 101              	 .loc 1 72 0
 102 0002 40F20003 	 movw r3,#:lower16:.LANCHOR0
 103 0006 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 104 000a 1868     	 ldr r0,[r3,#0]
 105 000c FFF7FEFF 	 bl fat_open
 106 0010 40F20003 	 movw r3,#:lower16:.LANCHOR1
 107 0014 C0F20003 	 movt r3,#:upper16:.LANCHOR1
 108 0018 1860     	 str r0,[r3,#0]
  73:src/MightyBoard/Motherboard/SDCard.cc ****   return fs != 0;
  74:src/MightyBoard/Motherboard/SDCard.cc **** }
 109              	 .loc 1 74 0
 110 001a 0030     	 adds r0,r0,#0
 111 001c 18BF     	 it ne
 112 001e 0120     	 movne r0,#1
 113 0020 08BD     	 pop {r3,pc}
 114              	 .cfi_endproc
 115              	.LFE102:
 117 0022 00BF     	 .section .text._ZN6sdcard8openRootEv,"ax",%progbits
 118              	 .align 2
 119              	 .global _ZN6sdcard8openRootEv
 120              	 .thumb
 121              	 .thumb_func
 123              	_ZN6sdcard8openRootEv:
 124              	.LFB103:
  75:src/MightyBoard/Motherboard/SDCard.cc **** 
  76:src/MightyBoard/Motherboard/SDCard.cc **** bool openRoot()
  77:src/MightyBoard/Motherboard/SDCard.cc **** {
 125              	 .loc 1 77 0
 126              	 .cfi_startproc
 127              	 
 128              	 
 129 0000 10B5     	 push {r4,lr}
 130              	.LCFI3:
 131              	 .cfi_def_cfa_offset 8
 132              	 .cfi_offset 14,-4
 133              	 .cfi_offset 4,-8
 134 0002 8CB0     	 sub sp,sp,#48
 135              	.LCFI4:
 136              	 .cfi_def_cfa_offset 56
 137              	.LBB18:
  78:src/MightyBoard/Motherboard/SDCard.cc ****   // Open root directory
  79:src/MightyBoard/Motherboard/SDCard.cc ****   struct fat_dir_entry_struct rootdirectory;
  80:src/MightyBoard/Motherboard/SDCard.cc ****   fat_get_dir_entry_of_path(fs, "/", &rootdirectory);
 138              	 .loc 1 80 0
 139 0004 40F20004 	 movw r4,#:lower16:.LANCHOR1
 140 0008 C0F20004 	 movt r4,#:upper16:.LANCHOR1
 141 000c 2068     	 ldr r0,[r4,#0]
 142 000e 40F20001 	 movw r1,#:lower16:.LC0
 143 0012 C0F20001 	 movt r1,#:upper16:.LC0
 144 0016 01AA     	 add r2,sp,#4
 145 0018 FFF7FEFF 	 bl fat_get_dir_entry_of_path
  81:src/MightyBoard/Motherboard/SDCard.cc ****   dd = fat_open_dir(fs, &rootdirectory);
 146              	 .loc 1 81 0
 147 001c 2068     	 ldr r0,[r4,#0]
 148 001e 01A9     	 add r1,sp,#4
 149 0020 FFF7FEFF 	 bl fat_open_dir
 150 0024 40F20003 	 movw r3,#:lower16:.LANCHOR2
 151 0028 C0F20003 	 movt r3,#:upper16:.LANCHOR2
 152 002c 1860     	 str r0,[r3,#0]
 153              	.LBE18:
  82:src/MightyBoard/Motherboard/SDCard.cc ****   return dd != 0;
  83:src/MightyBoard/Motherboard/SDCard.cc **** }
 154              	 .loc 1 83 0
 155 002e 0030     	 adds r0,r0,#0
 156 0030 18BF     	 it ne
 157 0032 0120     	 movne r0,#1
 158 0034 0CB0     	 add sp,sp,#48
 159 0036 10BD     	 pop {r4,pc}
 160              	 .cfi_endproc
 161              	.LFE103:
 163              	 .section .text._ZN6sdcard15checkVolumeSizeEv,"ax",%progbits
 164              	 .align 2
 165              	 .global _ZN6sdcard15checkVolumeSizeEv
 166              	 .thumb
 167              	 .thumb_func
 169              	_ZN6sdcard15checkVolumeSizeEv:
 170              	.LFB104:
  84:src/MightyBoard/Motherboard/SDCard.cc **** 
  85:src/MightyBoard/Motherboard/SDCard.cc **** bool checkVolumeSize(){
 171              	 .loc 1 85 0
 172              	 .cfi_startproc
 173              	 
 174              	 
 175 0000 08B5     	 push {r3,lr}
 176              	.LCFI5:
 177              	 .cfi_def_cfa_offset 8
 178              	 .cfi_offset 14,-4
 179              	 .cfi_offset 3,-8
  86:src/MightyBoard/Motherboard/SDCard.cc **** #if SD_RAW_SDHC 
  87:src/MightyBoard/Motherboard/SDCard.cc **** 	return true;
  88:src/MightyBoard/Motherboard/SDCard.cc **** #else
  89:src/MightyBoard/Motherboard/SDCard.cc **** 	return fat_get_fs_size(fs) < 2147483648; //2GB
 180              	 .loc 1 89 0
 181 0002 40F20003 	 movw r3,#:lower16:.LANCHOR1
 182 0006 C0F20003 	 movt r3,#:upper16:.LANCHOR1
 183 000a 1868     	 ldr r0,[r3,#0]
 184 000c FFF7FEFF 	 bl fat_get_fs_size
  90:src/MightyBoard/Motherboard/SDCard.cc **** #endif
  91:src/MightyBoard/Motherboard/SDCard.cc **** }
 185              	 .loc 1 91 0
 186 0010 6FEA0000 	 mvn r0,r0
 187 0014 4FEAD070 	 lsr r0,r0,#31
 188 0018 08BD     	 pop {r3,pc}
 189              	 .cfi_endproc
 190              	.LFE104:
 192 001a 00BF     	 .section .text._ZN6sdcard18directoryNextEntryEPchPh,"ax",%progbits
 193              	 .align 2
 194              	 .global _ZN6sdcard18directoryNextEntryEPchPh
 195              	 .thumb
 196              	 .thumb_func
 198              	_ZN6sdcard18directoryNextEntryEPchPh:
 199              	.LFB107:
  92:src/MightyBoard/Motherboard/SDCard.cc **** 
  93:src/MightyBoard/Motherboard/SDCard.cc **** 
  94:src/MightyBoard/Motherboard/SDCard.cc **** SdErrorCode initCard() {
  95:src/MightyBoard/Motherboard/SDCard.cc **** 	if (!sd_raw_init()) {;
  96:src/MightyBoard/Motherboard/SDCard.cc **** 		if (!sd_raw_available()) {
  97:src/MightyBoard/Motherboard/SDCard.cc **** 			reset();
  98:src/MightyBoard/Motherboard/SDCard.cc **** 			return SD_ERR_NO_CARD_PRESENT;
  99:src/MightyBoard/Motherboard/SDCard.cc **** 		} else {
 100:src/MightyBoard/Motherboard/SDCard.cc **** 			reset();
 101:src/MightyBoard/Motherboard/SDCard.cc **** 			return SD_ERR_INIT_FAILED;
 102:src/MightyBoard/Motherboard/SDCard.cc **** 		}
 103:src/MightyBoard/Motherboard/SDCard.cc **** 	} else if (!openPartition()) {
 104:src/MightyBoard/Motherboard/SDCard.cc **** 		reset();
 105:src/MightyBoard/Motherboard/SDCard.cc **** 		return SD_ERR_PARTITION_READ;
 106:src/MightyBoard/Motherboard/SDCard.cc **** 	} else if (!openFilesys()) {
 107:src/MightyBoard/Motherboard/SDCard.cc **** 		reset();
 108:src/MightyBoard/Motherboard/SDCard.cc **** 		return SD_ERR_OPEN_FILESYSTEM;
 109:src/MightyBoard/Motherboard/SDCard.cc **** 	} else if (!openRoot()) {
 110:src/MightyBoard/Motherboard/SDCard.cc **** 		reset();
 111:src/MightyBoard/Motherboard/SDCard.cc **** 		return SD_ERR_NO_ROOT;
 112:src/MightyBoard/Motherboard/SDCard.cc **** 	} else if (!checkVolumeSize()){
 113:src/MightyBoard/Motherboard/SDCard.cc **** 		reset();
 114:src/MightyBoard/Motherboard/SDCard.cc **** 		return SD_ERR_VOLUME_TOO_BIG;
 115:src/MightyBoard/Motherboard/SDCard.cc **** 		
 116:src/MightyBoard/Motherboard/SDCard.cc **** 	/* we need to keep locked as the last check */
 117:src/MightyBoard/Motherboard/SDCard.cc **** 	} else if (sd_raw_locked()) {
 118:src/MightyBoard/Motherboard/SDCard.cc **** 		return SD_ERR_CARD_LOCKED;
 119:src/MightyBoard/Motherboard/SDCard.cc **** 	}
 120:src/MightyBoard/Motherboard/SDCard.cc **** 	return SD_SUCCESS;
 121:src/MightyBoard/Motherboard/SDCard.cc **** }
 122:src/MightyBoard/Motherboard/SDCard.cc **** 
 123:src/MightyBoard/Motherboard/SDCard.cc **** SdErrorCode directoryReset() {
 124:src/MightyBoard/Motherboard/SDCard.cc ****   reset();
 125:src/MightyBoard/Motherboard/SDCard.cc ****   SdErrorCode rsp = initCard();
 126:src/MightyBoard/Motherboard/SDCard.cc ****   if (rsp != SD_SUCCESS && rsp != SD_ERR_CARD_LOCKED) {
 127:src/MightyBoard/Motherboard/SDCard.cc ****     return rsp;
 128:src/MightyBoard/Motherboard/SDCard.cc ****   }
 129:src/MightyBoard/Motherboard/SDCard.cc ****   fat_reset_dir(dd);
 130:src/MightyBoard/Motherboard/SDCard.cc ****   return SD_SUCCESS;
 131:src/MightyBoard/Motherboard/SDCard.cc **** }
 132:src/MightyBoard/Motherboard/SDCard.cc **** 
 133:src/MightyBoard/Motherboard/SDCard.cc **** SdErrorCode directoryNextEntry(char* buffer, uint8_t bufsize, uint8_t * fileLength) {
 200              	 .loc 1 133 0
 201              	 .cfi_startproc
 202              	 
 203              	 
 204              	.LVL0:
 205 0000 2DE9F041 	 push {r4,r5,r6,r7,r8,lr}
 206              	.LCFI6:
 207              	 .cfi_def_cfa_offset 24
 208              	 .cfi_offset 14,-4
 209              	 .cfi_offset 8,-8
 210              	 .cfi_offset 7,-12
 211              	 .cfi_offset 6,-16
 212              	 .cfi_offset 5,-20
 213              	 .cfi_offset 4,-24
 214 0004 8CB0     	 sub sp,sp,#48
 215              	.LCFI7:
 216              	 .cfi_def_cfa_offset 72
 217 0006 0446     	 mov r4,r0
 218 0008 9046     	 mov r8,r2
 219              	.LVL1:
 220              	 .loc 1 133 0
 221 000a 4FF00506 	 mov r6,#5
 222              	.LBB19:
 223              	.LBB20:
 134:src/MightyBoard/Motherboard/SDCard.cc **** 	struct fat_dir_entry_struct entry;
 135:src/MightyBoard/Motherboard/SDCard.cc **** 	// This is a bit of a hack.  For whatever reason, some filesystems return
 136:src/MightyBoard/Motherboard/SDCard.cc **** 	// files with nulls as the first character of their name.  This isn't
 137:src/MightyBoard/Motherboard/SDCard.cc **** 	// necessarily broken in of itself, but a null name is also our way
 138:src/MightyBoard/Motherboard/SDCard.cc **** 	// of signalling we've gone through the directory, so we discard these
 139:src/MightyBoard/Motherboard/SDCard.cc **** 	// entries.  We have an upper limit on the number of entries to cycle
 140:src/MightyBoard/Motherboard/SDCard.cc **** 	// through, so we don't potentially lock up here.
 141:src/MightyBoard/Motherboard/SDCard.cc **** 	uint8_t tries = 5;
 142:src/MightyBoard/Motherboard/SDCard.cc **** 	while (tries) {
 143:src/MightyBoard/Motherboard/SDCard.cc **** 		if (fat_read_dir(dd, &entry)) {
 224              	 .loc 1 143 0
 225 000e 40F20007 	 movw r7,#:lower16:.LANCHOR2
 226 0012 C0F20007 	 movt r7,#:upper16:.LANCHOR2
 227              	.LBB21:
 144:src/MightyBoard/Motherboard/SDCard.cc **** 			int i;
 145:src/MightyBoard/Motherboard/SDCard.cc **** 			for (i = 0; (i < bufsize-1) && entry.long_name[i] != 0; i++) {
 228              	 .loc 1 145 0
 229 0016 01F1FF35 	 add r5,r1,#-1
 230              	.LVL2:
 231              	.L11:
 232              	.LBE21:
 143:src/MightyBoard/Motherboard/SDCard.cc **** 		if (fat_read_dir(dd, &entry)) {
 233              	 .loc 1 143 0
 234 001a 3868     	 ldr r0,[r7,#0]
 235 001c 01A9     	 add r1,sp,#4
 236 001e FFF7FEFF 	 bl fat_read_dir
 237 0022 C0B1     	 cbz r0,.L7
 238 0024 4FF00003 	 mov r3,#0
 239              	.L9:
 240              	.LVL3:
 241              	.LBB22:
 242              	 .loc 1 145 0 discriminator 1
 243 0028 AB42     	 cmp r3,r5
 244 002a 1CDA     	 bge .L14
 245              	 .loc 1 145 0 is_stmt 0 discriminator 2
 246 002c 01AA     	 add r2,sp,#4
 247 002e 9A5C     	 ldrb r2,[r3,r2]
 248 0030 DAB1     	 cbz r2,.L15
 146:src/MightyBoard/Motherboard/SDCard.cc **** 				buffer[i] = entry.long_name[i];
 249              	 .loc 1 146 0 is_stmt 1 discriminator 5
 250 0032 01AA     	 add r2,sp,#4
 251 0034 D25C     	 ldrb r2,[r2,r3]
 252 0036 E254     	 strb r2,[r4,r3]
 145:src/MightyBoard/Motherboard/SDCard.cc **** 			for (i = 0; (i < bufsize-1) && entry.long_name[i] != 0; i++) {
 253              	 .loc 1 145 0 discriminator 5
 254 0038 03F10103 	 add r3,r3,#1
 255              	.LVL4:
 256 003c F4E7     	 b .L9
 257              	.LVL5:
 258              	.L18:
 147:src/MightyBoard/Motherboard/SDCard.cc **** 			}
 148:src/MightyBoard/Motherboard/SDCard.cc **** 			buffer[i] = 0;
 149:src/MightyBoard/Motherboard/SDCard.cc **** 			if (i > 0) {
 150:src/MightyBoard/Motherboard/SDCard.cc **** 				if(fileLength != 0)
 259              	 .loc 1 150 0
 260 003e B8F1000F 	 cmp r8,#0
 261 0042 0BD0     	 beq .L10
 151:src/MightyBoard/Motherboard/SDCard.cc **** 					*fileLength = i;
 262              	 .loc 1 151 0
 263 0044 88F80030 	 strb r3,[r8,#0]
 264 0048 08E0     	 b .L10
 265              	.L17:
 266 004a 06F1FF36 	 add r6,r6,#-1
 267 004e F6B2     	 uxtb r6,r6
 268              	.LBE22:
 269              	.LBE20:
 142:src/MightyBoard/Motherboard/SDCard.cc **** 	while (tries) {
 270              	 .loc 1 142 0
 271 0050 002E     	 cmp r6,#0
 272 0052 E2D1     	 bne .L11
 273 0054 02E0     	 b .L10
 274              	.LVL6:
 275              	.L7:
 276              	.LBB24:
 152:src/MightyBoard/Motherboard/SDCard.cc **** 				break;
 153:src/MightyBoard/Motherboard/SDCard.cc **** 			} else {
 154:src/MightyBoard/Motherboard/SDCard.cc **** 				tries--;
 155:src/MightyBoard/Motherboard/SDCard.cc **** 			}
 156:src/MightyBoard/Motherboard/SDCard.cc **** 		} else {
 157:src/MightyBoard/Motherboard/SDCard.cc **** 			buffer[0] = 0;
 277              	 .loc 1 157 0
 278 0056 4FF00003 	 mov r3,#0
 279 005a 2370     	 strb r3,[r4,#0]
 280              	.L10:
 281              	.LBE24:
 282              	.LBE19:
 158:src/MightyBoard/Motherboard/SDCard.cc **** 			break;
 159:src/MightyBoard/Motherboard/SDCard.cc **** 		}
 160:src/MightyBoard/Motherboard/SDCard.cc **** 	}
 161:src/MightyBoard/Motherboard/SDCard.cc **** 	return SD_SUCCESS;
 162:src/MightyBoard/Motherboard/SDCard.cc **** }
 283              	 .loc 1 162 0
 284 005c 4FF00000 	 mov r0,#0
 285 0060 0CB0     	 add sp,sp,#48
 286 0062 BDE8F081 	 pop {r4,r5,r6,r7,r8,pc}
 287              	.LVL7:
 288              	.L14:
 289              	.LBB26:
 290              	.LBB25:
 291              	.LBB23:
 145:src/MightyBoard/Motherboard/SDCard.cc **** 			for (i = 0; (i < bufsize-1) && entry.long_name[i] != 0; i++) {
 292              	 .loc 1 145 0
 293 0066 1A46     	 mov r2,r3
 294 0068 00E0     	 b .L8
 295              	.L15:
 296 006a 1A46     	 mov r2,r3
 297              	.L8:
 148:src/MightyBoard/Motherboard/SDCard.cc **** 			buffer[i] = 0;
 298              	 .loc 1 148 0
 299 006c 4FF00001 	 mov r1,#0
 300 0070 A154     	 strb r1,[r4,r2]
 149:src/MightyBoard/Motherboard/SDCard.cc **** 			if (i > 0) {
 301              	 .loc 1 149 0
 302 0072 8A42     	 cmp r2,r1
 303 0074 E9DD     	 ble .L17
 304 0076 E2E7     	 b .L18
 305              	.LBE23:
 306              	.LBE25:
 307              	.LBE26:
 308              	 .cfi_endproc
 309              	.LFE107:
 311              	 .section .text._ZN6sdcard13findFileInDirEPKcP20fat_dir_entry_struct,"ax",%progbits
 312              	 .align 2
 313              	 .global _ZN6sdcard13findFileInDirEPKcP20fat_dir_entry_struct
 314              	 .thumb
 315              	 .thumb_func
 317              	_ZN6sdcard13findFileInDirEPKcP20fat_dir_entry_struct:
 318              	.LFB108:
 163:src/MightyBoard/Motherboard/SDCard.cc **** 
 164:src/MightyBoard/Motherboard/SDCard.cc **** bool findFileInDir(const char* name, struct fat_dir_entry_struct* dir_entry)
 165:src/MightyBoard/Motherboard/SDCard.cc **** {
 319              	 .loc 1 165 0
 320              	 .cfi_startproc
 321              	 
 322              	 
 323              	.LVL8:
 324 0000 70B5     	 push {r4,r5,r6,lr}
 325              	.LCFI8:
 326              	 .cfi_def_cfa_offset 16
 327              	 .cfi_offset 14,-4
 328              	 .cfi_offset 6,-8
 329              	 .cfi_offset 5,-12
 330              	 .cfi_offset 4,-16
 331 0002 0646     	 mov r6,r0
 332 0004 0C46     	 mov r4,r1
 166:src/MightyBoard/Motherboard/SDCard.cc ****   while(fat_read_dir(dd, dir_entry))
 333              	 .loc 1 166 0
 334 0006 40F20005 	 movw r5,#:lower16:.LANCHOR2
 335 000a C0F20005 	 movt r5,#:upper16:.LANCHOR2
 336 000e 0EE0     	 b .L20
 337              	.LVL9:
 338              	.L22:
 167:src/MightyBoard/Motherboard/SDCard.cc ****   {
 168:src/MightyBoard/Motherboard/SDCard.cc ****     if(strcmp(dir_entry->long_name, name) == 0)
 339              	 .loc 1 168 0
 340 0010 2046     	 mov r0,r4
 341 0012 3146     	 mov r1,r6
 342 0014 FFF7FEFF 	 bl strcmp
 343 0018 48B9     	 cbnz r0,.L20
 169:src/MightyBoard/Motherboard/SDCard.cc ****     {
 170:src/MightyBoard/Motherboard/SDCard.cc ****       fat_reset_dir(dd);
 344              	 .loc 1 170 0
 345 001a 40F20003 	 movw r3,#:lower16:.LANCHOR2
 346 001e C0F20003 	 movt r3,#:upper16:.LANCHOR2
 347 0022 1868     	 ldr r0,[r3,#0]
 348 0024 FFF7FEFF 	 bl fat_reset_dir
 171:src/MightyBoard/Motherboard/SDCard.cc ****       return true;
 349              	 .loc 1 171 0
 350 0028 4FF00100 	 mov r0,#1
 351 002c 70BD     	 pop {r4,r5,r6,pc}
 352              	.L20:
 166:src/MightyBoard/Motherboard/SDCard.cc ****   while(fat_read_dir(dd, dir_entry))
 353              	 .loc 1 166 0 discriminator 1
 354 002e 2868     	 ldr r0,[r5,#0]
 355 0030 2146     	 mov r1,r4
 356 0032 FFF7FEFF 	 bl fat_read_dir
 357 0036 0028     	 cmp r0,#0
 358 0038 EAD1     	 bne .L22
 172:src/MightyBoard/Motherboard/SDCard.cc ****     }
 173:src/MightyBoard/Motherboard/SDCard.cc ****   }
 174:src/MightyBoard/Motherboard/SDCard.cc ****   return false;
 175:src/MightyBoard/Motherboard/SDCard.cc **** }
 359              	 .loc 1 175 0
 360 003a 70BD     	 pop {r4,r5,r6,pc}
 361              	 .cfi_endproc
 362              	.LFE108:
 364              	 .section .text._ZN6sdcard8openFileEPKcPP15fat_file_struct,"ax",%progbits
 365              	 .align 2
 366              	 .global _ZN6sdcard8openFileEPKcPP15fat_file_struct
 367              	 .thumb
 368              	 .thumb_func
 370              	_ZN6sdcard8openFileEPKcPP15fat_file_struct:
 371              	.LFB109:
 176:src/MightyBoard/Motherboard/SDCard.cc **** 
 177:src/MightyBoard/Motherboard/SDCard.cc **** bool openFile(const char* name, struct fat_file_struct** file)
 178:src/MightyBoard/Motherboard/SDCard.cc **** {
 372              	 .loc 1 178 0
 373              	 .cfi_startproc
 374              	 
 375              	 
 376              	.LVL10:
 377 0000 10B5     	 push {r4,lr}
 378              	.LCFI9:
 379              	 .cfi_def_cfa_offset 8
 380              	 .cfi_offset 14,-4
 381              	 .cfi_offset 4,-8
 382 0002 8CB0     	 sub sp,sp,#48
 383              	.LCFI10:
 384              	 .cfi_def_cfa_offset 56
 385 0004 0C46     	 mov r4,r1
 386              	.LBB27:
 179:src/MightyBoard/Motherboard/SDCard.cc ****   struct fat_dir_entry_struct fileEntry;
 180:src/MightyBoard/Motherboard/SDCard.cc ****   if(!findFileInDir(name, &fileEntry))
 387              	 .loc 1 180 0
 388 0006 01A9     	 add r1,sp,#4
 389              	.LVL11:
 390 0008 FFF7FEFF 	 bl _ZN6sdcard13findFileInDirEPKcP20fat_dir_entry_struct
 391              	.LVL12:
 392 000c 58B1     	 cbz r0,.L26
 181:src/MightyBoard/Motherboard/SDCard.cc ****   {
 182:src/MightyBoard/Motherboard/SDCard.cc ****     return false;
 183:src/MightyBoard/Motherboard/SDCard.cc ****   }
 184:src/MightyBoard/Motherboard/SDCard.cc **** 
 185:src/MightyBoard/Motherboard/SDCard.cc ****   *file = fat_open_file(fs, &fileEntry);
 393              	 .loc 1 185 0
 394 000e 40F20003 	 movw r3,#:lower16:.LANCHOR1
 395 0012 C0F20003 	 movt r3,#:upper16:.LANCHOR1
 396 0016 1868     	 ldr r0,[r3,#0]
 397 0018 01A9     	 add r1,sp,#4
 398 001a FFF7FEFF 	 bl fat_open_file
 399 001e 2060     	 str r0,[r4,#0]
 186:src/MightyBoard/Motherboard/SDCard.cc ****   return true;
 400              	 .loc 1 186 0
 401 0020 4FF00100 	 mov r0,#1
 402 0024 01E0     	 b .L25
 403              	.L26:
 182:src/MightyBoard/Motherboard/SDCard.cc ****     return false;
 404              	 .loc 1 182 0
 405 0026 4FF00000 	 mov r0,#0
 406              	.L25:
 407              	.LBE27:
 187:src/MightyBoard/Motherboard/SDCard.cc **** }
 408              	 .loc 1 187 0
 409 002a 0CB0     	 add sp,sp,#48
 410 002c 10BD     	 pop {r4,pc}
 411              	 .cfi_endproc
 412              	.LFE109:
 414 002e 00BF     	 .section .text._ZN6sdcard11getFileSizeEv,"ax",%progbits
 415              	 .align 2
 416              	 .global _ZN6sdcard11getFileSizeEv
 417              	 .thumb
 418              	 .thumb_func
 420              	_ZN6sdcard11getFileSizeEv:
 421              	.LFB110:
 188:src/MightyBoard/Motherboard/SDCard.cc **** 
 189:src/MightyBoard/Motherboard/SDCard.cc **** uint32_t getFileSize(){
 422              	 .loc 1 189 0
 423              	 .cfi_startproc
 424              	 
 425              	 
 426 0000 08B5     	 push {r3,lr}
 427              	.LCFI11:
 428              	 .cfi_def_cfa_offset 8
 429              	 .cfi_offset 14,-4
 430              	 .cfi_offset 3,-8
 190:src/MightyBoard/Motherboard/SDCard.cc **** 	return fat_get_file_size(file);
 431              	 .loc 1 190 0
 432 0002 40F20003 	 movw r3,#:lower16:.LANCHOR3
 433 0006 C0F20003 	 movt r3,#:upper16:.LANCHOR3
 434 000a 1868     	 ldr r0,[r3,#0]
 435 000c FFF7FEFF 	 bl fat_get_file_size
 191:src/MightyBoard/Motherboard/SDCard.cc **** }
 436              	 .loc 1 191 0
 437 0010 08BD     	 pop {r3,pc}
 438              	 .cfi_endproc
 439              	.LFE110:
 441 0012 00BF     	 .section .text._ZN6sdcard10deleteFileEPc,"ax",%progbits
 442              	 .align 2
 443              	 .global _ZN6sdcard10deleteFileEPc
 444              	 .thumb
 445              	 .thumb_func
 447              	_ZN6sdcard10deleteFileEPc:
 448              	.LFB111:
 192:src/MightyBoard/Motherboard/SDCard.cc **** 
 193:src/MightyBoard/Motherboard/SDCard.cc **** bool deleteFile(char *name)
 194:src/MightyBoard/Motherboard/SDCard.cc **** {
 449              	 .loc 1 194 0
 450              	 .cfi_startproc
 451              	 
 452              	 
 453              	.LVL13:
 454 0000 00B5     	 push {lr}
 455              	.LCFI12:
 456              	 .cfi_def_cfa_offset 4
 457              	 .cfi_offset 14,-4
 458 0002 8DB0     	 sub sp,sp,#52
 459              	.LCFI13:
 460              	 .cfi_def_cfa_offset 56
 461              	.LBB28:
 195:src/MightyBoard/Motherboard/SDCard.cc ****   struct fat_dir_entry_struct fileEntry;
 196:src/MightyBoard/Motherboard/SDCard.cc ****   if(!findFileInDir(name, &fileEntry))
 462              	 .loc 1 196 0
 463 0004 01A9     	 add r1,sp,#4
 464 0006 FFF7FEFF 	 bl _ZN6sdcard13findFileInDirEPKcP20fat_dir_entry_struct
 465              	.LVL14:
 466 000a 50B1     	 cbz r0,.L30
 197:src/MightyBoard/Motherboard/SDCard.cc ****   {
 198:src/MightyBoard/Motherboard/SDCard.cc ****     return false;
 199:src/MightyBoard/Motherboard/SDCard.cc ****   }
 200:src/MightyBoard/Motherboard/SDCard.cc ****   fat_delete_file(fs, &fileEntry);
 467              	 .loc 1 200 0
 468 000c 40F20003 	 movw r3,#:lower16:.LANCHOR1
 469 0010 C0F20003 	 movt r3,#:upper16:.LANCHOR1
 470 0014 1868     	 ldr r0,[r3,#0]
 471 0016 01A9     	 add r1,sp,#4
 472 0018 FFF7FEFF 	 bl fat_delete_file
 201:src/MightyBoard/Motherboard/SDCard.cc ****   return true;
 473              	 .loc 1 201 0
 474 001c 4FF00100 	 mov r0,#1
 475 0020 01E0     	 b .L29
 476              	.L30:
 198:src/MightyBoard/Motherboard/SDCard.cc ****     return false;
 477              	 .loc 1 198 0
 478 0022 4FF00000 	 mov r0,#0
 479              	.L29:
 480              	.LBE28:
 202:src/MightyBoard/Motherboard/SDCard.cc **** }
 481              	 .loc 1 202 0
 482 0026 0DB0     	 add sp,sp,#52
 483 0028 00BD     	 pop {pc}
 484              	 .cfi_endproc
 485              	.LFE111:
 487 002a 00BF     	 .section .text._ZN6sdcard10createFileEPc,"ax",%progbits
 488              	 .align 2
 489              	 .global _ZN6sdcard10createFileEPc
 490              	 .thumb
 491              	 .thumb_func
 493              	_ZN6sdcard10createFileEPc:
 494              	.LFB112:
 203:src/MightyBoard/Motherboard/SDCard.cc **** 
 204:src/MightyBoard/Motherboard/SDCard.cc **** bool createFile(char *name)
 205:src/MightyBoard/Motherboard/SDCard.cc **** {
 495              	 .loc 1 205 0
 496              	 .cfi_startproc
 497              	 
 498              	 
 499              	.LVL15:
 500 0000 00B5     	 push {lr}
 501              	.LCFI14:
 502              	 .cfi_def_cfa_offset 4
 503              	 .cfi_offset 14,-4
 504 0002 8DB0     	 sub sp,sp,#52
 505              	.LCFI15:
 506              	 .cfi_def_cfa_offset 56
 507 0004 0146     	 mov r1,r0
 508              	.LBB29:
 206:src/MightyBoard/Motherboard/SDCard.cc ****   struct fat_dir_entry_struct fileEntry;
 207:src/MightyBoard/Motherboard/SDCard.cc ****   return fat_create_file(dd, name, &fileEntry) != 0;
 509              	 .loc 1 207 0
 510 0006 40F20003 	 movw r3,#:lower16:.LANCHOR2
 511 000a C0F20003 	 movt r3,#:upper16:.LANCHOR2
 512 000e 1868     	 ldr r0,[r3,#0]
 513              	.LVL16:
 514 0010 01AA     	 add r2,sp,#4
 515 0012 FFF7FEFF 	 bl fat_create_file
 516              	.LVL17:
 517              	.LBE29:
 208:src/MightyBoard/Motherboard/SDCard.cc **** }
 518              	 .loc 1 208 0
 519 0016 0030     	 adds r0,r0,#0
 520 0018 18BF     	 it ne
 521 001a 0120     	 movne r0,#1
 522 001c 0DB0     	 add sp,sp,#52
 523 001e 00BD     	 pop {pc}
 524              	 .cfi_endproc
 525              	.LFE112:
 527              	 .section .text._ZN6sdcard9isPlayingEv,"ax",%progbits
 528              	 .align 2
 529              	 .global _ZN6sdcard9isPlayingEv
 530              	 .thumb
 531              	 .thumb_func
 533              	_ZN6sdcard9isPlayingEv:
 534              	.LFB113:
 209:src/MightyBoard/Motherboard/SDCard.cc **** 
 210:src/MightyBoard/Motherboard/SDCard.cc **** bool capturing = false;
 211:src/MightyBoard/Motherboard/SDCard.cc **** bool playing = false;
 212:src/MightyBoard/Motherboard/SDCard.cc **** uint32_t capturedBytes = 0L;
 213:src/MightyBoard/Motherboard/SDCard.cc **** 
 214:src/MightyBoard/Motherboard/SDCard.cc **** bool isPlaying() {
 535              	 .loc 1 214 0
 536              	 .cfi_startproc
 537              	 
 538              	 
 539              	 
 215:src/MightyBoard/Motherboard/SDCard.cc **** 	return playing;
 540              	 .loc 1 215 0
 541 0000 40F20003 	 movw r3,#:lower16:.LANCHOR4
 542 0004 C0F20003 	 movt r3,#:upper16:.LANCHOR4
 216:src/MightyBoard/Motherboard/SDCard.cc **** }
 543              	 .loc 1 216 0
 544 0008 1878     	 ldrb r0,[r3,#0]
 545 000a 7047     	 bx lr
 546              	 .cfi_endproc
 547              	.LFE113:
 549              	 .section .text._ZN6sdcard11isCapturingEv,"ax",%progbits
 550              	 .align 2
 551              	 .global _ZN6sdcard11isCapturingEv
 552              	 .thumb
 553              	 .thumb_func
 555              	_ZN6sdcard11isCapturingEv:
 556              	.LFB114:
 217:src/MightyBoard/Motherboard/SDCard.cc **** 
 218:src/MightyBoard/Motherboard/SDCard.cc **** bool isCapturing() {
 557              	 .loc 1 218 0
 558              	 .cfi_startproc
 559              	 
 560              	 
 561              	 
 219:src/MightyBoard/Motherboard/SDCard.cc **** 	return capturing;
 562              	 .loc 1 219 0
 563 0000 40F20003 	 movw r3,#:lower16:.LANCHOR5
 564 0004 C0F20003 	 movt r3,#:upper16:.LANCHOR5
 220:src/MightyBoard/Motherboard/SDCard.cc **** }
 565              	 .loc 1 220 0
 566 0008 1878     	 ldrb r0,[r3,#0]
 567 000a 7047     	 bx lr
 568              	 .cfi_endproc
 569              	.LFE114:
 571              	 .section .text._ZN6sdcard13capturePacketERK6Packet,"ax",%progbits
 572              	 .align 2
 573              	 .global _ZN6sdcard13capturePacketERK6Packet
 574              	 .thumb
 575              	 .thumb_func
 577              	_ZN6sdcard13capturePacketERK6Packet:
 578              	.LFB116:
 221:src/MightyBoard/Motherboard/SDCard.cc **** 
 222:src/MightyBoard/Motherboard/SDCard.cc **** SdErrorCode startCapture(char* filename)
 223:src/MightyBoard/Motherboard/SDCard.cc **** {
 224:src/MightyBoard/Motherboard/SDCard.cc ****   reset();
 225:src/MightyBoard/Motherboard/SDCard.cc ****   SdErrorCode result = initCard();
 226:src/MightyBoard/Motherboard/SDCard.cc ****   if (result != SD_SUCCESS) {
 227:src/MightyBoard/Motherboard/SDCard.cc ****     return result;
 228:src/MightyBoard/Motherboard/SDCard.cc ****   }
 229:src/MightyBoard/Motherboard/SDCard.cc ****   capturedBytes = 0L;
 230:src/MightyBoard/Motherboard/SDCard.cc ****   file = 0;
 231:src/MightyBoard/Motherboard/SDCard.cc ****   // Always operate in truncation mode.
 232:src/MightyBoard/Motherboard/SDCard.cc ****   deleteFile(filename);
 233:src/MightyBoard/Motherboard/SDCard.cc ****   if (!createFile(filename)) {
 234:src/MightyBoard/Motherboard/SDCard.cc ****     return SD_ERR_FILE_NOT_FOUND;
 235:src/MightyBoard/Motherboard/SDCard.cc ****   }
 236:src/MightyBoard/Motherboard/SDCard.cc **** 
 237:src/MightyBoard/Motherboard/SDCard.cc ****   if (!openFile(filename,&file)) {
 238:src/MightyBoard/Motherboard/SDCard.cc ****     return SD_ERR_PARTITION_READ;
 239:src/MightyBoard/Motherboard/SDCard.cc ****   }
 240:src/MightyBoard/Motherboard/SDCard.cc ****   if (file == 0) {
 241:src/MightyBoard/Motherboard/SDCard.cc ****     return SD_ERR_GENERIC;
 242:src/MightyBoard/Motherboard/SDCard.cc ****   }
 243:src/MightyBoard/Motherboard/SDCard.cc **** 
 244:src/MightyBoard/Motherboard/SDCard.cc ****   capturing = true;
 245:src/MightyBoard/Motherboard/SDCard.cc ****   return SD_SUCCESS;
 246:src/MightyBoard/Motherboard/SDCard.cc **** }
 247:src/MightyBoard/Motherboard/SDCard.cc **** 
 248:src/MightyBoard/Motherboard/SDCard.cc **** void capturePacket(const Packet& packet)
 249:src/MightyBoard/Motherboard/SDCard.cc **** {
 579              	 .loc 1 249 0
 580              	 .cfi_startproc
 581              	 
 582              	 
 583              	.LVL18:
 584 0000 10B5     	 push {r4,lr}
 585              	.LCFI16:
 586              	 .cfi_def_cfa_offset 8
 587              	 .cfi_offset 14,-4
 588              	 .cfi_offset 4,-8
 589 0002 0446     	 mov r4,r0
 250:src/MightyBoard/Motherboard/SDCard.cc **** 	if (file == 0) return;
 590              	 .loc 1 250 0
 591 0004 40F20003 	 movw r3,#:lower16:.LANCHOR3
 592 0008 C0F20003 	 movt r3,#:upper16:.LANCHOR3
 593 000c 1868     	 ldr r0,[r3,#0]
 594              	.LVL19:
 595 000e 60B1     	 cbz r0,.L34
 596              	.LVL20:
 597              	.LBB30:
 598              	.LBB31:
 599              	 .file 2 "src/MightyBoard/shared/Packet.hh"
   1:src/MightyBoard/shared/Packet.hh **** /*
   2:src/MightyBoard/shared/Packet.hh ****  * Copyright 2010 by Adam Mayer	 <adam@makerbot.com>
   3:src/MightyBoard/shared/Packet.hh ****  *
   4:src/MightyBoard/shared/Packet.hh ****  * This program is free software: you can redistribute it and/or modify
   5:src/MightyBoard/shared/Packet.hh ****  * it under the terms of the GNU General Public License as published by
   6:src/MightyBoard/shared/Packet.hh ****  * the Free Software Foundation, either version 3 of the License, or
   7:src/MightyBoard/shared/Packet.hh ****  * (at your option) any later version.
   8:src/MightyBoard/shared/Packet.hh ****  *
   9:src/MightyBoard/shared/Packet.hh ****  * This program is distributed in the hope that it will be useful,
  10:src/MightyBoard/shared/Packet.hh ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:src/MightyBoard/shared/Packet.hh ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:src/MightyBoard/shared/Packet.hh ****  * GNU General Public License for more details.
  13:src/MightyBoard/shared/Packet.hh ****  *
  14:src/MightyBoard/shared/Packet.hh ****  * You should have received a copy of the GNU General Public License
  15:src/MightyBoard/shared/Packet.hh ****  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  16:src/MightyBoard/shared/Packet.hh ****  */
  17:src/MightyBoard/shared/Packet.hh **** 
  18:src/MightyBoard/shared/Packet.hh **** #ifndef SHARED_PACKET_HH_
  19:src/MightyBoard/shared/Packet.hh **** #define SHARED_PACKET_HH_
  20:src/MightyBoard/shared/Packet.hh **** 
  21:src/MightyBoard/shared/Packet.hh **** #include <stdint.h>
  22:src/MightyBoard/shared/Packet.hh **** 
  23:src/MightyBoard/shared/Packet.hh **** extern "C" {
  24:src/MightyBoard/shared/Packet.hh **** #include "comm.h"
  25:src/MightyBoard/shared/Packet.hh **** }
  26:src/MightyBoard/shared/Packet.hh **** 
  27:src/MightyBoard/shared/Packet.hh **** #define START_BYTE 0xD5
  28:src/MightyBoard/shared/Packet.hh **** #define MAX_PACKET_PAYLOAD 32
  29:src/MightyBoard/shared/Packet.hh **** 
  30:src/MightyBoard/shared/Packet.hh **** #define SLAVE_ID_BROADCAST 127
  31:src/MightyBoard/shared/Packet.hh **** 
  32:src/MightyBoard/shared/Packet.hh **** namespace PacketError {
  33:src/MightyBoard/shared/Packet.hh **** enum {
  34:src/MightyBoard/shared/Packet.hh **** 	NO_ERROR,
  35:src/MightyBoard/shared/Packet.hh **** 	NOISE_BYTE,
  36:src/MightyBoard/shared/Packet.hh **** 	EXCEEDED_MAX_LENGTH,
  37:src/MightyBoard/shared/Packet.hh **** 	BAD_CRC,
  38:src/MightyBoard/shared/Packet.hh **** 	PACKET_TIMEOUT,
  39:src/MightyBoard/shared/Packet.hh **** };
  40:src/MightyBoard/shared/Packet.hh **** } // namespace PacketError
  41:src/MightyBoard/shared/Packet.hh **** 
  42:src/MightyBoard/shared/Packet.hh **** /// These are the response codes returned to the requestor
  43:src/MightyBoard/shared/Packet.hh **** /// as the first byte of the response payload.  You can find
  44:src/MightyBoard/shared/Packet.hh **** /// a list of the expected codes in the protocol specification
  45:src/MightyBoard/shared/Packet.hh **** /// document:
  46:src/MightyBoard/shared/Packet.hh **** /// http://docs.google.com/Doc?docid=0AcWKwJ2SAxDzZGd6amZyY2NfMmdtODRnZ2Ri&hl=en
  47:src/MightyBoard/shared/Packet.hh **** typedef enum {
  48:src/MightyBoard/shared/Packet.hh ****         RC_PACKET_ERROR    = 0x80, /* Generic Error. Is this packet simply discarded? */
  49:src/MightyBoard/shared/Packet.hh ****         RC_OK               = 0x81,
  50:src/MightyBoard/shared/Packet.hh ****         RC_BUFFER_OVERFLOW  = 0x82,
  51:src/MightyBoard/shared/Packet.hh ****         RC_CRC_MISMATCH     = 0x83,
  52:src/MightyBoard/shared/Packet.hh ****         RC_PACKET_LENGTH    = 0x84,
  53:src/MightyBoard/shared/Packet.hh ****         RC_CMD_UNSUPPORTED  = 0x85,
  54:src/MightyBoard/shared/Packet.hh ****         RC_EXPECT_MORE      = 0x86,
  55:src/MightyBoard/shared/Packet.hh ****         RC_DOWNSTREAM_TIMEOUT = 0x87,
  56:src/MightyBoard/shared/Packet.hh ****         RC_TOOL_LOCK_TIMEOUT = 0x88,
  57:src/MightyBoard/shared/Packet.hh ****         RC_CANCEL_BUILD		= 0x89, 
  58:src/MightyBoard/shared/Packet.hh ****         RC_BOT_BUILDING		= 0x8A,  // this response is returned if the bot is building from SD card 
  59:src/MightyBoard/shared/Packet.hh ****         RC_BOT_OVERHEAT		= 0x8B,	// if the bot overheats, it will not respond to commands
  60:src/MightyBoard/shared/Packet.hh ****         RC_PACKET_TIMEOUT	= 0x8C
  61:src/MightyBoard/shared/Packet.hh **** } ResponseCode;
  62:src/MightyBoard/shared/Packet.hh **** 
  63:src/MightyBoard/shared/Packet.hh **** /// Convenience function to accept old response codes
  64:src/MightyBoard/shared/Packet.hh **** /// (missing the high bits) as well as the new forms.
  65:src/MightyBoard/shared/Packet.hh **** inline bool rcCompare(uint8_t data, ResponseCode code) {
  66:src/MightyBoard/shared/Packet.hh **** 	return (data & 0x7f) == (code & 0x7f);
  67:src/MightyBoard/shared/Packet.hh **** }
  68:src/MightyBoard/shared/Packet.hh **** 
  69:src/MightyBoard/shared/Packet.hh **** class Packet {
  70:src/MightyBoard/shared/Packet.hh **** protected:
  71:src/MightyBoard/shared/Packet.hh **** 	// packet states
  72:src/MightyBoard/shared/Packet.hh **** 	typedef enum {
  73:src/MightyBoard/shared/Packet.hh **** 		PS_START,
  74:src/MightyBoard/shared/Packet.hh **** 		PS_LEN,
  75:src/MightyBoard/shared/Packet.hh **** 		PS_PAYLOAD,
  76:src/MightyBoard/shared/Packet.hh **** 		PS_CRC,
  77:src/MightyBoard/shared/Packet.hh **** 		PS_LAST
  78:src/MightyBoard/shared/Packet.hh **** 	} PacketState;
  79:src/MightyBoard/shared/Packet.hh **** 
  80:src/MightyBoard/shared/Packet.hh ****     volatile uint8_t length; /// The current length of the payload (data[0] if raw packets)
  81:src/MightyBoard/shared/Packet.hh ****     volatile uint8_t crc; /// The CRC of the current contents of the payload (data[-1] of raw packe
  82:src/MightyBoard/shared/Packet.hh ****     volatile uint8_t payload[MAX_PACKET_PAYLOAD]; /// Data payload (starts at data[2] of raw packet
  83:src/MightyBoard/shared/Packet.hh **** 	volatile uint8_t error_code; // Have any errors cropped up during processing?
  84:src/MightyBoard/shared/Packet.hh **** 	volatile PacketState state;
  85:src/MightyBoard/shared/Packet.hh **** 
  86:src/MightyBoard/shared/Packet.hh **** 
  87:src/MightyBoard/shared/Packet.hh **** 	/// Append a byte and update the CRC
  88:src/MightyBoard/shared/Packet.hh **** 	void appendByte(uint8_t data);
  89:src/MightyBoard/shared/Packet.hh **** 	/// Reset this packet to an empty state
  90:src/MightyBoard/shared/Packet.hh **** 	void reset();
  91:src/MightyBoard/shared/Packet.hh **** 
  92:src/MightyBoard/shared/Packet.hh **** 	void error(uint8_t error_code_in) {
  93:src/MightyBoard/shared/Packet.hh **** 		reset();
  94:src/MightyBoard/shared/Packet.hh **** 		error_code = error_code_in;
  95:src/MightyBoard/shared/Packet.hh **** 	}
  96:src/MightyBoard/shared/Packet.hh **** public:
  97:src/MightyBoard/shared/Packet.hh **** 	uint8_t getLength() const { return length; }
 600              	 .loc 2 97 0
 601 0010 2278     	 ldrb r2,[r4,#0]
 602              	.LBE31:
 603              	.LBE30:
 251:src/MightyBoard/Motherboard/SDCard.cc **** 	// Casting away volatile is OK in this instance; we know where the
 252:src/MightyBoard/Motherboard/SDCard.cc **** 	// data is located and that fat_write_file isn't caching
 253:src/MightyBoard/Motherboard/SDCard.cc **** 	fat_write_file(file, (uint8_t*)packet.getData(), packet.getLength());
 604              	 .loc 1 253 0
 605 0012 04F10201 	 add r1,r4,#2
 606 0016 FFF7FEFF 	 bl fat_write_file
 607              	.LVL21:
 608              	.LBB32:
 609              	.LBB33:
 610              	 .loc 2 97 0
 611 001a 2178     	 ldrb r1,[r4,#0]
 612              	.LBE33:
 613              	.LBE32:
 254:src/MightyBoard/Motherboard/SDCard.cc **** 	capturedBytes += packet.getLength();
 614              	 .loc 1 254 0
 615 001c 40F20003 	 movw r3,#:lower16:.LANCHOR6
 616 0020 C0F20003 	 movt r3,#:upper16:.LANCHOR6
 617 0024 1A68     	 ldr r2,[r3,#0]
 618 0026 8A18     	 adds r2,r1,r2
 619 0028 1A60     	 str r2,[r3,#0]
 620              	.LVL22:
 621              	.L34:
 622 002a 10BD     	 pop {r4,pc}
 623              	 .cfi_endproc
 624              	.LFE116:
 626              	 .section .text._ZN6sdcard13finishCaptureEv,"ax",%progbits
 627              	 .align 2
 628              	 .global _ZN6sdcard13finishCaptureEv
 629              	 .thumb
 630              	 .thumb_func
 632              	_ZN6sdcard13finishCaptureEv:
 633              	.LFB117:
 255:src/MightyBoard/Motherboard/SDCard.cc **** }
 256:src/MightyBoard/Motherboard/SDCard.cc **** 
 257:src/MightyBoard/Motherboard/SDCard.cc **** 
 258:src/MightyBoard/Motherboard/SDCard.cc **** uint32_t finishCapture()
 259:src/MightyBoard/Motherboard/SDCard.cc **** {
 634              	 .loc 1 259 0
 635              	 .cfi_startproc
 636              	 
 637              	 
 638 0000 08B5     	 push {r3,lr}
 639              	.LCFI17:
 640              	 .cfi_def_cfa_offset 8
 641              	 .cfi_offset 14,-4
 642              	 .cfi_offset 3,-8
 260:src/MightyBoard/Motherboard/SDCard.cc ****   if (capturing) {
 643              	 .loc 1 260 0
 644 0002 40F20003 	 movw r3,#:lower16:.LANCHOR5
 645 0006 C0F20003 	 movt r3,#:upper16:.LANCHOR5
 646 000a 1B78     	 ldrb r3,[r3,#0]
 647 000c ABB1     	 cbz r3,.L37
 261:src/MightyBoard/Motherboard/SDCard.cc ****     if (file != 0) {
 648              	 .loc 1 261 0
 649 000e 40F20003 	 movw r3,#:lower16:.LANCHOR3
 650 0012 C0F20003 	 movt r3,#:upper16:.LANCHOR3
 651 0016 1868     	 ldr r0,[r3,#0]
 652 0018 18B1     	 cbz r0,.L38
 262:src/MightyBoard/Motherboard/SDCard.cc ****     	fat_close_file(file);
 653              	 .loc 1 262 0
 654 001a FFF7FEFF 	 bl fat_close_file
 263:src/MightyBoard/Motherboard/SDCard.cc ****     	sd_raw_sync();
 655              	 .loc 1 263 0
 656 001e FFF7FEFF 	 bl sd_raw_sync
 657              	.L38:
 264:src/MightyBoard/Motherboard/SDCard.cc ****     }
 265:src/MightyBoard/Motherboard/SDCard.cc ****     file = 0;
 658              	 .loc 1 265 0
 659 0022 40F20003 	 movw r3,#:lower16:.LANCHOR3
 660 0026 C0F20003 	 movt r3,#:upper16:.LANCHOR3
 661 002a 4FF00002 	 mov r2,#0
 662 002e 1A60     	 str r2,[r3,#0]
 266:src/MightyBoard/Motherboard/SDCard.cc ****     capturing = false;
 663              	 .loc 1 266 0
 664 0030 40F20003 	 movw r3,#:lower16:.LANCHOR5
 665 0034 C0F20003 	 movt r3,#:upper16:.LANCHOR5
 666 0038 1A70     	 strb r2,[r3,#0]
 667              	.L37:
 267:src/MightyBoard/Motherboard/SDCard.cc ****   }
 268:src/MightyBoard/Motherboard/SDCard.cc ****   //reset();
 269:src/MightyBoard/Motherboard/SDCard.cc ****   return capturedBytes;
 668              	 .loc 1 269 0
 669 003a 40F20003 	 movw r3,#:lower16:.LANCHOR6
 670 003e C0F20003 	 movt r3,#:upper16:.LANCHOR6
 270:src/MightyBoard/Motherboard/SDCard.cc **** }
 671              	 .loc 1 270 0
 672 0042 1868     	 ldr r0,[r3,#0]
 673 0044 08BD     	 pop {r3,pc}
 674              	 .cfi_endproc
 675              	.LFE117:
 677 0046 00BF     	 .section .text._ZN6sdcard13fetchNextByteEv,"ax",%progbits
 678              	 .align 2
 679              	 .global _ZN6sdcard13fetchNextByteEv
 680              	 .thumb
 681              	 .thumb_func
 683              	_ZN6sdcard13fetchNextByteEv:
 684              	.LFB118:
 271:src/MightyBoard/Motherboard/SDCard.cc **** 
 272:src/MightyBoard/Motherboard/SDCard.cc **** uint8_t next_byte;
 273:src/MightyBoard/Motherboard/SDCard.cc **** bool has_more;
 274:src/MightyBoard/Motherboard/SDCard.cc **** bool retry;
 275:src/MightyBoard/Motherboard/SDCard.cc **** 
 276:src/MightyBoard/Motherboard/SDCard.cc **** void fetchNextByte() {
 685              	 .loc 1 276 0
 686              	 .cfi_startproc
 687              	 
 688              	 
 689 0000 08B5     	 push {r3,lr}
 690              	.LCFI18:
 691              	 .cfi_def_cfa_offset 8
 692              	 .cfi_offset 14,-4
 693              	 .cfi_offset 3,-8
 694              	.LBB34:
 277:src/MightyBoard/Motherboard/SDCard.cc ****   if(sd_raw_available()){
 695              	 .loc 1 277 0
 696 0002 FFF7FEFF 	 bl sd_raw_available
 697 0006 B8B1     	 cbz r0,.L40
 698              	.LBB35:
 278:src/MightyBoard/Motherboard/SDCard.cc **** 	int16_t read = fat_read_file(file, &next_byte, 1);
 699              	 .loc 1 278 0
 700 0008 40F20003 	 movw r3,#:lower16:.LANCHOR3
 701 000c C0F20003 	 movt r3,#:upper16:.LANCHOR3
 702 0010 1868     	 ldr r0,[r3,#0]
 703 0012 40F20001 	 movw r1,#:lower16:.LANCHOR7
 704 0016 C0F20001 	 movt r1,#:upper16:.LANCHOR7
 705 001a 4FF00102 	 mov r2,#1
 706 001e FFF7FEFF 	 bl fat_read_file
 707              	.LVL23:
 279:src/MightyBoard/Motherboard/SDCard.cc **** 	//retry = read < 0;
 280:src/MightyBoard/Motherboard/SDCard.cc **** 	has_more = read > 0;
 708              	 .loc 1 280 0
 709 0022 40F20003 	 movw r3,#:lower16:.LANCHOR8
 710 0026 C0F20003 	 movt r3,#:upper16:.LANCHOR8
 711 002a 00B2     	 sxth r0,r0
 712 002c 0028     	 cmp r0,#0
 713 002e D4BF     	 ite le
 714 0030 0020     	 movle r0,#0
 715              	.LVL24:
 716 0032 0120     	 movgt r0,#1
 717 0034 1870     	 strb r0,[r3,#0]
 718 0036 08BD     	 pop {r3,pc}
 719              	.L40:
 720              	.LBE35:
 281:src/MightyBoard/Motherboard/SDCard.cc ****   }else{
 282:src/MightyBoard/Motherboard/SDCard.cc **** 	Motherboard::getBoard().errorResponse("SD Card Removed", true);
 721              	 .loc 1 282 0
 722 0038 40F20000 	 movw r0,#:lower16:_ZN11Motherboard11motherboardE
 723 003c C0F20000 	 movt r0,#:upper16:_ZN11Motherboard11motherboardE
 724 0040 40F20001 	 movw r1,#:lower16:.LC1
 725 0044 C0F20001 	 movt r1,#:upper16:.LC1
 726 0048 4FF00102 	 mov r2,#1
 727 004c FFF7FEFF 	 bl _ZN11Motherboard13errorResponseEPcb
 283:src/MightyBoard/Motherboard/SDCard.cc **** 	has_more = 0;
 728              	 .loc 1 283 0
 729 0050 40F20003 	 movw r3,#:lower16:.LANCHOR8
 730 0054 C0F20003 	 movt r3,#:upper16:.LANCHOR8
 731 0058 4FF00002 	 mov r2,#0
 732 005c 1A70     	 strb r2,[r3,#0]
 284:src/MightyBoard/Motherboard/SDCard.cc **** 	retry = 0;
 733              	 .loc 1 284 0
 734 005e 40F20003 	 movw r3,#:lower16:.LANCHOR9
 735 0062 C0F20003 	 movt r3,#:upper16:.LANCHOR9
 736 0066 1A70     	 strb r2,[r3,#0]
 737 0068 08BD     	 pop {r3,pc}
 738              	.LBE34:
 739              	 .cfi_endproc
 740              	.LFE118:
 742 006a 00BF     	 .section .text._ZN6sdcard13playbackRetryEv,"ax",%progbits
 743              	 .align 2
 744              	 .global _ZN6sdcard13playbackRetryEv
 745              	 .thumb
 746              	 .thumb_func
 748              	_ZN6sdcard13playbackRetryEv:
 749              	.LFB119:
 285:src/MightyBoard/Motherboard/SDCard.cc **** 	}
 286:src/MightyBoard/Motherboard/SDCard.cc **** }
 287:src/MightyBoard/Motherboard/SDCard.cc **** 
 288:src/MightyBoard/Motherboard/SDCard.cc **** bool playbackRetry() {
 750              	 .loc 1 288 0
 751              	 .cfi_startproc
 752              	 
 753              	 
 754              	 
 289:src/MightyBoard/Motherboard/SDCard.cc **** 	return retry;
 755              	 .loc 1 289 0
 756 0000 40F20003 	 movw r3,#:lower16:.LANCHOR9
 757 0004 C0F20003 	 movt r3,#:upper16:.LANCHOR9
 290:src/MightyBoard/Motherboard/SDCard.cc **** }
 758              	 .loc 1 290 0
 759 0008 1878     	 ldrb r0,[r3,#0]
 760 000a 7047     	 bx lr
 761              	 .cfi_endproc
 762              	.LFE119:
 764              	 .section .text._ZN6sdcard15playbackHasNextEv,"ax",%progbits
 765              	 .align 2
 766              	 .global _ZN6sdcard15playbackHasNextEv
 767              	 .thumb
 768              	 .thumb_func
 770              	_ZN6sdcard15playbackHasNextEv:
 771              	.LFB120:
 291:src/MightyBoard/Motherboard/SDCard.cc **** 
 292:src/MightyBoard/Motherboard/SDCard.cc **** bool playbackHasNext() {
 772              	 .loc 1 292 0
 773              	 .cfi_startproc
 774              	 
 775              	 
 776              	 
 293:src/MightyBoard/Motherboard/SDCard.cc ****   return has_more;// || retry;
 777              	 .loc 1 293 0
 778 0000 40F20003 	 movw r3,#:lower16:.LANCHOR8
 779 0004 C0F20003 	 movt r3,#:upper16:.LANCHOR8
 294:src/MightyBoard/Motherboard/SDCard.cc **** }
 780              	 .loc 1 294 0
 781 0008 1878     	 ldrb r0,[r3,#0]
 782 000a 7047     	 bx lr
 783              	 .cfi_endproc
 784              	.LFE120:
 786              	 .section .text._ZN6sdcard12playbackNextEv,"ax",%progbits
 787              	 .align 2
 788              	 .global _ZN6sdcard12playbackNextEv
 789              	 .thumb
 790              	 .thumb_func
 792              	_ZN6sdcard12playbackNextEv:
 793              	.LFB121:
 295:src/MightyBoard/Motherboard/SDCard.cc **** 
 296:src/MightyBoard/Motherboard/SDCard.cc **** uint8_t playbackNext() {
 794              	 .loc 1 296 0
 795              	 .cfi_startproc
 796              	 
 797              	 
 798 0000 10B5     	 push {r4,lr}
 799              	.LCFI19:
 800              	 .cfi_def_cfa_offset 8
 801              	 .cfi_offset 14,-4
 802              	 .cfi_offset 4,-8
 803              	.LBB36:
 297:src/MightyBoard/Motherboard/SDCard.cc ****   uint8_t rv = next_byte;
 804              	 .loc 1 297 0
 805 0002 40F20003 	 movw r3,#:lower16:.LANCHOR7
 806 0006 C0F20003 	 movt r3,#:upper16:.LANCHOR7
 807 000a 1C78     	 ldrb r4,[r3,#0]
 808              	.LVL25:
 298:src/MightyBoard/Motherboard/SDCard.cc ****   fetchNextByte();
 809              	 .loc 1 298 0
 810 000c FFF7FEFF 	 bl _ZN6sdcard13fetchNextByteEv
 811              	.LBE36:
 299:src/MightyBoard/Motherboard/SDCard.cc ****   return rv;
 300:src/MightyBoard/Motherboard/SDCard.cc **** }
 812              	 .loc 1 300 0
 813 0010 2046     	 mov r0,r4
 814 0012 10BD     	 pop {r4,pc}
 815              	 .cfi_endproc
 816              	.LFE121:
 818              	 .section .text._ZN6sdcard14playbackRewindEh,"ax",%progbits
 819              	 .align 2
 820              	 .global _ZN6sdcard14playbackRewindEh
 821              	 .thumb
 822              	 .thumb_func
 824              	_ZN6sdcard14playbackRewindEh:
 825              	.LFB123:
 301:src/MightyBoard/Motherboard/SDCard.cc **** 
 302:src/MightyBoard/Motherboard/SDCard.cc **** SdErrorCode startPlayback(char* filename) {
 303:src/MightyBoard/Motherboard/SDCard.cc ****   reset();
 304:src/MightyBoard/Motherboard/SDCard.cc ****   SdErrorCode result = initCard();
 305:src/MightyBoard/Motherboard/SDCard.cc ****   /* for playback it's ok if the card is locked */
 306:src/MightyBoard/Motherboard/SDCard.cc ****   if (result != SD_SUCCESS && result != SD_ERR_CARD_LOCKED) {
 307:src/MightyBoard/Motherboard/SDCard.cc ****     return result;
 308:src/MightyBoard/Motherboard/SDCard.cc ****   }
 309:src/MightyBoard/Motherboard/SDCard.cc ****   capturedBytes = 0L;
 310:src/MightyBoard/Motherboard/SDCard.cc ****   file = 0;
 311:src/MightyBoard/Motherboard/SDCard.cc ****   if (!openFile(filename, &file) || file == 0) {
 312:src/MightyBoard/Motherboard/SDCard.cc ****     return SD_ERR_FILE_NOT_FOUND;
 313:src/MightyBoard/Motherboard/SDCard.cc ****   }
 314:src/MightyBoard/Motherboard/SDCard.cc ****   playing = true;
 315:src/MightyBoard/Motherboard/SDCard.cc ****   fetchNextByte();
 316:src/MightyBoard/Motherboard/SDCard.cc ****   return SD_SUCCESS;
 317:src/MightyBoard/Motherboard/SDCard.cc **** }
 318:src/MightyBoard/Motherboard/SDCard.cc **** 
 319:src/MightyBoard/Motherboard/SDCard.cc **** void playbackRewind(uint8_t bytes) {
 826              	 .loc 1 319 0
 827              	 .cfi_startproc
 828              	 
 829              	 
 830              	.LVL26:
 831 0000 00B5     	 push {lr}
 832              	.LCFI20:
 833              	 .cfi_def_cfa_offset 4
 834              	 .cfi_offset 14,-4
 835 0002 83B0     	 sub sp,sp,#12
 836              	.LCFI21:
 837              	 .cfi_def_cfa_offset 16
 838              	.LBB37:
 320:src/MightyBoard/Motherboard/SDCard.cc ****   int32_t offset = -((int32_t)bytes);
 839              	 .loc 1 320 0
 840 0004 C0F10000 	 rsb r0,r0,#0
 841              	.LVL27:
 842 0008 02A9     	 add r1,sp,#8
 843 000a 41F8040D 	 str r0,[r1,#-4]!
 844              	.LVL28:
 321:src/MightyBoard/Motherboard/SDCard.cc ****   fat_seek_file(file, &offset, FAT_SEEK_CUR);
 845              	 .loc 1 321 0
 846 000e 40F20003 	 movw r3,#:lower16:.LANCHOR3
 847 0012 C0F20003 	 movt r3,#:upper16:.LANCHOR3
 848 0016 1868     	 ldr r0,[r3,#0]
 849 0018 4FF00102 	 mov r2,#1
 850 001c FFF7FEFF 	 bl fat_seek_file
 851              	.LBE37:
 322:src/MightyBoard/Motherboard/SDCard.cc **** }
 852              	 .loc 1 322 0
 853 0020 03B0     	 add sp,sp,#12
 854 0022 00BD     	 pop {pc}
 855              	 .cfi_endproc
 856              	.LFE123:
 858              	 .section .text._ZN6sdcard14finishPlaybackEv,"ax",%progbits
 859              	 .align 2
 860              	 .global _ZN6sdcard14finishPlaybackEv
 861              	 .thumb
 862              	 .thumb_func
 864              	_ZN6sdcard14finishPlaybackEv:
 865              	.LFB124:
 323:src/MightyBoard/Motherboard/SDCard.cc **** 
 324:src/MightyBoard/Motherboard/SDCard.cc **** void finishPlayback() {
 866              	 .loc 1 324 0
 867              	 .cfi_startproc
 868              	 
 869              	 
 870 0000 08B5     	 push {r3,lr}
 871              	.LCFI22:
 872              	 .cfi_def_cfa_offset 8
 873              	 .cfi_offset 14,-4
 874              	 .cfi_offset 3,-8
 325:src/MightyBoard/Motherboard/SDCard.cc ****   playing = false;
 875              	 .loc 1 325 0
 876 0002 40F20003 	 movw r3,#:lower16:.LANCHOR4
 877 0006 C0F20003 	 movt r3,#:upper16:.LANCHOR4
 878 000a 4FF00002 	 mov r2,#0
 879 000e 1A70     	 strb r2,[r3,#0]
 326:src/MightyBoard/Motherboard/SDCard.cc ****   if (file != 0) {
 880              	 .loc 1 326 0
 881 0010 40F20003 	 movw r3,#:lower16:.LANCHOR3
 882 0014 C0F20003 	 movt r3,#:upper16:.LANCHOR3
 883 0018 1868     	 ldr r0,[r3,#0]
 884 001a 18B1     	 cbz r0,.L47
 327:src/MightyBoard/Motherboard/SDCard.cc **** 	  fat_close_file(file);
 885              	 .loc 1 327 0
 886 001c FFF7FEFF 	 bl fat_close_file
 328:src/MightyBoard/Motherboard/SDCard.cc **** 	  sd_raw_sync();
 887              	 .loc 1 328 0
 888 0020 FFF7FEFF 	 bl sd_raw_sync
 889              	.L47:
 329:src/MightyBoard/Motherboard/SDCard.cc ****   }
 330:src/MightyBoard/Motherboard/SDCard.cc ****   file = 0;
 890              	 .loc 1 330 0
 891 0024 40F20003 	 movw r3,#:lower16:.LANCHOR3
 892 0028 C0F20003 	 movt r3,#:upper16:.LANCHOR3
 893 002c 4FF00002 	 mov r2,#0
 894 0030 1A60     	 str r2,[r3,#0]
 331:src/MightyBoard/Motherboard/SDCard.cc **** }
 895              	 .loc 1 331 0
 896 0032 08BD     	 pop {r3,pc}
 897              	 .cfi_endproc
 898              	.LFE124:
 900              	 .section .text._ZN6sdcard5resetEv,"ax",%progbits
 901              	 .align 2
 902              	 .global _ZN6sdcard5resetEv
 903              	 .thumb
 904              	 .thumb_func
 906              	_ZN6sdcard5resetEv:
 907              	.LFB125:
 332:src/MightyBoard/Motherboard/SDCard.cc **** 
 333:src/MightyBoard/Motherboard/SDCard.cc **** 
 334:src/MightyBoard/Motherboard/SDCard.cc **** void reset() {
 908              	 .loc 1 334 0
 909              	 .cfi_startproc
 910              	 
 911              	 
 912 0000 08B5     	 push {r3,lr}
 913              	.LCFI23:
 914              	 .cfi_def_cfa_offset 8
 915              	 .cfi_offset 14,-4
 916              	 .cfi_offset 3,-8
 335:src/MightyBoard/Motherboard/SDCard.cc **** 	if (playing)
 917              	 .loc 1 335 0
 918 0002 40F20003 	 movw r3,#:lower16:.LANCHOR4
 919 0006 C0F20003 	 movt r3,#:upper16:.LANCHOR4
 920 000a 1B78     	 ldrb r3,[r3,#0]
 921 000c 0BB1     	 cbz r3,.L49
 336:src/MightyBoard/Motherboard/SDCard.cc **** 		finishPlayback();
 922              	 .loc 1 336 0
 923 000e FFF7FEFF 	 bl _ZN6sdcard14finishPlaybackEv
 924              	.L49:
 337:src/MightyBoard/Motherboard/SDCard.cc **** 	if (capturing)
 925              	 .loc 1 337 0
 926 0012 40F20003 	 movw r3,#:lower16:.LANCHOR5
 927 0016 C0F20003 	 movt r3,#:upper16:.LANCHOR5
 928 001a 1B78     	 ldrb r3,[r3,#0]
 929 001c 0BB1     	 cbz r3,.L50
 338:src/MightyBoard/Motherboard/SDCard.cc **** 		finishCapture();
 930              	 .loc 1 338 0
 931 001e FFF7FEFF 	 bl _ZN6sdcard13finishCaptureEv
 932              	.L50:
 339:src/MightyBoard/Motherboard/SDCard.cc **** 	if (dd != 0) {
 933              	 .loc 1 339 0
 934 0022 40F20003 	 movw r3,#:lower16:.LANCHOR2
 935 0026 C0F20003 	 movt r3,#:upper16:.LANCHOR2
 936 002a 1868     	 ldr r0,[r3,#0]
 937 002c 40B1     	 cbz r0,.L51
 340:src/MightyBoard/Motherboard/SDCard.cc **** 		fat_close_dir(dd);
 938              	 .loc 1 340 0
 939 002e FFF7FEFF 	 bl fat_close_dir
 341:src/MightyBoard/Motherboard/SDCard.cc **** 		dd = 0;
 940              	 .loc 1 341 0
 941 0032 40F20003 	 movw r3,#:lower16:.LANCHOR2
 942 0036 C0F20003 	 movt r3,#:upper16:.LANCHOR2
 943 003a 4FF00002 	 mov r2,#0
 944 003e 1A60     	 str r2,[r3,#0]
 945              	.L51:
 342:src/MightyBoard/Motherboard/SDCard.cc **** 	}
 343:src/MightyBoard/Motherboard/SDCard.cc **** 	if (fs != 0) {
 946              	 .loc 1 343 0
 947 0040 40F20003 	 movw r3,#:lower16:.LANCHOR1
 948 0044 C0F20003 	 movt r3,#:upper16:.LANCHOR1
 949 0048 1868     	 ldr r0,[r3,#0]
 950 004a 40B1     	 cbz r0,.L52
 344:src/MightyBoard/Motherboard/SDCard.cc **** 		fat_close(fs);
 951              	 .loc 1 344 0
 952 004c FFF7FEFF 	 bl fat_close
 345:src/MightyBoard/Motherboard/SDCard.cc **** 		fs = 0;
 953              	 .loc 1 345 0
 954 0050 40F20003 	 movw r3,#:lower16:.LANCHOR1
 955 0054 C0F20003 	 movt r3,#:upper16:.LANCHOR1
 956 0058 4FF00002 	 mov r2,#0
 957 005c 1A60     	 str r2,[r3,#0]
 958              	.L52:
 346:src/MightyBoard/Motherboard/SDCard.cc **** 	}
 347:src/MightyBoard/Motherboard/SDCard.cc **** 	if (partition != 0) {
 959              	 .loc 1 347 0
 960 005e 40F20003 	 movw r3,#:lower16:.LANCHOR0
 961 0062 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 962 0066 1868     	 ldr r0,[r3,#0]
 963 0068 40B1     	 cbz r0,.L48
 348:src/MightyBoard/Motherboard/SDCard.cc **** 		partition_close(partition);
 964              	 .loc 1 348 0
 965 006a FFF7FEFF 	 bl partition_close
 349:src/MightyBoard/Motherboard/SDCard.cc **** 		partition = 0;
 966              	 .loc 1 349 0
 967 006e 40F20003 	 movw r3,#:lower16:.LANCHOR0
 968 0072 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 969 0076 4FF00002 	 mov r2,#0
 970 007a 1A60     	 str r2,[r3,#0]
 971              	.L48:
 972 007c 08BD     	 pop {r3,pc}
 973              	 .cfi_endproc
 974              	.LFE125:
 976 007e 00BF     	 .section .text._ZN6sdcard8initCardEv,"ax",%progbits
 977              	 .align 2
 978              	 .global _ZN6sdcard8initCardEv
 979              	 .thumb
 980              	 .thumb_func
 982              	_ZN6sdcard8initCardEv:
 983              	.LFB105:
  94:src/MightyBoard/Motherboard/SDCard.cc **** SdErrorCode initCard() {
 984              	 .loc 1 94 0
 985              	 .cfi_startproc
 986              	 
 987              	 
 988 0000 08B5     	 push {r3,lr}
 989              	.LCFI24:
 990              	 .cfi_def_cfa_offset 8
 991              	 .cfi_offset 14,-4
 992              	 .cfi_offset 3,-8
  95:src/MightyBoard/Motherboard/SDCard.cc **** 	if (!sd_raw_init()) {;
 993              	 .loc 1 95 0
 994 0002 FFF7FEFF 	 bl sd_raw_init
 995 0006 60B9     	 cbnz r0,.L55
  96:src/MightyBoard/Motherboard/SDCard.cc **** 		if (!sd_raw_available()) {
 996              	 .loc 1 96 0
 997 0008 FFF7FEFF 	 bl sd_raw_available
 998 000c 20B9     	 cbnz r0,.L56
  97:src/MightyBoard/Motherboard/SDCard.cc **** 			reset();
 999              	 .loc 1 97 0
 1000 000e FFF7FEFF 	 bl _ZN6sdcard5resetEv
  98:src/MightyBoard/Motherboard/SDCard.cc **** 			return SD_ERR_NO_CARD_PRESENT;
 1001              	 .loc 1 98 0
 1002 0012 4FF00100 	 mov r0,#1
 1003 0016 08BD     	 pop {r3,pc}
 1004              	.L56:
 100:src/MightyBoard/Motherboard/SDCard.cc **** 			reset();
 1005              	 .loc 1 100 0
 1006 0018 FFF7FEFF 	 bl _ZN6sdcard5resetEv
 101:src/MightyBoard/Motherboard/SDCard.cc **** 			return SD_ERR_INIT_FAILED;
 1007              	 .loc 1 101 0
 1008 001c 4FF00200 	 mov r0,#2
 1009 0020 08BD     	 pop {r3,pc}
 1010              	.L55:
 103:src/MightyBoard/Motherboard/SDCard.cc **** 	} else if (!openPartition()) {
 1011              	 .loc 1 103 0
 1012 0022 FFF7FEFF 	 bl _ZN6sdcard13openPartitionEv
 1013 0026 20B9     	 cbnz r0,.L58
 104:src/MightyBoard/Motherboard/SDCard.cc **** 		reset();
 1014              	 .loc 1 104 0
 1015 0028 FFF7FEFF 	 bl _ZN6sdcard5resetEv
 105:src/MightyBoard/Motherboard/SDCard.cc **** 		return SD_ERR_PARTITION_READ;
 1016              	 .loc 1 105 0
 1017 002c 4FF00300 	 mov r0,#3
 1018 0030 08BD     	 pop {r3,pc}
 1019              	.L58:
 106:src/MightyBoard/Motherboard/SDCard.cc **** 	} else if (!openFilesys()) {
 1020              	 .loc 1 106 0
 1021 0032 FFF7FEFF 	 bl _ZN6sdcard11openFilesysEv
 1022 0036 20B9     	 cbnz r0,.L59
 107:src/MightyBoard/Motherboard/SDCard.cc **** 		reset();
 1023              	 .loc 1 107 0
 1024 0038 FFF7FEFF 	 bl _ZN6sdcard5resetEv
 108:src/MightyBoard/Motherboard/SDCard.cc **** 		return SD_ERR_OPEN_FILESYSTEM;
 1025              	 .loc 1 108 0
 1026 003c 4FF00400 	 mov r0,#4
 1027 0040 08BD     	 pop {r3,pc}
 1028              	.L59:
 109:src/MightyBoard/Motherboard/SDCard.cc **** 	} else if (!openRoot()) {
 1029              	 .loc 1 109 0
 1030 0042 FFF7FEFF 	 bl _ZN6sdcard8openRootEv
 1031 0046 20B9     	 cbnz r0,.L60
 110:src/MightyBoard/Motherboard/SDCard.cc **** 		reset();
 1032              	 .loc 1 110 0
 1033 0048 FFF7FEFF 	 bl _ZN6sdcard5resetEv
 111:src/MightyBoard/Motherboard/SDCard.cc **** 		return SD_ERR_NO_ROOT;
 1034              	 .loc 1 111 0
 1035 004c 4FF00500 	 mov r0,#5
 1036 0050 08BD     	 pop {r3,pc}
 1037              	.L60:
 112:src/MightyBoard/Motherboard/SDCard.cc **** 	} else if (!checkVolumeSize()){
 1038              	 .loc 1 112 0
 1039 0052 FFF7FEFF 	 bl _ZN6sdcard15checkVolumeSizeEv
 1040 0056 20B9     	 cbnz r0,.L61
 113:src/MightyBoard/Motherboard/SDCard.cc **** 		reset();
 1041              	 .loc 1 113 0
 1042 0058 FFF7FEFF 	 bl _ZN6sdcard5resetEv
 114:src/MightyBoard/Motherboard/SDCard.cc **** 		return SD_ERR_VOLUME_TOO_BIG;
 1043              	 .loc 1 114 0
 1044 005c 4FF00A00 	 mov r0,#10
 1045 0060 08BD     	 pop {r3,pc}
 1046              	.L61:
 117:src/MightyBoard/Motherboard/SDCard.cc **** 	} else if (sd_raw_locked()) {
 1047              	 .loc 1 117 0
 1048 0062 FFF7FEFF 	 bl sd_raw_locked
 118:src/MightyBoard/Motherboard/SDCard.cc **** 		return SD_ERR_CARD_LOCKED;
 1049              	 .loc 1 118 0
 1050 0066 0028     	 cmp r0,#0
 1051 0068 14BF     	 ite ne
 1052 006a 0620     	 movne r0,#6
 1053 006c 0020     	 moveq r0,#0
 121:src/MightyBoard/Motherboard/SDCard.cc **** }
 1054              	 .loc 1 121 0
 1055 006e 08BD     	 pop {r3,pc}
 1056              	 .cfi_endproc
 1057              	.LFE105:
 1059              	 .section .text._ZN6sdcard13startPlaybackEPc,"ax",%progbits
 1060              	 .align 2
 1061              	 .global _ZN6sdcard13startPlaybackEPc
 1062              	 .thumb
 1063              	 .thumb_func
 1065              	_ZN6sdcard13startPlaybackEPc:
 1066              	.LFB122:
 302:src/MightyBoard/Motherboard/SDCard.cc **** SdErrorCode startPlayback(char* filename) {
 1067              	 .loc 1 302 0
 1068              	 .cfi_startproc
 1069              	 
 1070              	 
 1071              	.LVL29:
 1072 0000 10B5     	 push {r4,lr}
 1073              	.LCFI25:
 1074              	 .cfi_def_cfa_offset 8
 1075              	 .cfi_offset 14,-4
 1076              	 .cfi_offset 4,-8
 1077 0002 0446     	 mov r4,r0
 1078              	.LBB38:
 303:src/MightyBoard/Motherboard/SDCard.cc ****   reset();
 1079              	 .loc 1 303 0
 1080 0004 FFF7FEFF 	 bl _ZN6sdcard5resetEv
 1081              	.LVL30:
 304:src/MightyBoard/Motherboard/SDCard.cc ****   SdErrorCode result = initCard();
 1082              	 .loc 1 304 0
 1083 0008 FFF7FEFF 	 bl _ZN6sdcard8initCardEv
 1084              	.LVL31:
 306:src/MightyBoard/Motherboard/SDCard.cc ****   if (result != SD_SUCCESS && result != SD_ERR_CARD_LOCKED) {
 1085              	 .loc 1 306 0
 1086 000c 0346     	 mov r3,r0
 1087 000e 821F     	 subs r2,r0,#6
 1088 0010 18BF     	 it ne
 1089 0012 0122     	 movne r2,#1
 1090 0014 0028     	 cmp r0,#0
 1091 0016 0CBF     	 ite eq
 1092 0018 0022     	 moveq r2,#0
 1093 001a 02F00102 	 andne r2,r2,#1
 1094 001e 1ABB     	 cbnz r2,.L64
 309:src/MightyBoard/Motherboard/SDCard.cc ****   capturedBytes = 0L;
 1095              	 .loc 1 309 0
 1096 0020 40F20003 	 movw r3,#:lower16:.LANCHOR6
 1097 0024 C0F20003 	 movt r3,#:upper16:.LANCHOR6
 1098 0028 1A60     	 str r2,[r3,#0]
 310:src/MightyBoard/Motherboard/SDCard.cc ****   file = 0;
 1099              	 .loc 1 310 0
 1100 002a 40F20001 	 movw r1,#:lower16:.LANCHOR3
 1101 002e C0F20001 	 movt r1,#:upper16:.LANCHOR3
 1102 0032 0A60     	 str r2,[r1,#0]
 311:src/MightyBoard/Motherboard/SDCard.cc ****   if (!openFile(filename, &file) || file == 0) {
 1103              	 .loc 1 311 0
 1104 0034 2046     	 mov r0,r4
 1105              	.LVL32:
 1106 0036 FFF7FEFF 	 bl _ZN6sdcard8openFileEPKcPP15fat_file_struct
 312:src/MightyBoard/Motherboard/SDCard.cc ****     return SD_ERR_FILE_NOT_FOUND;
 1107              	 .loc 1 312 0
 1108 003a 4FF00703 	 mov r3,#7
 311:src/MightyBoard/Motherboard/SDCard.cc ****   if (!openFile(filename, &file) || file == 0) {
 1109              	 .loc 1 311 0
 1110 003e 98B1     	 cbz r0,.L64
 311:src/MightyBoard/Motherboard/SDCard.cc ****   if (!openFile(filename, &file) || file == 0) {
 1111              	 .loc 1 311 0 is_stmt 0 discriminator 2
 1112 0040 40F20003 	 movw r3,#:lower16:.LANCHOR3
 1113 0044 C0F20003 	 movt r3,#:upper16:.LANCHOR3
 1114 0048 1B68     	 ldr r3,[r3,#0]
 1115 004a 5BB1     	 cbz r3,.L66
 314:src/MightyBoard/Motherboard/SDCard.cc ****   playing = true;
 1116              	 .loc 1 314 0 is_stmt 1
 1117 004c 40F20003 	 movw r3,#:lower16:.LANCHOR4
 1118 0050 C0F20003 	 movt r3,#:upper16:.LANCHOR4
 1119 0054 4FF00102 	 mov r2,#1
 1120 0058 1A70     	 strb r2,[r3,#0]
 315:src/MightyBoard/Motherboard/SDCard.cc ****   fetchNextByte();
 1121              	 .loc 1 315 0
 1122 005a FFF7FEFF 	 bl _ZN6sdcard13fetchNextByteEv
 316:src/MightyBoard/Motherboard/SDCard.cc ****   return SD_SUCCESS;
 1123              	 .loc 1 316 0
 1124 005e 4FF00003 	 mov r3,#0
 1125 0062 01E0     	 b .L64
 1126              	.L66:
 312:src/MightyBoard/Motherboard/SDCard.cc ****     return SD_ERR_FILE_NOT_FOUND;
 1127              	 .loc 1 312 0
 1128 0064 4FF00703 	 mov r3,#7
 1129              	.L64:
 1130              	.LBE38:
 317:src/MightyBoard/Motherboard/SDCard.cc **** }
 1131              	 .loc 1 317 0
 1132 0068 1846     	 mov r0,r3
 1133 006a 10BD     	 pop {r4,pc}
 1134              	 .cfi_endproc
 1135              	.LFE122:
 1137              	 .section .text._ZN6sdcard12startCaptureEPc,"ax",%progbits
 1138              	 .align 2
 1139              	 .global _ZN6sdcard12startCaptureEPc
 1140              	 .thumb
 1141              	 .thumb_func
 1143              	_ZN6sdcard12startCaptureEPc:
 1144              	.LFB115:
 223:src/MightyBoard/Motherboard/SDCard.cc **** {
 1145              	 .loc 1 223 0
 1146              	 .cfi_startproc
 1147              	 
 1148              	 
 1149              	.LVL33:
 1150 0000 38B5     	 push {r3,r4,r5,lr}
 1151              	.LCFI26:
 1152              	 .cfi_def_cfa_offset 16
 1153              	 .cfi_offset 14,-4
 1154              	 .cfi_offset 5,-8
 1155              	 .cfi_offset 4,-12
 1156              	 .cfi_offset 3,-16
 1157 0002 0546     	 mov r5,r0
 1158              	.LBB39:
 224:src/MightyBoard/Motherboard/SDCard.cc ****   reset();
 1159              	 .loc 1 224 0
 1160 0004 FFF7FEFF 	 bl _ZN6sdcard5resetEv
 1161              	.LVL34:
 225:src/MightyBoard/Motherboard/SDCard.cc ****   SdErrorCode result = initCard();
 1162              	 .loc 1 225 0
 1163 0008 FFF7FEFF 	 bl _ZN6sdcard8initCardEv
 1164              	.LVL35:
 226:src/MightyBoard/Motherboard/SDCard.cc ****   if (result != SD_SUCCESS) {
 1165              	 .loc 1 226 0
 1166 000c 0446     	 mov r4,r0
 1167 000e 80BB     	 cbnz r0,.L68
 229:src/MightyBoard/Motherboard/SDCard.cc ****   capturedBytes = 0L;
 1168              	 .loc 1 229 0
 1169 0010 40F20003 	 movw r3,#:lower16:.LANCHOR6
 1170 0014 C0F20003 	 movt r3,#:upper16:.LANCHOR6
 1171 0018 4FF00002 	 mov r2,#0
 1172 001c 1A60     	 str r2,[r3,#0]
 230:src/MightyBoard/Motherboard/SDCard.cc ****   file = 0;
 1173              	 .loc 1 230 0
 1174 001e 40F20003 	 movw r3,#:lower16:.LANCHOR3
 1175 0022 C0F20003 	 movt r3,#:upper16:.LANCHOR3
 1176 0026 1A60     	 str r2,[r3,#0]
 232:src/MightyBoard/Motherboard/SDCard.cc ****   deleteFile(filename);
 1177              	 .loc 1 232 0
 1178 0028 2846     	 mov r0,r5
 1179              	.LVL36:
 1180 002a FFF7FEFF 	 bl _ZN6sdcard10deleteFileEPc
 233:src/MightyBoard/Motherboard/SDCard.cc ****   if (!createFile(filename)) {
 1181              	 .loc 1 233 0
 1182 002e 2846     	 mov r0,r5
 1183 0030 FFF7FEFF 	 bl _ZN6sdcard10createFileEPc
 1184 0034 A8B1     	 cbz r0,.L69
 237:src/MightyBoard/Motherboard/SDCard.cc ****   if (!openFile(filename,&file)) {
 1185              	 .loc 1 237 0
 1186 0036 2846     	 mov r0,r5
 1187 0038 40F20001 	 movw r1,#:lower16:.LANCHOR3
 1188 003c C0F20001 	 movt r1,#:upper16:.LANCHOR3
 1189 0040 FFF7FEFF 	 bl _ZN6sdcard8openFileEPKcPP15fat_file_struct
 1190 0044 80B1     	 cbz r0,.L70
 240:src/MightyBoard/Motherboard/SDCard.cc ****   if (file == 0) {
 1191              	 .loc 1 240 0
 1192 0046 40F20003 	 movw r3,#:lower16:.LANCHOR3
 1193 004a C0F20003 	 movt r3,#:upper16:.LANCHOR3
 1194 004e 1B68     	 ldr r3,[r3,#0]
 1195 0050 6BB1     	 cbz r3,.L71
 244:src/MightyBoard/Motherboard/SDCard.cc ****   capturing = true;
 1196              	 .loc 1 244 0
 1197 0052 40F20003 	 movw r3,#:lower16:.LANCHOR5
 1198 0056 C0F20003 	 movt r3,#:upper16:.LANCHOR5
 1199 005a 4FF00102 	 mov r2,#1
 1200 005e 1A70     	 strb r2,[r3,#0]
 245:src/MightyBoard/Motherboard/SDCard.cc ****   return SD_SUCCESS;
 1201              	 .loc 1 245 0
 1202 0060 07E0     	 b .L68
 1203              	.L69:
 234:src/MightyBoard/Motherboard/SDCard.cc ****     return SD_ERR_FILE_NOT_FOUND;
 1204              	 .loc 1 234 0
 1205 0062 4FF00704 	 mov r4,#7
 1206 0066 04E0     	 b .L68
 1207              	.L70:
 238:src/MightyBoard/Motherboard/SDCard.cc ****     return SD_ERR_PARTITION_READ;
 1208              	 .loc 1 238 0
 1209 0068 4FF00304 	 mov r4,#3
 1210 006c 01E0     	 b .L68
 1211              	.L71:
 241:src/MightyBoard/Motherboard/SDCard.cc ****     return SD_ERR_GENERIC;
 1212              	 .loc 1 241 0
 1213 006e 4FF00804 	 mov r4,#8
 1214              	.L68:
 1215              	.LBE39:
 246:src/MightyBoard/Motherboard/SDCard.cc **** }
 1216              	 .loc 1 246 0
 1217 0072 2046     	 mov r0,r4
 1218 0074 38BD     	 pop {r3,r4,r5,pc}
 1219              	 .cfi_endproc
 1220              	.LFE115:
 1222 0076 00BF     	 .section .text._ZN6sdcard14directoryResetEv,"ax",%progbits
 1223              	 .align 2
 1224              	 .global _ZN6sdcard14directoryResetEv
 1225              	 .thumb
 1226              	 .thumb_func
 1228              	_ZN6sdcard14directoryResetEv:
 1229              	.LFB106:
 123:src/MightyBoard/Motherboard/SDCard.cc **** SdErrorCode directoryReset() {
 1230              	 .loc 1 123 0
 1231              	 .cfi_startproc
 1232              	 
 1233              	 
 1234 0000 08B5     	 push {r3,lr}
 1235              	.LCFI27:
 1236              	 .cfi_def_cfa_offset 8
 1237              	 .cfi_offset 14,-4
 1238              	 .cfi_offset 3,-8
 1239              	.LBB40:
 124:src/MightyBoard/Motherboard/SDCard.cc ****   reset();
 1240              	 .loc 1 124 0
 1241 0002 FFF7FEFF 	 bl _ZN6sdcard5resetEv
 125:src/MightyBoard/Motherboard/SDCard.cc ****   SdErrorCode rsp = initCard();
 1242              	 .loc 1 125 0
 1243 0006 FFF7FEFF 	 bl _ZN6sdcard8initCardEv
 1244              	.LVL37:
 126:src/MightyBoard/Motherboard/SDCard.cc ****   if (rsp != SD_SUCCESS && rsp != SD_ERR_CARD_LOCKED) {
 1245              	 .loc 1 126 0
 1246 000a 0346     	 mov r3,r0
 1247 000c 821F     	 subs r2,r0,#6
 1248 000e 18BF     	 it ne
 1249 0010 0122     	 movne r2,#1
 1250 0012 0028     	 cmp r0,#0
 1251 0014 0CBF     	 ite eq
 1252 0016 0022     	 moveq r2,#0
 1253 0018 02F00102 	 andne r2,r2,#1
 1254 001c 42B9     	 cbnz r2,.L73
 129:src/MightyBoard/Motherboard/SDCard.cc ****   fat_reset_dir(dd);
 1255              	 .loc 1 129 0
 1256 001e 40F20003 	 movw r3,#:lower16:.LANCHOR2
 1257 0022 C0F20003 	 movt r3,#:upper16:.LANCHOR2
 1258 0026 1868     	 ldr r0,[r3,#0]
 1259              	.LVL38:
 1260 0028 FFF7FEFF 	 bl fat_reset_dir
 130:src/MightyBoard/Motherboard/SDCard.cc ****   return SD_SUCCESS;
 1261              	 .loc 1 130 0
 1262 002c 4FF00003 	 mov r3,#0
 1263              	.L73:
 1264              	.LBE40:
 131:src/MightyBoard/Motherboard/SDCard.cc **** }
 1265              	 .loc 1 131 0
 1266 0030 1846     	 mov r0,r3
 1267 0032 08BD     	 pop {r3,pc}
 1268              	 .cfi_endproc
 1269              	.LFE106:
 1271              	 .section .text._GLOBAL__sub_I__ZN6sdcard9partitionE,"ax",%progbits
 1272              	 .align 2
 1273              	 .thumb
 1274              	 .thumb_func
 1276              	_GLOBAL__sub_I__ZN6sdcard9partitionE:
 1277              	.LFB127:
 350:src/MightyBoard/Motherboard/SDCard.cc **** 	}
 351:src/MightyBoard/Motherboard/SDCard.cc **** }
 352:src/MightyBoard/Motherboard/SDCard.cc **** 
 353:src/MightyBoard/Motherboard/SDCard.cc **** } // namespace sdcard
 1278              	 .loc 1 353 0
 1279              	 .cfi_startproc
 1280              	 
 1281              	 
 1282 0000 10B5     	 push {r4,lr}
 1283              	.LCFI28:
 1284              	 .cfi_def_cfa_offset 8
 1285              	 .cfi_offset 14,-4
 1286              	 .cfi_offset 4,-8
 1287              	.LVL39:
 1288              	.LBB43:
 1289              	.LBB44:
 1290              	 .file 3 "src/MightyBoard/shared/LPCPort.hh"
   1:src/MightyBoard/shared/LPCPort.hh **** /*
   2:src/MightyBoard/shared/LPCPort.hh **** * Copyright 2010 by Adam Mayer	 <adam@makerbot.com>
   3:src/MightyBoard/shared/LPCPort.hh **** *
   4:src/MightyBoard/shared/LPCPort.hh **** * This program is free software: you can redistribute it and/or modify
   5:src/MightyBoard/shared/LPCPort.hh **** * it under the terms of the GNU General Public License as published by
   6:src/MightyBoard/shared/LPCPort.hh **** * the Free Software Foundation, either version 3 of the License, or
   7:src/MightyBoard/shared/LPCPort.hh **** * (at your option) any later version.
   8:src/MightyBoard/shared/LPCPort.hh **** *
   9:src/MightyBoard/shared/LPCPort.hh **** * This program is distributed in the hope that it will be useful,
  10:src/MightyBoard/shared/LPCPort.hh **** * but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:src/MightyBoard/shared/LPCPort.hh **** * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:src/MightyBoard/shared/LPCPort.hh **** * GNU General Public License for more details.
  13:src/MightyBoard/shared/LPCPort.hh **** *
  14:src/MightyBoard/shared/LPCPort.hh **** * You should have received a copy of the GNU General Public License
  15:src/MightyBoard/shared/LPCPort.hh **** * along with this program.  If not, see <http://www.gnu.org/licenses/>
  16:src/MightyBoard/shared/LPCPort.hh **** */
  17:src/MightyBoard/shared/LPCPort.hh **** 
  18:src/MightyBoard/shared/LPCPort.hh **** #ifndef SHARED_AVR_PORT_HH_
  19:src/MightyBoard/shared/LPCPort.hh **** #define SHARED_AVR_PORT_HH_
  20:src/MightyBoard/shared/LPCPort.hh **** 
  21:src/MightyBoard/shared/LPCPort.hh **** #define __STDC_LIMIT_MACROS
  22:src/MightyBoard/shared/LPCPort.hh **** //#include <stdint.h>
  23:src/MightyBoard/shared/LPCPort.hh **** //#include <util/atomic.h>
  24:src/MightyBoard/shared/LPCPort.hh **** 
  25:src/MightyBoard/shared/LPCPort.hh **** extern "C" {
  26:src/MightyBoard/shared/LPCPort.hh **** 	#include "lpc_types.h"
  27:src/MightyBoard/shared/LPCPort.hh **** 	#include "lpc17xx_gpio.h"
  28:src/MightyBoard/shared/LPCPort.hh **** }
  29:src/MightyBoard/shared/LPCPort.hh **** 
  30:src/MightyBoard/shared/LPCPort.hh **** 
  31:src/MightyBoard/shared/LPCPort.hh **** #define NULL_PORT 0xff
  32:src/MightyBoard/shared/LPCPort.hh **** 
  33:src/MightyBoard/shared/LPCPort.hh **** class LPCPort {
  34:src/MightyBoard/shared/LPCPort.hh **** private:
  35:src/MightyBoard/shared/LPCPort.hh **** 	const uint8_t port_base;
  36:src/MightyBoard/shared/LPCPort.hh **** 	friend class Pin;
  37:src/MightyBoard/shared/LPCPort.hh **** public:
  38:src/MightyBoard/shared/LPCPort.hh **** 	LPCPort();
  39:src/MightyBoard/shared/LPCPort.hh **** 	LPCPort(uint8_t port_base_in);
  40:src/MightyBoard/shared/LPCPort.hh **** 	bool isNull() const;
  41:src/MightyBoard/shared/LPCPort.hh **** 	void setPinDirectionOut(uint8_t pin_index) const;
  42:src/MightyBoard/shared/LPCPort.hh **** 	void setPinDirectionIn(uint8_t pin_index) const;
  43:src/MightyBoard/shared/LPCPort.hh **** 	bool getPin(uint8_t pin_index) const;
  44:src/MightyBoard/shared/LPCPort.hh **** 	void setPinOn(uint8_t pin_index) const;
  45:src/MightyBoard/shared/LPCPort.hh **** 	void setPinOff(uint8_t pin_index) const;
  46:src/MightyBoard/shared/LPCPort.hh **** };
  47:src/MightyBoard/shared/LPCPort.hh **** 
  48:src/MightyBoard/shared/LPCPort.hh **** 
  49:src/MightyBoard/shared/LPCPort.hh **** const LPCPort Port0(0);
 1291              	 .loc 3 49 0
 1292 0002 40F20000 	 movw r0,#:lower16:.LANCHOR10
 1293 0006 C0F20000 	 movt r0,#:upper16:.LANCHOR10
 1294 000a 4FF00001 	 mov r1,#0
 1295 000e FFF7FEFF 	 bl _ZN7LPCPortC1Eh
  50:src/MightyBoard/shared/LPCPort.hh **** const LPCPort Port1(1);
 1296              	 .loc 3 50 0
 1297 0012 40F20000 	 movw r0,#:lower16:.LANCHOR11
 1298 0016 C0F20000 	 movt r0,#:upper16:.LANCHOR11
 1299 001a 4FF00101 	 mov r1,#1
 1300 001e FFF7FEFF 	 bl _ZN7LPCPortC1Eh
  51:src/MightyBoard/shared/LPCPort.hh **** const LPCPort Port2(2);
 1301              	 .loc 3 51 0
 1302 0022 40F20000 	 movw r0,#:lower16:.LANCHOR12
 1303 0026 C0F20000 	 movt r0,#:upper16:.LANCHOR12
 1304 002a 4FF00201 	 mov r1,#2
 1305 002e FFF7FEFF 	 bl _ZN7LPCPortC1Eh
  52:src/MightyBoard/shared/LPCPort.hh **** const LPCPort Port3(3);
 1306              	 .loc 3 52 0
 1307 0032 40F20000 	 movw r0,#:lower16:.LANCHOR13
 1308 0036 C0F20000 	 movt r0,#:upper16:.LANCHOR13
 1309 003a 4FF00301 	 mov r1,#3
 1310 003e FFF7FEFF 	 bl _ZN7LPCPortC1Eh
  53:src/MightyBoard/shared/LPCPort.hh **** const LPCPort Port4(4);
 1311              	 .loc 3 53 0
 1312 0042 40F20000 	 movw r0,#:lower16:.LANCHOR14
 1313 0046 C0F20000 	 movt r0,#:upper16:.LANCHOR14
 1314 004a 4FF00401 	 mov r1,#4
 1315 004e FFF7FEFF 	 bl _ZN7LPCPortC1Eh
  54:src/MightyBoard/shared/LPCPort.hh **** 
  55:src/MightyBoard/shared/LPCPort.hh **** const LPCPort NullPort(0xff);
 1316              	 .loc 3 55 0
 1317 0052 40F20004 	 movw r4,#:lower16:.LANCHOR15
 1318 0056 C0F20004 	 movt r4,#:upper16:.LANCHOR15
 1319 005a 2046     	 mov r0,r4
 1320 005c 4FF0FF01 	 mov r1,#255
 1321 0060 FFF7FEFF 	 bl _ZN7LPCPortC1Eh
 1322              	 .file 4 "src/MightyBoard/shared/Pin.hh"
   1:src/MightyBoard/shared/Pin.hh **** #ifndef PIN_HH
   2:src/MightyBoard/shared/Pin.hh **** #define PIN_HH
   3:src/MightyBoard/shared/Pin.hh **** 
   4:src/MightyBoard/shared/Pin.hh **** #include "LPCPort.hh"
   5:src/MightyBoard/shared/Pin.hh **** #include "Pin.hh"
   6:src/MightyBoard/shared/Pin.hh **** extern "C" {
   7:src/MightyBoard/shared/Pin.hh **** 	#include "lpc17xx_gpio.h"
   8:src/MightyBoard/shared/Pin.hh **** 	#include "lpc17xx_pinsel.h"
   9:src/MightyBoard/shared/Pin.hh **** 	#include "comm.h"
  10:src/MightyBoard/shared/Pin.hh **** }
  11:src/MightyBoard/shared/Pin.hh **** 
  12:src/MightyBoard/shared/Pin.hh **** /// \ingroup HardwareLibraries
  13:src/MightyBoard/shared/Pin.hh **** class Pin {
  14:src/MightyBoard/shared/Pin.hh **** private:
  15:src/MightyBoard/shared/Pin.hh **** 	uint8_t port_base;
  16:src/MightyBoard/shared/Pin.hh **** 	bool is_null;
  17:src/MightyBoard/shared/Pin.hh **** 	uint8_t pin_index;
  18:src/MightyBoard/shared/Pin.hh **** 	uint8_t pin_mask;
  19:src/MightyBoard/shared/Pin.hh **** 	uint8_t pin_mask_inverted;
  20:src/MightyBoard/shared/Pin.hh **** 
  21:src/MightyBoard/shared/Pin.hh **** public:
  22:src/MightyBoard/shared/Pin.hh **** 	Pin();
  23:src/MightyBoard/shared/Pin.hh **** 	Pin(const LPCPort& port_in, uint8_t pin_index_in);
  24:src/MightyBoard/shared/Pin.hh **** 	Pin(const Pin& other_pin);
  25:src/MightyBoard/shared/Pin.hh **** 	bool isNull() const;
  26:src/MightyBoard/shared/Pin.hh **** 	void setDirection(bool out) const;
  27:src/MightyBoard/shared/Pin.hh **** 	bool /*Pin::*/getValue() const {
  28:src/MightyBoard/shared/Pin.hh **** 		if (is_null)
  29:src/MightyBoard/shared/Pin.hh **** 			return false; // null pin is always low ... ?
  30:src/MightyBoard/shared/Pin.hh **** 		return ((uint8_t)(FIO_ReadValue(port_base) & _BV(pin_index))?1:0);
  31:src/MightyBoard/shared/Pin.hh **** //		return (uint8_t)((uint8_t)PINx & (uint8_t)pin_mask) != 0;
  32:src/MightyBoard/shared/Pin.hh **** 	};
  33:src/MightyBoard/shared/Pin.hh **** 
  34:src/MightyBoard/shared/Pin.hh **** 	void /*Pin::*/setValue(bool on) const {
  35:src/MightyBoard/shared/Pin.hh **** 		if (is_null)
  36:src/MightyBoard/shared/Pin.hh **** 		 	return;
  37:src/MightyBoard/shared/Pin.hh **** 		// uint8_t oldSREG = SREG;
  38:src/MightyBoard/shared/Pin.hh **** 
  39:src/MightyBoard/shared/Pin.hh **** //		xprintf("on:%d port_base:%d pi_index:%d" " (%s:%d)\n",on,port_base,pin_index,_F_,_L_);
  40:src/MightyBoard/shared/Pin.hh **** 		// cli();
  41:src/MightyBoard/shared/Pin.hh **** 		if (on) {
  42:src/MightyBoard/shared/Pin.hh **** //			PORTx |= pin_mask;
  43:src/MightyBoard/shared/Pin.hh **** //			xprintf("%x (%s:%d)\n",&GPIO_SetValue,_F_,_L_);
  44:src/MightyBoard/shared/Pin.hh **** 			GPIO_SetValue(port_base, _BV(pin_index));
  45:src/MightyBoard/shared/Pin.hh **** 		} else {
  46:src/MightyBoard/shared/Pin.hh **** //			PORTx &= pin_mask_inverted;
  47:src/MightyBoard/shared/Pin.hh **** //			xprintf("%x (%s:%d)\n",&GPIO_ClearValue,_F_,_L_);
  48:src/MightyBoard/shared/Pin.hh **** 			GPIO_ClearValue(port_base, _BV(pin_index));
  49:src/MightyBoard/shared/Pin.hh **** 		}
  50:src/MightyBoard/shared/Pin.hh **** 		// SREG = oldSREG;
  51:src/MightyBoard/shared/Pin.hh **** 	};
  52:src/MightyBoard/shared/Pin.hh **** 
  53:src/MightyBoard/shared/Pin.hh **** 	void /*Pin::*/setValueOn() const {
  54:src/MightyBoard/shared/Pin.hh **** 		if (is_null)
  55:src/MightyBoard/shared/Pin.hh **** 		 	return;
  56:src/MightyBoard/shared/Pin.hh **** 		// uint8_t oldSREG = SREG;
  57:src/MightyBoard/shared/Pin.hh **** 		// cli();
  58:src/MightyBoard/shared/Pin.hh **** //		PORTx |= pin_mask;
  59:src/MightyBoard/shared/Pin.hh **** 		GPIO_SetValue(port_base, _BV(pin_index));
  60:src/MightyBoard/shared/Pin.hh **** 		// SREG = oldSREG;
  61:src/MightyBoard/shared/Pin.hh **** 	};
  62:src/MightyBoard/shared/Pin.hh **** 
  63:src/MightyBoard/shared/Pin.hh **** 	void /*Pin::*/setValueOff() const {
  64:src/MightyBoard/shared/Pin.hh **** 		// if (is_null)
  65:src/MightyBoard/shared/Pin.hh **** 		// 	return;
  66:src/MightyBoard/shared/Pin.hh **** 		// uint8_t oldSREG = SREG;
  67:src/MightyBoard/shared/Pin.hh **** 		// cli();
  68:src/MightyBoard/shared/Pin.hh **** //		PORTx &= pin_mask_inverted;
  69:src/MightyBoard/shared/Pin.hh **** 		GPIO_ClearValue(port_base, _BV(pin_index));
  70:src/MightyBoard/shared/Pin.hh **** 		// SREG = oldSREG;
  71:src/MightyBoard/shared/Pin.hh **** 	};
  72:src/MightyBoard/shared/Pin.hh **** 	// currently not used:
  73:src/MightyBoard/shared/Pin.hh **** 	//const uint8_t getPinIndex() const { return pin_index; }
  74:src/MightyBoard/shared/Pin.hh **** };
  75:src/MightyBoard/shared/Pin.hh **** 
  76:src/MightyBoard/shared/Pin.hh **** static const Pin NullPin(NullPort, 0);
 1323              	 .loc 4 76 0
 1324 0064 40F20000 	 movw r0,#:lower16:.LANCHOR16
 1325 0068 C0F20000 	 movt r0,#:upper16:.LANCHOR16
 1326 006c 2146     	 mov r1,r4
 1327 006e 4FF00002 	 mov r2,#0
 1328 0072 FFF7FEFF 	 bl _ZN3PinC1ERK7LPCPorth
 1329              	.LBE44:
 1330              	.LBE43:
 1331              	 .loc 1 353 0
 1332 0076 10BD     	 pop {r4,pc}
 1333              	 .cfi_endproc
 1334              	.LFE127:
 1336              	 .section .init_array,"aw",%init_array
 1337              	 .align 2
 1338 0000 00000000 	 .word _GLOBAL__sub_I__ZN6sdcard9partitionE(target1)
 1339              	 .global _ZN6sdcard5retryE
 1340              	 .global _ZN6sdcard8has_moreE
 1341              	 .global _ZN6sdcard9next_byteE
 1342              	 .global _ZN6sdcard13capturedBytesE
 1343              	 .global _ZN6sdcard7playingE
 1344              	 .global _ZN6sdcard9capturingE
 1345              	 .global _ZN6sdcard4fileE
 1346              	 .global _ZN6sdcard2ddE
 1347              	 .global _ZN6sdcard2fsE
 1348              	 .global _ZN6sdcard9partitionE
 1349              	 .section .bss._ZL5Port0,"aw",%nobits
 1350              	 .align 2
 1351              	 .set .LANCHOR10,.+0
 1354              	_ZL5Port0:
 1355 0000 00       	 .space 1
 1356 0001 000000   	 .section .bss._ZN6sdcard2ddE,"aw",%nobits
 1357              	 .align 2
 1358              	 .set .LANCHOR2,.+0
 1361              	_ZN6sdcard2ddE:
 1362 0000 00000000 	 .space 4
 1363              	 .section .bss._ZN6sdcard2fsE,"aw",%nobits
 1364              	 .align 2
 1365              	 .set .LANCHOR1,.+0
 1368              	_ZN6sdcard2fsE:
 1369 0000 00000000 	 .space 4
 1370              	 .section .bss._ZL5Port1,"aw",%nobits
 1371              	 .align 2
 1372              	 .set .LANCHOR11,.+0
 1375              	_ZL5Port1:
 1376 0000 00       	 .space 1
 1377 0001 000000   	 .section .bss._ZN6sdcard5retryE,"aw",%nobits
 1378              	 .set .LANCHOR9,.+0
 1381              	_ZN6sdcard5retryE:
 1382 0000 00       	 .space 1
 1383              	 .section .bss._ZL5Port3,"aw",%nobits
 1384              	 .align 2
 1385              	 .set .LANCHOR13,.+0
 1388              	_ZL5Port3:
 1389 0000 00       	 .space 1
 1390 0001 000000   	 .section .bss._ZL5Port2,"aw",%nobits
 1391              	 .align 2
 1392              	 .set .LANCHOR12,.+0
 1395              	_ZL5Port2:
 1396 0000 00       	 .space 1
 1397 0001 000000   	 .section .bss._ZN6sdcard7playingE,"aw",%nobits
 1398              	 .set .LANCHOR4,.+0
 1401              	_ZN6sdcard7playingE:
 1402 0000 00       	 .space 1
 1403              	 .section .bss._ZN6sdcard9next_byteE,"aw",%nobits
 1404              	 .set .LANCHOR7,.+0
 1407              	_ZN6sdcard9next_byteE:
 1408 0000 00       	 .space 1
 1409              	 .section .bss._ZN6sdcard9partitionE,"aw",%nobits
 1410              	 .align 2
 1411              	 .set .LANCHOR0,.+0
 1414              	_ZN6sdcard9partitionE:
 1415 0000 00000000 	 .space 4
 1416              	 .section .bss._ZN6sdcard4fileE,"aw",%nobits
 1417              	 .align 2
 1418              	 .set .LANCHOR3,.+0
 1421              	_ZN6sdcard4fileE:
 1422 0000 00000000 	 .space 4
 1423              	 .section .rodata.str1.4,"aMS",%progbits,1
 1424              	 .align 2
 1425              	.LC0:
 1426 0000 2F00     	 .ascii "/\000"
 1427 0002 0000     	 .space 2
 1428              	.LC1:
 1429 0004 53442043 	 .ascii "SD Card Removed\000"
 1429      61726420 
 1429      52656D6F 
 1429      76656400 
 1430              	 .section .bss._ZL7NullPin,"aw",%nobits
 1431              	 .align 2
 1432              	 .set .LANCHOR16,.+0
 1435              	_ZL7NullPin:
 1436 0000 00000000 	 .space 5
 1436      00
 1437 0005 000000   	 .section .bss._ZL8NullPort,"aw",%nobits
 1438              	 .align 2
 1439              	 .set .LANCHOR15,.+0
 1442              	_ZL8NullPort:
 1443 0000 00       	 .space 1
 1444 0001 000000   	 .section .bss._ZN6sdcard8has_moreE,"aw",%nobits
 1445              	 .set .LANCHOR8,.+0
 1448              	_ZN6sdcard8has_moreE:
 1449 0000 00       	 .space 1
 1450              	 .section .bss._ZL5Port4,"aw",%nobits
 1451              	 .align 2
 1452              	 .set .LANCHOR14,.+0
 1455              	_ZL5Port4:
 1456 0000 00       	 .space 1
 1457 0001 000000   	 .section .bss._ZN6sdcard9capturingE,"aw",%nobits
 1458              	 .set .LANCHOR5,.+0
 1461              	_ZN6sdcard9capturingE:
 1462 0000 00       	 .space 1
 1463              	 .section .bss._ZN6sdcard13capturedBytesE,"aw",%nobits
 1464              	 .align 2
 1465              	 .set .LANCHOR6,.+0
 1468              	_ZN6sdcard13capturedBytesE:
 1469 0000 00000000 	 .space 4
 1470              	 .text
 1471              	.Letext0:
 1472              	 .file 5 "c:\\program files\\codesourcery\\sourcery_codebench_lite_for_arm_eabi\\bin\\../lib/gcc/arm-none-eabi/4.6.3/../../../../arm-none-eabi/include/stdint.h"
 1473              	 .file 6 "src/MightyBoard/Motherboard/SDCard.hh"
 1474              	 .file 7 "src/MightyBoard/shared/Types.hh"
 1475              	 .file 8 "src/MightyBoard/shared/Timeout.hh"
 1476              	 .file 9 "src/MightyBoard/shared/TemperatureSensor.hh"
 1477              	 .file 10 "src/MightyBoard/shared/PID.hh"
 1478              	 .file 11 "src/MightyBoard/shared/Heater.hh"
 1479              	 .file 12 "src/MightyBoard/shared/HeatingElement.hh"
 1480              	 .file 13 "src/MightyBoard/Motherboard/EepromMap.hh"
 1481              	 .file 14 "src/MightyBoard/shared/CoolingFan.hh"
 1482              	 .file 15 "src/MightyBoard/Motherboard/ExtruderBoard.hh"
 1483              	 .file 16 "src/MightyBoard/Motherboard/Cutoff.hh"
 1484              	 .file 17 "src/MightyBoard/Motherboard/Motherboard.hh"
 1485              	 .file 18 "src/MightyBoard/Motherboard/lib_sd/sd_raw_config.h"
 1486              	 .file 19 "src/MightyBoard/Motherboard/lib_sd/fat_config.h"
 1487              	 .file 20 "src/MightyBoard/Motherboard/lib_sd/fat.h"
 1488              	 .file 21 "src/MightyBoard/Motherboard/lib_sd/partition.h"
 1489              	 .file 22 "src/MightyBoard/Motherboard/system/core_cm3.h"
DEFINED SYMBOLS
                            *ABS*:00000000 SDCard.cc
    {standard input}:19     .text._ZN6sdcard13openPartitionEv:00000000 $t
    {standard input}:24     .text._ZN6sdcard13openPartitionEv:00000000 _ZN6sdcard13openPartitionEv
    {standard input}:1411   .bss._ZN6sdcard9partitionE:00000000 .LANCHOR0
    {standard input}:85     .text._ZN6sdcard11openFilesysEv:00000000 $t
    {standard input}:90     .text._ZN6sdcard11openFilesysEv:00000000 _ZN6sdcard11openFilesysEv
    {standard input}:1365   .bss._ZN6sdcard2fsE:00000000 .LANCHOR1
    {standard input}:118    .text._ZN6sdcard8openRootEv:00000000 $t
    {standard input}:123    .text._ZN6sdcard8openRootEv:00000000 _ZN6sdcard8openRootEv
    {standard input}:1425   .rodata.str1.4:00000000 .LC0
    {standard input}:1358   .bss._ZN6sdcard2ddE:00000000 .LANCHOR2
    {standard input}:164    .text._ZN6sdcard15checkVolumeSizeEv:00000000 $t
    {standard input}:169    .text._ZN6sdcard15checkVolumeSizeEv:00000000 _ZN6sdcard15checkVolumeSizeEv
    {standard input}:193    .text._ZN6sdcard18directoryNextEntryEPchPh:00000000 $t
    {standard input}:198    .text._ZN6sdcard18directoryNextEntryEPchPh:00000000 _ZN6sdcard18directoryNextEntryEPchPh
    {standard input}:312    .text._ZN6sdcard13findFileInDirEPKcP20fat_dir_entry_struct:00000000 $t
    {standard input}:317    .text._ZN6sdcard13findFileInDirEPKcP20fat_dir_entry_struct:00000000 _ZN6sdcard13findFileInDirEPKcP20fat_dir_entry_struct
    {standard input}:365    .text._ZN6sdcard8openFileEPKcPP15fat_file_struct:00000000 $t
    {standard input}:370    .text._ZN6sdcard8openFileEPKcPP15fat_file_struct:00000000 _ZN6sdcard8openFileEPKcPP15fat_file_struct
    {standard input}:415    .text._ZN6sdcard11getFileSizeEv:00000000 $t
    {standard input}:420    .text._ZN6sdcard11getFileSizeEv:00000000 _ZN6sdcard11getFileSizeEv
    {standard input}:1418   .bss._ZN6sdcard4fileE:00000000 .LANCHOR3
    {standard input}:442    .text._ZN6sdcard10deleteFileEPc:00000000 $t
    {standard input}:447    .text._ZN6sdcard10deleteFileEPc:00000000 _ZN6sdcard10deleteFileEPc
    {standard input}:488    .text._ZN6sdcard10createFileEPc:00000000 $t
    {standard input}:493    .text._ZN6sdcard10createFileEPc:00000000 _ZN6sdcard10createFileEPc
    {standard input}:528    .text._ZN6sdcard9isPlayingEv:00000000 $t
    {standard input}:533    .text._ZN6sdcard9isPlayingEv:00000000 _ZN6sdcard9isPlayingEv
    {standard input}:1398   .bss._ZN6sdcard7playingE:00000000 .LANCHOR4
    {standard input}:550    .text._ZN6sdcard11isCapturingEv:00000000 $t
    {standard input}:555    .text._ZN6sdcard11isCapturingEv:00000000 _ZN6sdcard11isCapturingEv
    {standard input}:1458   .bss._ZN6sdcard9capturingE:00000000 .LANCHOR5
    {standard input}:572    .text._ZN6sdcard13capturePacketERK6Packet:00000000 $t
    {standard input}:577    .text._ZN6sdcard13capturePacketERK6Packet:00000000 _ZN6sdcard13capturePacketERK6Packet
    {standard input}:1465   .bss._ZN6sdcard13capturedBytesE:00000000 .LANCHOR6
    {standard input}:627    .text._ZN6sdcard13finishCaptureEv:00000000 $t
    {standard input}:632    .text._ZN6sdcard13finishCaptureEv:00000000 _ZN6sdcard13finishCaptureEv
    {standard input}:678    .text._ZN6sdcard13fetchNextByteEv:00000000 $t
    {standard input}:683    .text._ZN6sdcard13fetchNextByteEv:00000000 _ZN6sdcard13fetchNextByteEv
    {standard input}:1404   .bss._ZN6sdcard9next_byteE:00000000 .LANCHOR7
    {standard input}:1445   .bss._ZN6sdcard8has_moreE:00000000 .LANCHOR8
    {standard input}:1428   .rodata.str1.4:00000004 .LC1
    {standard input}:1378   .bss._ZN6sdcard5retryE:00000000 .LANCHOR9
    {standard input}:743    .text._ZN6sdcard13playbackRetryEv:00000000 $t
    {standard input}:748    .text._ZN6sdcard13playbackRetryEv:00000000 _ZN6sdcard13playbackRetryEv
    {standard input}:765    .text._ZN6sdcard15playbackHasNextEv:00000000 $t
    {standard input}:770    .text._ZN6sdcard15playbackHasNextEv:00000000 _ZN6sdcard15playbackHasNextEv
    {standard input}:787    .text._ZN6sdcard12playbackNextEv:00000000 $t
    {standard input}:792    .text._ZN6sdcard12playbackNextEv:00000000 _ZN6sdcard12playbackNextEv
    {standard input}:819    .text._ZN6sdcard14playbackRewindEh:00000000 $t
    {standard input}:824    .text._ZN6sdcard14playbackRewindEh:00000000 _ZN6sdcard14playbackRewindEh
    {standard input}:859    .text._ZN6sdcard14finishPlaybackEv:00000000 $t
    {standard input}:864    .text._ZN6sdcard14finishPlaybackEv:00000000 _ZN6sdcard14finishPlaybackEv
    {standard input}:901    .text._ZN6sdcard5resetEv:00000000 $t
    {standard input}:906    .text._ZN6sdcard5resetEv:00000000 _ZN6sdcard5resetEv
    {standard input}:977    .text._ZN6sdcard8initCardEv:00000000 $t
    {standard input}:982    .text._ZN6sdcard8initCardEv:00000000 _ZN6sdcard8initCardEv
    {standard input}:1060   .text._ZN6sdcard13startPlaybackEPc:00000000 $t
    {standard input}:1065   .text._ZN6sdcard13startPlaybackEPc:00000000 _ZN6sdcard13startPlaybackEPc
    {standard input}:1138   .text._ZN6sdcard12startCaptureEPc:00000000 $t
    {standard input}:1143   .text._ZN6sdcard12startCaptureEPc:00000000 _ZN6sdcard12startCaptureEPc
    {standard input}:1223   .text._ZN6sdcard14directoryResetEv:00000000 $t
    {standard input}:1228   .text._ZN6sdcard14directoryResetEv:00000000 _ZN6sdcard14directoryResetEv
    {standard input}:1272   .text._GLOBAL__sub_I__ZN6sdcard9partitionE:00000000 $t
    {standard input}:1276   .text._GLOBAL__sub_I__ZN6sdcard9partitionE:00000000 _GLOBAL__sub_I__ZN6sdcard9partitionE
    {standard input}:1351   .bss._ZL5Port0:00000000 .LANCHOR10
    {standard input}:1372   .bss._ZL5Port1:00000000 .LANCHOR11
    {standard input}:1392   .bss._ZL5Port2:00000000 .LANCHOR12
    {standard input}:1385   .bss._ZL5Port3:00000000 .LANCHOR13
    {standard input}:1452   .bss._ZL5Port4:00000000 .LANCHOR14
    {standard input}:1439   .bss._ZL8NullPort:00000000 .LANCHOR15
    {standard input}:1432   .bss._ZL7NullPin:00000000 .LANCHOR16
    {standard input}:1337   .init_array:00000000 $d
    {standard input}:1381   .bss._ZN6sdcard5retryE:00000000 _ZN6sdcard5retryE
    {standard input}:1448   .bss._ZN6sdcard8has_moreE:00000000 _ZN6sdcard8has_moreE
    {standard input}:1407   .bss._ZN6sdcard9next_byteE:00000000 _ZN6sdcard9next_byteE
    {standard input}:1468   .bss._ZN6sdcard13capturedBytesE:00000000 _ZN6sdcard13capturedBytesE
    {standard input}:1401   .bss._ZN6sdcard7playingE:00000000 _ZN6sdcard7playingE
    {standard input}:1461   .bss._ZN6sdcard9capturingE:00000000 _ZN6sdcard9capturingE
    {standard input}:1421   .bss._ZN6sdcard4fileE:00000000 _ZN6sdcard4fileE
    {standard input}:1361   .bss._ZN6sdcard2ddE:00000000 _ZN6sdcard2ddE
    {standard input}:1368   .bss._ZN6sdcard2fsE:00000000 _ZN6sdcard2fsE
    {standard input}:1414   .bss._ZN6sdcard9partitionE:00000000 _ZN6sdcard9partitionE
    {standard input}:1350   .bss._ZL5Port0:00000000 $d
    {standard input}:1354   .bss._ZL5Port0:00000000 _ZL5Port0
    {standard input}:1357   .bss._ZN6sdcard2ddE:00000000 $d
    {standard input}:1364   .bss._ZN6sdcard2fsE:00000000 $d
    {standard input}:1371   .bss._ZL5Port1:00000000 $d
    {standard input}:1375   .bss._ZL5Port1:00000000 _ZL5Port1
    {standard input}:1382   .bss._ZN6sdcard5retryE:00000000 $d
    {standard input}:1384   .bss._ZL5Port3:00000000 $d
    {standard input}:1388   .bss._ZL5Port3:00000000 _ZL5Port3
    {standard input}:1391   .bss._ZL5Port2:00000000 $d
    {standard input}:1395   .bss._ZL5Port2:00000000 _ZL5Port2
    {standard input}:1402   .bss._ZN6sdcard7playingE:00000000 $d
    {standard input}:1408   .bss._ZN6sdcard9next_byteE:00000000 $d
    {standard input}:1410   .bss._ZN6sdcard9partitionE:00000000 $d
    {standard input}:1417   .bss._ZN6sdcard4fileE:00000000 $d
    {standard input}:1424   .rodata.str1.4:00000000 $d
    {standard input}:1431   .bss._ZL7NullPin:00000000 $d
    {standard input}:1435   .bss._ZL7NullPin:00000000 _ZL7NullPin
    {standard input}:1438   .bss._ZL8NullPort:00000000 $d
    {standard input}:1442   .bss._ZL8NullPort:00000000 _ZL8NullPort
    {standard input}:1449   .bss._ZN6sdcard8has_moreE:00000000 $d
    {standard input}:1451   .bss._ZL5Port4:00000000 $d
    {standard input}:1455   .bss._ZL5Port4:00000000 _ZL5Port4
    {standard input}:1462   .bss._ZN6sdcard9capturingE:00000000 $d
    {standard input}:1464   .bss._ZN6sdcard13capturedBytesE:00000000 $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
sd_raw_read
sd_raw_read_interval
sd_raw_write
sd_raw_write_interval
partition_open
fat_open
fat_get_dir_entry_of_path
fat_open_dir
fat_get_fs_size
fat_read_dir
strcmp
fat_reset_dir
fat_open_file
fat_get_file_size
fat_delete_file
fat_create_file
fat_write_file
fat_close_file
sd_raw_sync
sd_raw_available
fat_read_file
_ZN11Motherboard11motherboardE
_ZN11Motherboard13errorResponseEPcb
fat_seek_file
fat_close_dir
fat_close
partition_close
sd_raw_init
sd_raw_locked
_ZN7LPCPortC1Eh
_ZN3PinC1ERK7LPCPorth
