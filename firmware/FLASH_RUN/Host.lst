   1              	 .syntax unified
   2              	 .cpu cortex-m3
   3              	 .fpu softvfp
   4              	 .eabi_attribute 20,1
   5              	 .eabi_attribute 21,1
   6              	 .eabi_attribute 23,3
   7              	 .eabi_attribute 24,1
   8              	 .eabi_attribute 25,1
   9              	 .eabi_attribute 26,1
  10              	 .eabi_attribute 30,1
  11              	 .eabi_attribute 34,1
  12              	 .eabi_attribute 18,4
  13              	 .thumb
  14              	 .file "Host.cc"
  15              	 .text
  16              	.Ltext0:
  17              	 .cfi_sections .debug_frame
  18              	 .section .text._ZN4host20processCommandPacketERK8InPacketR9OutPacket,"ax",%progbits
  19              	 .align 2
  20              	 .global _ZN4host20processCommandPacketERK8InPacketR9OutPacket
  21              	 .thumb
  22              	 .thumb_func
  24              	_ZN4host20processCommandPacketERK8InPacketR9OutPacket:
  25              	.LFB119:
  26              	 .file 1 "src/MightyBoard/Motherboard/Host.cc"
   1:src/MightyBoard/Motherboard/Host.cc **** /*
   2:src/MightyBoard/Motherboard/Host.cc ****  * Copyright 2010 by Adam Mayer	 <adam@makerbot.com>
   3:src/MightyBoard/Motherboard/Host.cc ****  *
   4:src/MightyBoard/Motherboard/Host.cc ****  * This program is free software: you can redistribute it and/or modify
   5:src/MightyBoard/Motherboard/Host.cc ****  * it under the terms of the GNU General Public License as published by
   6:src/MightyBoard/Motherboard/Host.cc ****  * the Free Software Foundation, either version 3 of the License, or
   7:src/MightyBoard/Motherboard/Host.cc ****  * (at your option) any later version.
   8:src/MightyBoard/Motherboard/Host.cc ****  *
   9:src/MightyBoard/Motherboard/Host.cc ****  * This program is distributed in the hope that it will be useful,
  10:src/MightyBoard/Motherboard/Host.cc ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:src/MightyBoard/Motherboard/Host.cc ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:src/MightyBoard/Motherboard/Host.cc ****  * GNU General Public License for more details.
  13:src/MightyBoard/Motherboard/Host.cc ****  *
  14:src/MightyBoard/Motherboard/Host.cc ****  * You should have received a copy of the GNU General Public License
  15:src/MightyBoard/Motherboard/Host.cc ****  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  16:src/MightyBoard/Motherboard/Host.cc ****  */
  17:src/MightyBoard/Motherboard/Host.cc ****  
  18:src/MightyBoard/Motherboard/Host.cc **** #include "Host.hh"
  19:src/MightyBoard/Motherboard/Host.cc **** #include "Command.hh"
  20:src/MightyBoard/Motherboard/Host.cc **** #include <string.h>
  21:src/MightyBoard/Motherboard/Host.cc **** #include "Commands.hh"
  22:src/MightyBoard/Motherboard/Host.cc **** #include "Steppers.hh"
  23:src/MightyBoard/Motherboard/Host.cc **** #include "DebugPacketProcessor.hh"
  24:src/MightyBoard/Motherboard/Host.cc **** #include "Timeout.hh"
  25:src/MightyBoard/Motherboard/Host.cc **** #include "Version.hh"
  26:src/MightyBoard/Motherboard/Host.cc **** //#include <util/atomic.h>
  27:src/MightyBoard/Motherboard/Host.cc **** //#include <avr/eeprom.h>
  28:src/MightyBoard/Motherboard/Host.cc **** //#include <avr/pgmspace.h>
  29:src/MightyBoard/Motherboard/Host.cc **** //#include <util/delay.h>
  30:src/MightyBoard/Motherboard/Host.cc **** //#include <avr/wdt.h>
  31:src/MightyBoard/Motherboard/Host.cc **** #include "Main.hh"
  32:src/MightyBoard/Motherboard/Host.cc **** #include "Errors.hh"
  33:src/MightyBoard/Motherboard/Host.cc **** #include "Eeprom.hh"
  34:src/MightyBoard/Motherboard/Host.cc **** #include "EepromMap.hh"
  35:src/MightyBoard/Motherboard/Host.cc **** #include "UtilityScripts.hh"
  36:src/MightyBoard/Motherboard/Host.cc **** #include "Planner.hh"
  37:src/MightyBoard/Motherboard/Host.cc **** #include "stdio.h"
  38:src/MightyBoard/Motherboard/Host.cc **** 
  39:src/MightyBoard/Motherboard/Host.cc **** #include "Delay.hh"
  40:src/MightyBoard/Motherboard/Host.cc **** #include "UART.hh"
  41:src/MightyBoard/Motherboard/Host.cc **** extern "C" {
  42:src/MightyBoard/Motherboard/Host.cc **** 	#include "pgmspace.h"
  43:src/MightyBoard/Motherboard/Host.cc **** #include "comm.h"
  44:src/MightyBoard/Motherboard/Host.cc **** }
  45:src/MightyBoard/Motherboard/Host.cc **** 
  46:src/MightyBoard/Motherboard/Host.cc **** namespace host {
  47:src/MightyBoard/Motherboard/Host.cc **** 
  48:src/MightyBoard/Motherboard/Host.cc **** /// Identify a command packet, and process it.  If the packet is a command
  49:src/MightyBoard/Motherboard/Host.cc **** /// packet, return true, indicating that the packet has been queued and no
  50:src/MightyBoard/Motherboard/Host.cc **** /// other processing needs to be done. Otherwise, processing of this packet
  51:src/MightyBoard/Motherboard/Host.cc **** /// should drop through to the next processing level.
  52:src/MightyBoard/Motherboard/Host.cc **** bool processCommandPacket(const InPacket& from_host, OutPacket& to_host);
  53:src/MightyBoard/Motherboard/Host.cc **** bool processQueryPacket(const InPacket& from_host, OutPacket& to_host);
  54:src/MightyBoard/Motherboard/Host.cc **** bool processExtruderQueryPacket(const InPacket& from_host, OutPacket& to_host);
  55:src/MightyBoard/Motherboard/Host.cc **** 
  56:src/MightyBoard/Motherboard/Host.cc **** // Timeout from time first bit recieved until we abort packet reception
  57:src/MightyBoard/Motherboard/Host.cc **** Timeout packet_in_timeout;
  58:src/MightyBoard/Motherboard/Host.cc **** Timeout cancel_timeout;
  59:src/MightyBoard/Motherboard/Host.cc **** 
  60:src/MightyBoard/Motherboard/Host.cc **** #define HOST_PACKET_TIMEOUT_MS 200
  61:src/MightyBoard/Motherboard/Host.cc **** #define HOST_PACKET_TIMEOUT_MICROS (1000L*HOST_PACKET_TIMEOUT_MS)
  62:src/MightyBoard/Motherboard/Host.cc **** 
  63:src/MightyBoard/Motherboard/Host.cc **** //#define HOST_TOOL_RESPONSE_TIMEOUT_MS 50
  64:src/MightyBoard/Motherboard/Host.cc **** //#define HOST_TOOL_RESPONSE_TIMEOUT_MICROS (1000L*HOST_TOOL_RESPONSE_TIMEOUT_MS)
  65:src/MightyBoard/Motherboard/Host.cc **** 
  66:src/MightyBoard/Motherboard/Host.cc **** char machineName[eeprom_info::MAX_MACHINE_NAME_LEN];
  67:src/MightyBoard/Motherboard/Host.cc **** 
  68:src/MightyBoard/Motherboard/Host.cc **** char buildName[MAX_FILE_LEN];
  69:src/MightyBoard/Motherboard/Host.cc **** 
  70:src/MightyBoard/Motherboard/Host.cc **** uint32_t buildSteps;
  71:src/MightyBoard/Motherboard/Host.cc **** 
  72:src/MightyBoard/Motherboard/Host.cc **** /// Used to indicate what the UI should do, and used by
  73:src/MightyBoard/Motherboard/Host.cc **** /// host process to know what state it's in for error/command allowed.
  74:src/MightyBoard/Motherboard/Host.cc **** /// doesn't change state machine per-se, but sets context for other cmds.
  75:src/MightyBoard/Motherboard/Host.cc **** HostState currentState;
  76:src/MightyBoard/Motherboard/Host.cc **** 
  77:src/MightyBoard/Motherboard/Host.cc **** /// Used to indicate the status of the current or last finished print
  78:src/MightyBoard/Motherboard/Host.cc **** /// is queryable by repG and by the stats screen during builds
  79:src/MightyBoard/Motherboard/Host.cc **** BuildState buildState = BUILD_NONE;
  80:src/MightyBoard/Motherboard/Host.cc **** 
  81:src/MightyBoard/Motherboard/Host.cc **** /// queryable time for last print
  82:src/MightyBoard/Motherboard/Host.cc **** uint8_t last_print_hours = 0;
  83:src/MightyBoard/Motherboard/Host.cc **** uint8_t last_print_minutes = 0;
  84:src/MightyBoard/Motherboard/Host.cc **** 
  85:src/MightyBoard/Motherboard/Host.cc **** uint32_t last_print_line = 0;
  86:src/MightyBoard/Motherboard/Host.cc **** 
  87:src/MightyBoard/Motherboard/Host.cc **** /// counter for current print time
  88:src/MightyBoard/Motherboard/Host.cc **** uint8_t print_time_hours = 0;
  89:src/MightyBoard/Motherboard/Host.cc **** Timeout print_time;
  90:src/MightyBoard/Motherboard/Host.cc **** 
  91:src/MightyBoard/Motherboard/Host.cc **** const static uint32_t ONE_HOUR = 3600000000;
  92:src/MightyBoard/Motherboard/Host.cc **** 
  93:src/MightyBoard/Motherboard/Host.cc **** 
  94:src/MightyBoard/Motherboard/Host.cc **** bool do_host_reset = false;
  95:src/MightyBoard/Motherboard/Host.cc **** bool hard_reset = false;
  96:src/MightyBoard/Motherboard/Host.cc **** bool cancelBuild = false;
  97:src/MightyBoard/Motherboard/Host.cc **** 
  98:src/MightyBoard/Motherboard/Host.cc **** void runHostSlice() {
  99:src/MightyBoard/Motherboard/Host.cc **** 
 100:src/MightyBoard/Motherboard/Host.cc ****         InPacket& in = UART::getHostUART().in;
 101:src/MightyBoard/Motherboard/Host.cc ****         OutPacket& out = UART::getHostUART().out;
 102:src/MightyBoard/Motherboard/Host.cc **** 	if (out.isSending()) {
 103:src/MightyBoard/Motherboard/Host.cc **** 		// still sending; wait until send is complete before reading new host packets.
 104:src/MightyBoard/Motherboard/Host.cc **** 		return;
 105:src/MightyBoard/Motherboard/Host.cc **** 	}
 106:src/MightyBoard/Motherboard/Host.cc ****     // soft reset the machine unless waiting to notify repG that a cancel has occured
 107:src/MightyBoard/Motherboard/Host.cc **** 	if (do_host_reset && (!cancelBuild || cancel_timeout.hasElapsed())){
 108:src/MightyBoard/Motherboard/Host.cc **** 
 109:src/MightyBoard/Motherboard/Host.cc **** 
 110:src/MightyBoard/Motherboard/Host.cc **** 		
 111:src/MightyBoard/Motherboard/Host.cc **** 		if((buildState == BUILD_RUNNING) || (buildState == BUILD_PAUSED)){
 112:src/MightyBoard/Motherboard/Host.cc **** 			stopBuild();
 113:src/MightyBoard/Motherboard/Host.cc **** 		}
 114:src/MightyBoard/Motherboard/Host.cc **** 		do_host_reset = false;
 115:src/MightyBoard/Motherboard/Host.cc **** 
 116:src/MightyBoard/Motherboard/Host.cc **** 		// reset local board
 117:src/MightyBoard/Motherboard/Host.cc **** 		reset(hard_reset);
 118:src/MightyBoard/Motherboard/Host.cc **** 		
 119:src/MightyBoard/Motherboard/Host.cc ****         // hard_reset can be called, but is not called by any
 120:src/MightyBoard/Motherboard/Host.cc ****         // a hard reset calls the start up sound and resets heater errors
 121:src/MightyBoard/Motherboard/Host.cc **** 		hard_reset = false;
 122:src/MightyBoard/Motherboard/Host.cc **** 		packet_in_timeout.abort();
 123:src/MightyBoard/Motherboard/Host.cc **** 
 124:src/MightyBoard/Motherboard/Host.cc **** 		// Clear the machine and build names
 125:src/MightyBoard/Motherboard/Host.cc **** 		machineName[0] = 0;
 126:src/MightyBoard/Motherboard/Host.cc **** 		buildName[0] = 0;
 127:src/MightyBoard/Motherboard/Host.cc **** 		currentState = HOST_STATE_READY;
 128:src/MightyBoard/Motherboard/Host.cc **** 			
 129:src/MightyBoard/Motherboard/Host.cc **** 		return;
 130:src/MightyBoard/Motherboard/Host.cc **** 	}
 131:src/MightyBoard/Motherboard/Host.cc ****     // new packet coming in
 132:src/MightyBoard/Motherboard/Host.cc **** 	if (in.isStarted() && !in.isFinished()) {
 133:src/MightyBoard/Motherboard/Host.cc **** 		xprintf("in.isStarted() && !in.isFinished()" " (%s:%d)\n",_F_,_L_);
 134:src/MightyBoard/Motherboard/Host.cc **** 		if (!packet_in_timeout.isActive()) {
 135:src/MightyBoard/Motherboard/Host.cc **** 			// initiate timeout
 136:src/MightyBoard/Motherboard/Host.cc **** 			packet_in_timeout.start(HOST_PACKET_TIMEOUT_MICROS);
 137:src/MightyBoard/Motherboard/Host.cc **** 		} else if (packet_in_timeout.hasElapsed()) {
 138:src/MightyBoard/Motherboard/Host.cc **** 			in.timeout();
 139:src/MightyBoard/Motherboard/Host.cc **** 		}
 140:src/MightyBoard/Motherboard/Host.cc **** 
 141:src/MightyBoard/Motherboard/Host.cc **** 	}
 142:src/MightyBoard/Motherboard/Host.cc **** 	if (in.hasError()) {
 143:src/MightyBoard/Motherboard/Host.cc **** //		xprintf("in.hasError()" " (%s:%d)\n",_F_,_L_);
 144:src/MightyBoard/Motherboard/Host.cc **** 		// Reset packet quickly and start handling the next packet.
 145:src/MightyBoard/Motherboard/Host.cc **** 		
 146:src/MightyBoard/Motherboard/Host.cc **** 	/*	out.reset();
 147:src/MightyBoard/Motherboard/Host.cc **** 			
 148:src/MightyBoard/Motherboard/Host.cc **** 		// Report error code.
 149:src/MightyBoard/Motherboard/Host.cc **** 		switch (in.getErrorCode()){
 150:src/MightyBoard/Motherboard/Host.cc **** 			case PacketError::PACKET_TIMEOUT:
 151:src/MightyBoard/Motherboard/Host.cc **** 				out.append8(RC_PACKET_TIMEOUT);
 152:src/MightyBoard/Motherboard/Host.cc **** 				break;
 153:src/MightyBoard/Motherboard/Host.cc **** 			case PacketError::BAD_CRC:
 154:src/MightyBoard/Motherboard/Host.cc **** 				out.append8(RC_CRC_MISMATCH);
 155:src/MightyBoard/Motherboard/Host.cc **** 				break;
 156:src/MightyBoard/Motherboard/Host.cc **** 			case PacketError::EXCEEDED_MAX_LENGTH:
 157:src/MightyBoard/Motherboard/Host.cc **** 				out.append8(RC_PACKET_LENGTH);
 158:src/MightyBoard/Motherboard/Host.cc **** 				break;
 159:src/MightyBoard/Motherboard/Host.cc **** 			default:
 160:src/MightyBoard/Motherboard/Host.cc **** 				out.append8(RC_PACKET_ERROR);
 161:src/MightyBoard/Motherboard/Host.cc **** 				break;
 162:src/MightyBoard/Motherboard/Host.cc **** 		}
 163:src/MightyBoard/Motherboard/Host.cc **** 		*/  	
 164:src/MightyBoard/Motherboard/Host.cc **** 		in.reset();
 165:src/MightyBoard/Motherboard/Host.cc **** 		//UART::getHostUART().beginSend();
 166:src/MightyBoard/Motherboard/Host.cc **** 		//Motherboard::getBoard().indicateError(ERR_HOST_PACKET_MISC);
 167:src/MightyBoard/Motherboard/Host.cc **** 		
 168:src/MightyBoard/Motherboard/Host.cc **** 	}
 169:src/MightyBoard/Motherboard/Host.cc **** 	if (in.isFinished()) {
 170:src/MightyBoard/Motherboard/Host.cc **** //		xprintf("in.isFinished()" " (%s:%d)\n",_F_,_L_);
 171:src/MightyBoard/Motherboard/Host.cc **** 		DEBUG_PIN1.setValue(false);
 172:src/MightyBoard/Motherboard/Host.cc **** 		packet_in_timeout.abort();
 173:src/MightyBoard/Motherboard/Host.cc **** 		out.reset();
 174:src/MightyBoard/Motherboard/Host.cc **** 	  // do not respond to commands if the bot has had a heater failure
 175:src/MightyBoard/Motherboard/Host.cc **** 		if(currentState == HOST_STATE_HEAT_SHUTDOWN){
 176:src/MightyBoard/Motherboard/Host.cc **** 			if(cancelBuild){
 177:src/MightyBoard/Motherboard/Host.cc **** 				out.append8(RC_CANCEL_BUILD);
 178:src/MightyBoard/Motherboard/Host.cc **** 				cancelBuild= false;
 179:src/MightyBoard/Motherboard/Host.cc **** 			}else{
 180:src/MightyBoard/Motherboard/Host.cc **** 				out.append8(RC_BOT_OVERHEAT);
 181:src/MightyBoard/Motherboard/Host.cc **** 			}
 182:src/MightyBoard/Motherboard/Host.cc **** 		}else if(cancelBuild){
 183:src/MightyBoard/Motherboard/Host.cc **** 			out.append8(RC_CANCEL_BUILD);
 184:src/MightyBoard/Motherboard/Host.cc **** 			cancelBuild = false;
 185:src/MightyBoard/Motherboard/Host.cc **** 			Motherboard::getBoard().indicateError(6);
 186:src/MightyBoard/Motherboard/Host.cc **** 		} else
 187:src/MightyBoard/Motherboard/Host.cc **** #if defined(HONOR_DEBUG_PACKETS) && (HONOR_DEBUG_PACKETS == 1)
 188:src/MightyBoard/Motherboard/Host.cc **** 		if (processDebugPacket(in, out)) {
 189:src/MightyBoard/Motherboard/Host.cc **** 			// okay, processed
 190:src/MightyBoard/Motherboard/Host.cc **** 		} else
 191:src/MightyBoard/Motherboard/Host.cc **** #endif
 192:src/MightyBoard/Motherboard/Host.cc **** 		if (processCommandPacket(in, out)) {
 193:src/MightyBoard/Motherboard/Host.cc **** 			// okay, processed
 194:src/MightyBoard/Motherboard/Host.cc **** 		} else if (processQueryPacket(in, out)) {
 195:src/MightyBoard/Motherboard/Host.cc **** 			// okay, processed
 196:src/MightyBoard/Motherboard/Host.cc **** 		} else {
 197:src/MightyBoard/Motherboard/Host.cc **** 			// Unrecognized command
 198:src/MightyBoard/Motherboard/Host.cc **** 			out.append8(RC_CMD_UNSUPPORTED);
 199:src/MightyBoard/Motherboard/Host.cc **** 		}
 200:src/MightyBoard/Motherboard/Host.cc **** 		in.reset();
 201:src/MightyBoard/Motherboard/Host.cc ****                 UART::getHostUART().beginSend();
 202:src/MightyBoard/Motherboard/Host.cc **** 	}
 203:src/MightyBoard/Motherboard/Host.cc ****     /// mark new state as ready if done building from SD
 204:src/MightyBoard/Motherboard/Host.cc **** 	if(currentState==HOST_STATE_BUILDING_FROM_SD)
 205:src/MightyBoard/Motherboard/Host.cc **** 	{
 206:src/MightyBoard/Motherboard/Host.cc **** 		if(!sdcard::isPlaying())
 207:src/MightyBoard/Motherboard/Host.cc **** 			currentState = HOST_STATE_READY;
 208:src/MightyBoard/Motherboard/Host.cc **** 	}
 209:src/MightyBoard/Motherboard/Host.cc ****     // mark new state as ready if done buiding onboard script
 210:src/MightyBoard/Motherboard/Host.cc **** 	if((currentState==HOST_STATE_BUILDING_ONBOARD))
 211:src/MightyBoard/Motherboard/Host.cc **** 	{
 212:src/MightyBoard/Motherboard/Host.cc **** 		if(!utility::isPlaying()){
 213:src/MightyBoard/Motherboard/Host.cc **** 			currentState = HOST_STATE_READY;
 214:src/MightyBoard/Motherboard/Host.cc **** 		}
 215:src/MightyBoard/Motherboard/Host.cc **** 	}
 216:src/MightyBoard/Motherboard/Host.cc **** 	managePrintTime();
 217:src/MightyBoard/Motherboard/Host.cc **** }
 218:src/MightyBoard/Motherboard/Host.cc **** 
 219:src/MightyBoard/Motherboard/Host.cc **** /** Identify a command packet, and process it.  If the packet is a command
 220:src/MightyBoard/Motherboard/Host.cc ****  * packet, return true, indicating that the packet has been queued and no
 221:src/MightyBoard/Motherboard/Host.cc ****  * other processing needs to be done. Otherwise, processing of this packet
 222:src/MightyBoard/Motherboard/Host.cc ****  * should drop through to the next processing level.
 223:src/MightyBoard/Motherboard/Host.cc ****  */
 224:src/MightyBoard/Motherboard/Host.cc **** bool processCommandPacket(const InPacket& from_host, OutPacket& to_host) {
  27              	 .loc 1 224 0
  28              	 .cfi_startproc
  29              	 
  30              	 
  31              	.LVL0:
  32 0000 F8B5     	 push {r3,r4,r5,r6,r7,lr}
  33              	.LCFI0:
  34              	 .cfi_def_cfa_offset 24
  35              	 .cfi_offset 14,-4
  36              	 .cfi_offset 7,-8
  37              	 .cfi_offset 6,-12
  38              	 .cfi_offset 5,-16
  39              	 .cfi_offset 4,-20
  40              	 .cfi_offset 3,-24
  41 0002 0446     	 mov r4,r0
  42 0004 0D46     	 mov r5,r1
  43              	.LVL1:
  44              	.LBB194:
  45              	.LBB195:
  46              	.LBB196:
  47              	 .file 2 "src/MightyBoard/shared/Packet.hh"
   1:src/MightyBoard/shared/Packet.hh **** /*
   2:src/MightyBoard/shared/Packet.hh ****  * Copyright 2010 by Adam Mayer	 <adam@makerbot.com>
   3:src/MightyBoard/shared/Packet.hh ****  *
   4:src/MightyBoard/shared/Packet.hh ****  * This program is free software: you can redistribute it and/or modify
   5:src/MightyBoard/shared/Packet.hh ****  * it under the terms of the GNU General Public License as published by
   6:src/MightyBoard/shared/Packet.hh ****  * the Free Software Foundation, either version 3 of the License, or
   7:src/MightyBoard/shared/Packet.hh ****  * (at your option) any later version.
   8:src/MightyBoard/shared/Packet.hh ****  *
   9:src/MightyBoard/shared/Packet.hh ****  * This program is distributed in the hope that it will be useful,
  10:src/MightyBoard/shared/Packet.hh ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:src/MightyBoard/shared/Packet.hh ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:src/MightyBoard/shared/Packet.hh ****  * GNU General Public License for more details.
  13:src/MightyBoard/shared/Packet.hh ****  *
  14:src/MightyBoard/shared/Packet.hh ****  * You should have received a copy of the GNU General Public License
  15:src/MightyBoard/shared/Packet.hh ****  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  16:src/MightyBoard/shared/Packet.hh ****  */
  17:src/MightyBoard/shared/Packet.hh **** 
  18:src/MightyBoard/shared/Packet.hh **** #ifndef SHARED_PACKET_HH_
  19:src/MightyBoard/shared/Packet.hh **** #define SHARED_PACKET_HH_
  20:src/MightyBoard/shared/Packet.hh **** 
  21:src/MightyBoard/shared/Packet.hh **** #include <stdint.h>
  22:src/MightyBoard/shared/Packet.hh **** 
  23:src/MightyBoard/shared/Packet.hh **** extern "C" {
  24:src/MightyBoard/shared/Packet.hh **** #include "comm.h"
  25:src/MightyBoard/shared/Packet.hh **** }
  26:src/MightyBoard/shared/Packet.hh **** 
  27:src/MightyBoard/shared/Packet.hh **** #define START_BYTE 0xD5
  28:src/MightyBoard/shared/Packet.hh **** #define MAX_PACKET_PAYLOAD 32
  29:src/MightyBoard/shared/Packet.hh **** 
  30:src/MightyBoard/shared/Packet.hh **** #define SLAVE_ID_BROADCAST 127
  31:src/MightyBoard/shared/Packet.hh **** 
  32:src/MightyBoard/shared/Packet.hh **** namespace PacketError {
  33:src/MightyBoard/shared/Packet.hh **** enum {
  34:src/MightyBoard/shared/Packet.hh **** 	NO_ERROR,
  35:src/MightyBoard/shared/Packet.hh **** 	NOISE_BYTE,
  36:src/MightyBoard/shared/Packet.hh **** 	EXCEEDED_MAX_LENGTH,
  37:src/MightyBoard/shared/Packet.hh **** 	BAD_CRC,
  38:src/MightyBoard/shared/Packet.hh **** 	PACKET_TIMEOUT,
  39:src/MightyBoard/shared/Packet.hh **** };
  40:src/MightyBoard/shared/Packet.hh **** } // namespace PacketError
  41:src/MightyBoard/shared/Packet.hh **** 
  42:src/MightyBoard/shared/Packet.hh **** /// These are the response codes returned to the requestor
  43:src/MightyBoard/shared/Packet.hh **** /// as the first byte of the response payload.  You can find
  44:src/MightyBoard/shared/Packet.hh **** /// a list of the expected codes in the protocol specification
  45:src/MightyBoard/shared/Packet.hh **** /// document:
  46:src/MightyBoard/shared/Packet.hh **** /// http://docs.google.com/Doc?docid=0AcWKwJ2SAxDzZGd6amZyY2NfMmdtODRnZ2Ri&hl=en
  47:src/MightyBoard/shared/Packet.hh **** typedef enum {
  48:src/MightyBoard/shared/Packet.hh ****         RC_PACKET_ERROR    = 0x80, /* Generic Error. Is this packet simply discarded? */
  49:src/MightyBoard/shared/Packet.hh ****         RC_OK               = 0x81,
  50:src/MightyBoard/shared/Packet.hh ****         RC_BUFFER_OVERFLOW  = 0x82,
  51:src/MightyBoard/shared/Packet.hh ****         RC_CRC_MISMATCH     = 0x83,
  52:src/MightyBoard/shared/Packet.hh ****         RC_PACKET_LENGTH    = 0x84,
  53:src/MightyBoard/shared/Packet.hh ****         RC_CMD_UNSUPPORTED  = 0x85,
  54:src/MightyBoard/shared/Packet.hh ****         RC_EXPECT_MORE      = 0x86,
  55:src/MightyBoard/shared/Packet.hh ****         RC_DOWNSTREAM_TIMEOUT = 0x87,
  56:src/MightyBoard/shared/Packet.hh ****         RC_TOOL_LOCK_TIMEOUT = 0x88,
  57:src/MightyBoard/shared/Packet.hh ****         RC_CANCEL_BUILD		= 0x89, 
  58:src/MightyBoard/shared/Packet.hh ****         RC_BOT_BUILDING		= 0x8A,  // this response is returned if the bot is building from SD card 
  59:src/MightyBoard/shared/Packet.hh ****         RC_BOT_OVERHEAT		= 0x8B,	// if the bot overheats, it will not respond to commands
  60:src/MightyBoard/shared/Packet.hh ****         RC_PACKET_TIMEOUT	= 0x8C
  61:src/MightyBoard/shared/Packet.hh **** } ResponseCode;
  62:src/MightyBoard/shared/Packet.hh **** 
  63:src/MightyBoard/shared/Packet.hh **** /// Convenience function to accept old response codes
  64:src/MightyBoard/shared/Packet.hh **** /// (missing the high bits) as well as the new forms.
  65:src/MightyBoard/shared/Packet.hh **** inline bool rcCompare(uint8_t data, ResponseCode code) {
  66:src/MightyBoard/shared/Packet.hh **** 	return (data & 0x7f) == (code & 0x7f);
  67:src/MightyBoard/shared/Packet.hh **** }
  68:src/MightyBoard/shared/Packet.hh **** 
  69:src/MightyBoard/shared/Packet.hh **** class Packet {
  70:src/MightyBoard/shared/Packet.hh **** protected:
  71:src/MightyBoard/shared/Packet.hh **** 	// packet states
  72:src/MightyBoard/shared/Packet.hh **** 	typedef enum {
  73:src/MightyBoard/shared/Packet.hh **** 		PS_START,
  74:src/MightyBoard/shared/Packet.hh **** 		PS_LEN,
  75:src/MightyBoard/shared/Packet.hh **** 		PS_PAYLOAD,
  76:src/MightyBoard/shared/Packet.hh **** 		PS_CRC,
  77:src/MightyBoard/shared/Packet.hh **** 		PS_LAST
  78:src/MightyBoard/shared/Packet.hh **** 	} PacketState;
  79:src/MightyBoard/shared/Packet.hh **** 
  80:src/MightyBoard/shared/Packet.hh ****     volatile uint8_t length; /// The current length of the payload (data[0] if raw packets)
  81:src/MightyBoard/shared/Packet.hh ****     volatile uint8_t crc; /// The CRC of the current contents of the payload (data[-1] of raw packe
  82:src/MightyBoard/shared/Packet.hh ****     volatile uint8_t payload[MAX_PACKET_PAYLOAD]; /// Data payload (starts at data[2] of raw packet
  83:src/MightyBoard/shared/Packet.hh **** 	volatile uint8_t error_code; // Have any errors cropped up during processing?
  84:src/MightyBoard/shared/Packet.hh **** 	volatile PacketState state;
  85:src/MightyBoard/shared/Packet.hh **** 
  86:src/MightyBoard/shared/Packet.hh **** 
  87:src/MightyBoard/shared/Packet.hh **** 	/// Append a byte and update the CRC
  88:src/MightyBoard/shared/Packet.hh **** 	void appendByte(uint8_t data);
  89:src/MightyBoard/shared/Packet.hh **** 	/// Reset this packet to an empty state
  90:src/MightyBoard/shared/Packet.hh **** 	void reset();
  91:src/MightyBoard/shared/Packet.hh **** 
  92:src/MightyBoard/shared/Packet.hh **** 	void error(uint8_t error_code_in) {
  93:src/MightyBoard/shared/Packet.hh **** 		reset();
  94:src/MightyBoard/shared/Packet.hh **** 		error_code = error_code_in;
  95:src/MightyBoard/shared/Packet.hh **** 	}
  96:src/MightyBoard/shared/Packet.hh **** public:
  97:src/MightyBoard/shared/Packet.hh **** 	uint8_t getLength() const { return length; }
  48              	 .loc 2 97 0
  49 0006 0378     	 ldrb r3,[r0,#0]
  50              	.LBE196:
  51              	.LBE195:
 225:src/MightyBoard/Motherboard/Host.cc **** 	if (from_host.getLength() >= 1) {
  52              	 .loc 1 225 0
  53 0008 002B     	 cmp r3,#0
  54 000a 42D0     	 beq .L10
  55              	.LBB197:
 226:src/MightyBoard/Motherboard/Host.cc **** 		uint8_t command = from_host.read8(0);
  56              	 .loc 1 226 0
  57 000c 0646     	 mov r6,r0
  58 000e 4FF00001 	 mov r1,#0
  59              	.LVL2:
  60 0012 FFF7FEFF 	 bl _ZNK6Packet5read8Eh
  61              	.LVL3:
  62              	.LBB198:
 227:src/MightyBoard/Motherboard/Host.cc **** 		if ((command & 0x80) != 0) {
  63              	 .loc 1 227 0
  64 0016 10F0800F 	 tst r0,#128
  65 001a 3DD0     	 beq .L11
  66              	.LBB199:
 228:src/MightyBoard/Motherboard/Host.cc **** 			// If we're capturing a file to an SD card, we send it to the sdcard module
 229:src/MightyBoard/Motherboard/Host.cc **** 			// for processing.
 230:src/MightyBoard/Motherboard/Host.cc **** 			if (sdcard::isCapturing()) {
  67              	 .loc 1 230 0
  68 001c FFF7FEFF 	 bl _ZN6sdcard11isCapturingEv
  69              	.LVL4:
  70 0020 50B1     	 cbz r0,.L3
 231:src/MightyBoard/Motherboard/Host.cc **** 				sdcard::capturePacket(from_host);
  71              	 .loc 1 231 0
  72 0022 2046     	 mov r0,r4
  73 0024 FFF7FEFF 	 bl _ZN6sdcard13capturePacketERK6Packet
 232:src/MightyBoard/Motherboard/Host.cc **** 				to_host.append8(RC_OK);
  74              	 .loc 1 232 0
  75 0028 2846     	 mov r0,r5
  76 002a 4FF08101 	 mov r1,#129
  77 002e FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 233:src/MightyBoard/Motherboard/Host.cc **** 				return true;
  78              	 .loc 1 233 0
  79 0032 4FF00100 	 mov r0,#1
  80 0036 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
  81              	.L3:
 234:src/MightyBoard/Motherboard/Host.cc **** 			}
 235:src/MightyBoard/Motherboard/Host.cc **** 			if(sdcard::isPlaying() || utility::isPlaying()){
  82              	 .loc 1 235 0
  83 0038 FFF7FEFF 	 bl _ZN6sdcard9isPlayingEv
  84 003c 18B9     	 cbnz r0,.L4
  85              	 .loc 1 235 0 is_stmt 0 discriminator 2
  86 003e FFF7FEFF 	 bl _ZN7utility9isPlayingEv
  87 0042 0028     	 cmp r0,#0
  88 0044 2BD0     	 beq .L5
  89              	.L4:
 236:src/MightyBoard/Motherboard/Host.cc **** 				// ignore action commands if SD card build is playing
 237:src/MightyBoard/Motherboard/Host.cc **** 				// or if ONBOARD script is playing
 238:src/MightyBoard/Motherboard/Host.cc **** 				to_host.append8(RC_BOT_BUILDING);
  90              	 .loc 1 238 0 is_stmt 1 discriminator 4
  91 0046 2846     	 mov r0,r5
  92 0048 4FF08A01 	 mov r1,#138
  93 004c FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 239:src/MightyBoard/Motherboard/Host.cc **** 				return true;
  94              	 .loc 1 239 0 discriminator 4
  95 0050 4FF00100 	 mov r0,#1
  96 0054 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
  97              	.LVL5:
  98              	.L8:
  99              	.LBB200:
 100              	.LBB201:
 101              	.LBB202:
 240:src/MightyBoard/Motherboard/Host.cc **** 			}
 241:src/MightyBoard/Motherboard/Host.cc **** 			
 242:src/MightyBoard/Motherboard/Host.cc **** 			// Queue command, if there's room.
 243:src/MightyBoard/Motherboard/Host.cc **** 			// Turn off interrupts while querying or manipulating the queue!
 244:src/MightyBoard/Motherboard/Host.cc **** //			ATOMIC_BLOCK(ATOMIC_FORCEON) {
 245:src/MightyBoard/Motherboard/Host.cc **** 				const uint8_t command_length = from_host.getLength();
 246:src/MightyBoard/Motherboard/Host.cc **** 				if (command::getRemainingCapacity() >= command_length) {
 247:src/MightyBoard/Motherboard/Host.cc **** 					// Append command to buffer
 248:src/MightyBoard/Motherboard/Host.cc **** 					for (int i = 0; i < command_length; i++) {
 102              	 .loc 1 248 0 discriminator 1
 103 0056 2746     	 mov r7,r4
 104 0058 5CB1     	 cbz r4,.L6
 105              	 .loc 1 248 0 is_stmt 0
 106 005a 4FF00004 	 mov r4,#0
 107              	.LVL6:
 108              	.L7:
 249:src/MightyBoard/Motherboard/Host.cc **** 						command::push(from_host.read8(i));
 109              	 .loc 1 249 0 is_stmt 1 discriminator 2
 110 005e 3046     	 mov r0,r6
 111 0060 E1B2     	 uxtb r1,r4
 112 0062 FFF7FEFF 	 bl _ZNK6Packet5read8Eh
 113 0066 FFF7FEFF 	 bl _ZN7command4pushEh
 248:src/MightyBoard/Motherboard/Host.cc **** 					for (int i = 0; i < command_length; i++) {
 114              	 .loc 1 248 0 discriminator 2
 115 006a 04F10104 	 add r4,r4,#1
 116              	.LVL7:
 117 006e BC42     	 cmp r4,r7
 118 0070 F5DB     	 blt .L7
 119              	.LVL8:
 120              	.L6:
 121              	.LBE202:
 250:src/MightyBoard/Motherboard/Host.cc **** 					}
 251:src/MightyBoard/Motherboard/Host.cc **** 					to_host.append8(RC_OK);
 122              	 .loc 1 251 0
 123 0072 2846     	 mov r0,r5
 124 0074 4FF08101 	 mov r1,#129
 125 0078 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 252:src/MightyBoard/Motherboard/Host.cc **** 				} else {
 253:src/MightyBoard/Motherboard/Host.cc **** 					to_host.append8(RC_BUFFER_OVERFLOW);
 254:src/MightyBoard/Motherboard/Host.cc **** 				}
 255:src/MightyBoard/Motherboard/Host.cc **** //			}
 256:src/MightyBoard/Motherboard/Host.cc **** 			return true;
 126              	 .loc 1 256 0
 127 007c 4FF00100 	 mov r0,#1
 128 0080 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 129              	.L14:
 130              	.LBE201:
 253:src/MightyBoard/Motherboard/Host.cc **** 					to_host.append8(RC_BUFFER_OVERFLOW);
 131              	 .loc 1 253 0
 132 0082 2846     	 mov r0,r5
 133 0084 4FF08201 	 mov r1,#130
 134 0088 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 135              	 .loc 1 256 0
 136 008c 4FF00100 	 mov r0,#1
 137 0090 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 138              	.LVL9:
 139              	.L10:
 140              	.LBE200:
 141              	.LBE199:
 142              	.LBE198:
 143              	.LBE197:
 257:src/MightyBoard/Motherboard/Host.cc **** 		}
 258:src/MightyBoard/Motherboard/Host.cc **** 	}
 259:src/MightyBoard/Motherboard/Host.cc **** 	return false;
 144              	 .loc 1 259 0
 145 0092 4FF00000 	 mov r0,#0
 146              	.LVL10:
 147 0096 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 148              	.LVL11:
 149              	.L11:
 150              	.LBB209:
 151              	.LBB207:
 152 0098 4FF00000 	 mov r0,#0
 153              	.LVL12:
 154              	.LBE207:
 155              	.LBE209:
 156              	.LBE194:
 260:src/MightyBoard/Motherboard/Host.cc **** }
 157              	 .loc 1 260 0
 158 009c F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 159              	.L5:
 160              	.LVL13:
 161              	.LBB211:
 162              	.LBB210:
 163              	.LBB208:
 164              	.LBB206:
 165              	.LBB203:
 166              	.LBB204:
 167              	 .loc 2 97 0
 168 009e 2478     	 ldrb r4,[r4,#0]
 169              	.LVL14:
 170              	.LBE204:
 171              	.LBE203:
 172              	.LBB205:
 246:src/MightyBoard/Motherboard/Host.cc **** 				if (command::getRemainingCapacity() >= command_length) {
 173              	 .loc 1 246 0
 174 00a0 FFF7FEFF 	 bl _ZN7command20getRemainingCapacityEv
 175 00a4 A042     	 cmp r0,r4
 176 00a6 D6D2     	 bcs .L8
 177 00a8 EBE7     	 b .L14
 178              	.LBE205:
 179              	.LBE206:
 180              	.LBE208:
 181              	.LBE210:
 182              	.LBE211:
 183              	 .cfi_endproc
 184              	.LFE119:
 186 00aa 00BF     	 .section .text._ZN4host12heatShutdownEv,"ax",%progbits
 187              	 .align 2
 188              	 .global _ZN4host12heatShutdownEv
 189              	 .thumb
 190              	 .thumb_func
 192              	_ZN4host12heatShutdownEv:
 193              	.LFB120:
 261:src/MightyBoard/Motherboard/Host.cc **** 
 262:src/MightyBoard/Motherboard/Host.cc ****     // alert the host that the bot has had a heat failure
 263:src/MightyBoard/Motherboard/Host.cc **** void heatShutdown(){
 194              	 .loc 1 263 0
 195              	 .cfi_startproc
 196              	 
 197              	 
 198              	 
 264:src/MightyBoard/Motherboard/Host.cc **** 	currentState = HOST_STATE_HEAT_SHUTDOWN;
 199              	 .loc 1 264 0
 200 0000 40F20003 	 movw r3,#:lower16:.LANCHOR0
 201 0004 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 202 0008 4FF00602 	 mov r2,#6
 203 000c 1A70     	 strb r2,[r3,#0]
 265:src/MightyBoard/Motherboard/Host.cc **** 	cancelBuild = true;
 204              	 .loc 1 265 0
 205 000e 40F20003 	 movw r3,#:lower16:.LANCHOR1
 206 0012 C0F20003 	 movt r3,#:upper16:.LANCHOR1
 207 0016 4FF00102 	 mov r2,#1
 208 001a 1A70     	 strb r2,[r3,#0]
 266:src/MightyBoard/Motherboard/Host.cc **** }
 209              	 .loc 1 266 0
 210 001c 7047     	 bx lr
 211              	 .cfi_endproc
 212              	.LFE120:
 214 001e 00BF     	 .section .text._ZN4host18handleNextFilenameERK8InPacketR9OutPacket,"axG",%progbits,_ZN4host18handleNextFilenameERK8InPacketR9OutPacket,comdat
 215              	 .align 2
 216              	 .weak _ZN4host18handleNextFilenameERK8InPacketR9OutPacket
 217              	 .thumb
 218              	 .thumb_func
 220              	_ZN4host18handleNextFilenameERK8InPacketR9OutPacket:
 221              	.LFB130:
 267:src/MightyBoard/Motherboard/Host.cc **** 
 268:src/MightyBoard/Motherboard/Host.cc **** 
 269:src/MightyBoard/Motherboard/Host.cc **** // Received driver version info, and request for fw version info.
 270:src/MightyBoard/Motherboard/Host.cc **** // puts fw version into a reply packet, and send it back
 271:src/MightyBoard/Motherboard/Host.cc **** inline void handleVersion(const InPacket& from_host, OutPacket& to_host) {
 272:src/MightyBoard/Motherboard/Host.cc **** 
 273:src/MightyBoard/Motherboard/Host.cc ****     // Case to give an error on Replicator G versions older than 0025. See footnote 1
 274:src/MightyBoard/Motherboard/Host.cc ****     if(from_host.read16(1)  <=  25   ) {
 275:src/MightyBoard/Motherboard/Host.cc ****         to_host.append8(RC_OK);
 276:src/MightyBoard/Motherboard/Host.cc ****         to_host.append16(0x0000);
 277:src/MightyBoard/Motherboard/Host.cc ****     }
 278:src/MightyBoard/Motherboard/Host.cc ****     else  {
 279:src/MightyBoard/Motherboard/Host.cc ****         to_host.append8(RC_OK);
 280:src/MightyBoard/Motherboard/Host.cc ****         to_host.append16(firmware_version);
 281:src/MightyBoard/Motherboard/Host.cc ****     }
 282:src/MightyBoard/Motherboard/Host.cc **** 
 283:src/MightyBoard/Motherboard/Host.cc **** }
 284:src/MightyBoard/Motherboard/Host.cc **** 
 285:src/MightyBoard/Motherboard/Host.cc **** // Received driver version info, and request for fw version info.
 286:src/MightyBoard/Motherboard/Host.cc **** // puts fw version into a reply packet, and send it back
 287:src/MightyBoard/Motherboard/Host.cc **** inline void handleGetAdvancedVersion(const InPacket& from_host, OutPacket& to_host) {
 288:src/MightyBoard/Motherboard/Host.cc **** 
 289:src/MightyBoard/Motherboard/Host.cc **** 	// we're not doing anything with the host version at the moment
 290:src/MightyBoard/Motherboard/Host.cc **** 	uint16_t host_version = from_host.read16(1);
 291:src/MightyBoard/Motherboard/Host.cc **** 	
 292:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 293:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append16(firmware_version);
 294:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append16(internal_version);
 295:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append16(0);
 296:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append16(0);
 297:src/MightyBoard/Motherboard/Host.cc **** 
 298:src/MightyBoard/Motherboard/Host.cc **** }
 299:src/MightyBoard/Motherboard/Host.cc **** 
 300:src/MightyBoard/Motherboard/Host.cc ****     // return build name
 301:src/MightyBoard/Motherboard/Host.cc **** inline void handleGetBuildName(const InPacket& from_host, OutPacket& to_host) {
 302:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 303:src/MightyBoard/Motherboard/Host.cc **** 	for (uint8_t idx = 0; idx < MAX_FILE_LEN; idx++) {
 304:src/MightyBoard/Motherboard/Host.cc **** 	  to_host.append8(buildName[idx]);
 305:src/MightyBoard/Motherboard/Host.cc **** 	  if (buildName[idx] == '\0') { break; }
 306:src/MightyBoard/Motherboard/Host.cc **** 	}
 307:src/MightyBoard/Motherboard/Host.cc **** }
 308:src/MightyBoard/Motherboard/Host.cc **** 
 309:src/MightyBoard/Motherboard/Host.cc **** inline void handleGetBufferSize(const InPacket& from_host, OutPacket& to_host) {
 310:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 311:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append32(command::getRemainingCapacity());
 312:src/MightyBoard/Motherboard/Host.cc **** }
 313:src/MightyBoard/Motherboard/Host.cc **** 
 314:src/MightyBoard/Motherboard/Host.cc **** inline void handleGetPosition(const InPacket& from_host, OutPacket& to_host) {
 315:src/MightyBoard/Motherboard/Host.cc **** //	ATOMIC_BLOCK(ATOMIC_FORCEON) {
 316:src/MightyBoard/Motherboard/Host.cc **** 		const Point p = planner::getPosition();
 317:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append8(RC_OK);
 318:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[0]);
 319:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[1]);
 320:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[2]);
 321:src/MightyBoard/Motherboard/Host.cc **** 		// From spec:
 322:src/MightyBoard/Motherboard/Host.cc **** 		// endstop status bits: (7-0) : | N/A | N/A | z max | z min | y max | y min | x max | x min |
 323:src/MightyBoard/Motherboard/Host.cc **** 		Motherboard& board = Motherboard::getBoard();
 324:src/MightyBoard/Motherboard/Host.cc **** 		uint8_t endstop_status = steppers::getEndstopStatus();
 325:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append8(endstop_status);
 326:src/MightyBoard/Motherboard/Host.cc **** //	}
 327:src/MightyBoard/Motherboard/Host.cc **** }
 328:src/MightyBoard/Motherboard/Host.cc **** 
 329:src/MightyBoard/Motherboard/Host.cc **** inline void handleGetPositionExt(const InPacket& from_host, OutPacket& to_host) {
 330:src/MightyBoard/Motherboard/Host.cc **** //	ATOMIC_BLOCK(ATOMIC_FORCEON) {
 331:src/MightyBoard/Motherboard/Host.cc **** 		const Point p = planner::getPosition();
 332:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append8(RC_OK);
 333:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[0]);
 334:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[1]);
 335:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[2]);
 336:src/MightyBoard/Motherboard/Host.cc **** #if STEPPER_COUNT > 3
 337:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[3]);
 338:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[4]);
 339:src/MightyBoard/Motherboard/Host.cc **** #else
 340:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(0);
 341:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(0);
 342:src/MightyBoard/Motherboard/Host.cc **** #endif
 343:src/MightyBoard/Motherboard/Host.cc **** 		// From spec:
 344:src/MightyBoard/Motherboard/Host.cc **** 		// endstop status bits: (15-0) : | b max | b min | a max | a min | z max | z min | y max | y min 
 345:src/MightyBoard/Motherboard/Host.cc **** 		Motherboard& board = Motherboard::getBoard();
 346:src/MightyBoard/Motherboard/Host.cc **** 		uint8_t endstop_status = steppers::getEndstopStatus();
 347:src/MightyBoard/Motherboard/Host.cc **** 		
 348:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append16((uint16_t)endstop_status);
 349:src/MightyBoard/Motherboard/Host.cc **** //	}
 350:src/MightyBoard/Motherboard/Host.cc **** }
 351:src/MightyBoard/Motherboard/Host.cc **** 
 352:src/MightyBoard/Motherboard/Host.cc ****     // capture to SD
 353:src/MightyBoard/Motherboard/Host.cc **** inline void handleCaptureToFile(const InPacket& from_host, OutPacket& to_host) {
 354:src/MightyBoard/Motherboard/Host.cc **** 	char *p = (char*)from_host.getData() + 1;
 355:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 356:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(sdcard::startCapture(p));
 357:src/MightyBoard/Motherboard/Host.cc **** }
 358:src/MightyBoard/Motherboard/Host.cc ****     // stop capture to SD
 359:src/MightyBoard/Motherboard/Host.cc **** inline void handleEndCapture(const InPacket& from_host, OutPacket& to_host) {
 360:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 361:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append32(sdcard::finishCapture());
 362:src/MightyBoard/Motherboard/Host.cc **** 	sdcard::reset();
 363:src/MightyBoard/Motherboard/Host.cc **** }
 364:src/MightyBoard/Motherboard/Host.cc **** 
 365:src/MightyBoard/Motherboard/Host.cc ****     // playback from SD
 366:src/MightyBoard/Motherboard/Host.cc **** inline void handlePlayback(const InPacket& from_host, OutPacket& to_host) {
 367:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 368:src/MightyBoard/Motherboard/Host.cc **** 	for (int idx = 1; idx < from_host.getLength(); idx++) {
 369:src/MightyBoard/Motherboard/Host.cc **** 		buildName[idx-1] = from_host.read8(idx);
 370:src/MightyBoard/Motherboard/Host.cc **** 	}
 371:src/MightyBoard/Motherboard/Host.cc **** 	buildName[MAX_FILE_LEN-1] = '\0';
 372:src/MightyBoard/Motherboard/Host.cc **** 
 373:src/MightyBoard/Motherboard/Host.cc **** 	uint8_t response = startBuildFromSD();
 374:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(response);
 375:src/MightyBoard/Motherboard/Host.cc **** }
 376:src/MightyBoard/Motherboard/Host.cc **** 
 377:src/MightyBoard/Motherboard/Host.cc ****     // retrive SD file names
 378:src/MightyBoard/Motherboard/Host.cc **** inline void handleNextFilename(const InPacket& from_host, OutPacket& to_host) {
 222              	 .loc 1 378 0
 223              	 .cfi_startproc
 224              	 
 225              	 
 226              	.LVL15:
 227 0000 2DE9F843 	 push {r3,r4,r5,r6,r7,r8,r9,lr}
 228              	.LCFI1:
 229              	 .cfi_def_cfa_offset 32
 230              	 .cfi_offset 14,-4
 231              	 .cfi_offset 9,-8
 232              	 .cfi_offset 8,-12
 233              	 .cfi_offset 7,-16
 234              	 .cfi_offset 6,-20
 235              	 .cfi_offset 5,-24
 236              	 .cfi_offset 4,-28
 237              	 .cfi_offset 3,-32
 238 0004 00AF     	 add r7,sp,#0
 239              	.LCFI2:
 240              	 .cfi_def_cfa_register 7
 241 0006 0446     	 mov r4,r0
 242 0008 0D46     	 mov r5,r1
 243              	.LBB212:
 379:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 380:src/MightyBoard/Motherboard/Host.cc **** 	uint8_t resetFlag = from_host.read8(1);
 381:src/MightyBoard/Motherboard/Host.cc **** 	if (resetFlag != 0) {
 382:src/MightyBoard/Motherboard/Host.cc **** 		sdcard::SdErrorCode e = sdcard::directoryReset();
 383:src/MightyBoard/Motherboard/Host.cc **** 		if (e != sdcard::SD_SUCCESS) {
 384:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(e);
 385:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(0);
 386:src/MightyBoard/Motherboard/Host.cc **** 			return;
 387:src/MightyBoard/Motherboard/Host.cc **** 		}
 388:src/MightyBoard/Motherboard/Host.cc **** 	}
 389:src/MightyBoard/Motherboard/Host.cc **** 	int MAX_FILE_LEN = MAX_PACKET_PAYLOAD-1;
 390:src/MightyBoard/Motherboard/Host.cc **** 	char fnbuf[MAX_FILE_LEN];
 391:src/MightyBoard/Motherboard/Host.cc **** 	sdcard::SdErrorCode e;
 392:src/MightyBoard/Motherboard/Host.cc **** 	// Ignore dot-files
 393:src/MightyBoard/Motherboard/Host.cc **** 	do {
 394:src/MightyBoard/Motherboard/Host.cc **** 		e = sdcard::directoryNextEntry(fnbuf,MAX_FILE_LEN);
 395:src/MightyBoard/Motherboard/Host.cc **** 		if (fnbuf[0] == '\0') break;
 396:src/MightyBoard/Motherboard/Host.cc **** 	} while (e == sdcard::SD_SUCCESS && fnbuf[0] == '.');
 397:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(e);
 398:src/MightyBoard/Motherboard/Host.cc **** 	uint8_t idx;
 399:src/MightyBoard/Motherboard/Host.cc **** 	for (idx = 0; (idx < MAX_FILE_LEN) && (fnbuf[idx] != 0); idx++) {
 244              	 .loc 1 399 0
 245 000a E846     	 mov r8,sp
 379:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 246              	 .loc 1 379 0
 247 000c 0846     	 mov r0,r1
 248              	.LVL16:
 249 000e 4FF08101 	 mov r1,#129
 250              	.LVL17:
 251 0012 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 252              	.LVL18:
 380:src/MightyBoard/Motherboard/Host.cc **** 	uint8_t resetFlag = from_host.read8(1);
 253              	 .loc 1 380 0
 254 0016 2046     	 mov r0,r4
 255 0018 4FF00101 	 mov r1,#1
 256 001c FFF7FEFF 	 bl _ZNK6Packet5read8Eh
 257              	.LVL19:
 258              	.LBB213:
 381:src/MightyBoard/Motherboard/Host.cc **** 	if (resetFlag != 0) {
 259              	 .loc 1 381 0
 260 0020 60B1     	 cbz r0,.L17
 261              	.LBB214:
 382:src/MightyBoard/Motherboard/Host.cc **** 		sdcard::SdErrorCode e = sdcard::directoryReset();
 262              	 .loc 1 382 0
 263 0022 FFF7FEFF 	 bl _ZN6sdcard14directoryResetEv
 264              	.LVL20:
 383:src/MightyBoard/Motherboard/Host.cc **** 		if (e != sdcard::SD_SUCCESS) {
 265              	 .loc 1 383 0
 266 0026 0146     	 mov r1,r0
 267 0028 40B1     	 cbz r0,.L17
 384:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(e);
 268              	 .loc 1 384 0
 269 002a 2846     	 mov r0,r5
 270              	.LVL21:
 271 002c FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 385:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(0);
 272              	 .loc 1 385 0
 273 0030 2846     	 mov r0,r5
 274 0032 4FF00001 	 mov r1,#0
 275 0036 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 276 003a 27E0     	 b .L16
 277              	.L17:
 278              	.LVL22:
 279              	.LBE214:
 280              	.LBE213:
 390:src/MightyBoard/Motherboard/Host.cc **** 	char fnbuf[MAX_FILE_LEN];
 281              	 .loc 1 390 0
 282 003c 8AB0     	 sub sp,sp,#40
 283 003e 6C46     	 mov r4,sp
 284              	.LVL23:
 394:src/MightyBoard/Motherboard/Host.cc **** 		e = sdcard::directoryNextEntry(fnbuf,MAX_FILE_LEN);
 285              	 .loc 1 394 0
 286 0040 4FF01F06 	 mov r6,#31
 287 0044 4FF00009 	 mov r9,#0
 288              	.L20:
 289 0048 2046     	 mov r0,r4
 290 004a 3146     	 mov r1,r6
 291 004c 4A46     	 mov r2,r9
 292 004e FFF7FEFF 	 bl _ZN6sdcard18directoryNextEntryEPchPh
 293 0052 0146     	 mov r1,r0
 294              	.LVL24:
 395:src/MightyBoard/Motherboard/Host.cc **** 		if (fnbuf[0] == '\0') break;
 295              	 .loc 1 395 0
 296 0054 2378     	 ldrb r3,[r4,#0]
 297 0056 13B1     	 cbz r3,.L19
 393:src/MightyBoard/Motherboard/Host.cc **** 	do {
 298              	 .loc 1 393 0
 299 0058 08B9     	 cbnz r0,.L19
 393:src/MightyBoard/Motherboard/Host.cc **** 	do {
 300              	 .loc 1 393 0 is_stmt 0 discriminator 1
 301 005a 2E2B     	 cmp r3,#46
 302 005c F4D0     	 beq .L20
 303              	.L19:
 397:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(e);
 304              	 .loc 1 397 0 is_stmt 1
 305 005e 2846     	 mov r0,r5
 306              	.LVL25:
 307 0060 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 308              	.LVL26:
 309              	 .loc 1 399 0
 310 0064 4FF00003 	 mov r3,#0
 311 0068 1E46     	 mov r6,r3
 312              	.LVL27:
 313              	.L22:
 314              	 .loc 1 399 0 is_stmt 0 discriminator 2
 315 006a E15C     	 ldrb r1,[r4,r3]
 316 006c 41B1     	 cbz r1,.L21
 400:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append8(fnbuf[idx]);
 317              	 .loc 1 400 0 is_stmt 1 discriminator 5
 318 006e 2846     	 mov r0,r5
 319 0070 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 399:src/MightyBoard/Motherboard/Host.cc **** 	for (idx = 0; (idx < MAX_FILE_LEN) && (fnbuf[idx] != 0); idx++) {
 320              	 .loc 1 399 0 discriminator 5
 321 0074 06F10106 	 add r6,r6,#1
 322 0078 F6B2     	 uxtb r6,r6
 323              	.LVL28:
 324 007a 3346     	 mov r3,r6
 325 007c 1E2E     	 cmp r6,#30
 326 007e F4DD     	 ble .L22
 327              	.LVL29:
 328              	.L21:
 401:src/MightyBoard/Motherboard/Host.cc **** 	}
 402:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(0);
 329              	 .loc 1 402 0
 330 0080 2846     	 mov r0,r5
 331 0082 4FF00001 	 mov r1,#0
 332 0086 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 333 008a C546     	 mov sp,r8
 334              	.LVL30:
 335              	.L16:
 336              	.LBE212:
 403:src/MightyBoard/Motherboard/Host.cc **** }
 337              	 .loc 1 403 0
 338 008c BD46     	 mov sp,r7
 339 008e BDE8F883 	 pop {r3,r4,r5,r6,r7,r8,r9,pc}
 340              	 .cfi_endproc
 341              	.LFE130:
 343 0092 00BF     	 .section .text._ZN4host16handleReadEepromERK8InPacketR9OutPacket,"axG",%progbits,_ZN4host16handleReadEepromERK8InPacketR9OutPacket,comdat
 344              	 .align 2
 345              	 .weak _ZN4host16handleReadEepromERK8InPacketR9OutPacket
 346              	 .thumb
 347              	 .thumb_func
 349              	_ZN4host16handleReadEepromERK8InPacketR9OutPacket:
 350              	.LFB133:
 404:src/MightyBoard/Motherboard/Host.cc **** 
 405:src/MightyBoard/Motherboard/Host.cc ****     // pause command response
 406:src/MightyBoard/Motherboard/Host.cc **** inline void handlePause(const InPacket& from_host, OutPacket& to_host) {
 407:src/MightyBoard/Motherboard/Host.cc **** 	/// this command also calls the host::pauseBuild() command
 408:src/MightyBoard/Motherboard/Host.cc **** 	pauseBuild(!command::isPaused());
 409:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 410:src/MightyBoard/Motherboard/Host.cc **** }
 411:src/MightyBoard/Motherboard/Host.cc **** 
 412:src/MightyBoard/Motherboard/Host.cc ****     // check if steppers are still executing a command
 413:src/MightyBoard/Motherboard/Host.cc **** inline void handleIsFinished(const InPacket& from_host, OutPacket& to_host) {
 414:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 415:src/MightyBoard/Motherboard/Host.cc **** //	ATOMIC_BLOCK(ATOMIC_FORCEON) {
 416:src/MightyBoard/Motherboard/Host.cc **** 		bool done = !steppers::isRunning() && command::isEmpty();
 417:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append8(done?1:0);
 418:src/MightyBoard/Motherboard/Host.cc **** //	}
 419:src/MightyBoard/Motherboard/Host.cc **** }
 420:src/MightyBoard/Motherboard/Host.cc ****     // read value from eeprom
 421:src/MightyBoard/Motherboard/Host.cc **** inline void handleReadEeprom(const InPacket& from_host, OutPacket& to_host) {
 351              	 .loc 1 421 0
 352              	 .cfi_startproc
 353              	 
 354              	 
 355              	.LVL31:
 356 0000 2DE9F843 	 push {r3,r4,r5,r6,r7,r8,r9,lr}
 357              	.LCFI3:
 358              	 .cfi_def_cfa_offset 32
 359              	 .cfi_offset 14,-4
 360              	 .cfi_offset 9,-8
 361              	 .cfi_offset 8,-12
 362              	 .cfi_offset 7,-16
 363              	 .cfi_offset 6,-20
 364              	 .cfi_offset 5,-24
 365              	 .cfi_offset 4,-28
 366              	 .cfi_offset 3,-32
 367 0004 00AF     	 add r7,sp,#0
 368              	.LCFI4:
 369              	 .cfi_def_cfa_register 7
 370 0006 0546     	 mov r5,r0
 371 0008 0E46     	 mov r6,r1
 372              	.LBB215:
 422:src/MightyBoard/Motherboard/Host.cc **** //	xprintf("handleReadEeprom" " (%s:%d)\n",_F_,_L_);
 423:src/MightyBoard/Motherboard/Host.cc ****     uint16_t offset = from_host.read16(1);
 373              	 .loc 1 423 0
 374 000a 4FF00101 	 mov r1,#1
 375              	.LVL32:
 376 000e FFF7FEFF 	 bl _ZNK6Packet6read16Eh
 377              	.LVL33:
 378 0012 0446     	 mov r4,r0
 379              	.LVL34:
 424:src/MightyBoard/Motherboard/Host.cc ****     uint8_t length = from_host.read8(3);
 380              	 .loc 1 424 0
 381 0014 2846     	 mov r0,r5
 382              	.LVL35:
 383 0016 4FF00301 	 mov r1,#3
 384 001a FFF7FEFF 	 bl _ZNK6Packet5read8Eh
 385 001e 0546     	 mov r5,r0
 386              	.LVL36:
 425:src/MightyBoard/Motherboard/Host.cc ****     uint8_t data[length];
 387              	 .loc 1 425 0
 388 0020 8046     	 mov r8,r0
 389              	.LVL37:
 390 0022 00F10E03 	 add r3,r0,#14
 391 0026 23F00703 	 bic r3,r3,#7
 392 002a ADEB030D 	 sub sp,sp,r3
 426:src/MightyBoard/Motherboard/Host.cc **** //    eeprom_read_block(data, (const void*) offset, length);
 427:src/MightyBoard/Motherboard/Host.cc ****     to_host.append8(RC_OK);
 393              	 .loc 1 427 0
 394 002e 3046     	 mov r0,r6
 395              	.LVL38:
 396 0030 4FF08101 	 mov r1,#129
 397 0034 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 398              	.LVL39:
 399              	.LBB216:
 428:src/MightyBoard/Motherboard/Host.cc ****     for (int i = 0; i < length; i++) {
 400              	 .loc 1 428 0
 401 0038 002D     	 cmp r5,#0
 402 003a 11DD     	 ble .L25
 403 003c 4FF00005 	 mov r5,#0
 404              	.LVL40:
 429:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append8(eeprom::getEeprom8(offset + i,0));
 405              	 .loc 1 429 0
 406 0040 A946     	 mov r9,r5
 407              	.LVL41:
 408              	.L27:
 409              	 .loc 1 429 0 is_stmt 0 discriminator 2
 410 0042 2046     	 mov r0,r4
 411 0044 4946     	 mov r1,r9
 412 0046 FFF7FEFF 	 bl _ZN6eeprom10getEeprom8Eth
 413 004a 0146     	 mov r1,r0
 414 004c 3046     	 mov r0,r6
 415 004e FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 428:src/MightyBoard/Motherboard/Host.cc ****     for (int i = 0; i < length; i++) {
 416              	 .loc 1 428 0 is_stmt 1 discriminator 2
 417 0052 05F10105 	 add r5,r5,#1
 418              	.LVL42:
 419 0056 04F10104 	 add r4,r4,#1
 420 005a A4B2     	 uxth r4,r4
 421 005c A845     	 cmp r8,r5
 422 005e F0DC     	 bgt .L27
 423              	.LVL43:
 424              	.L25:
 425              	.LBE216:
 426              	.LBE215:
 430:src/MightyBoard/Motherboard/Host.cc **** //		to_host.append8(data[i]);
 431:src/MightyBoard/Motherboard/Host.cc ****     }
 432:src/MightyBoard/Motherboard/Host.cc **** }
 427              	 .loc 1 432 0
 428 0060 BD46     	 mov sp,r7
 429 0062 BDE8F883 	 pop {r3,r4,r5,r6,r7,r8,r9,pc}
 430              	 .cfi_endproc
 431              	.LFE133:
 433 0066 00BF     	 .section .text._ZN4host14getMachineNameEv,"ax",%progbits
 434              	 .align 2
 435              	 .global _ZN4host14getMachineNameEv
 436              	 .thumb
 437              	 .thumb_func
 439              	_ZN4host14getMachineNameEv:
 440              	.LFB141:
 433:src/MightyBoard/Motherboard/Host.cc **** 
 434:src/MightyBoard/Motherboard/Host.cc **** /**
 435:src/MightyBoard/Motherboard/Host.cc ****  * writes a chunk of data from a input packet to eeprom
 436:src/MightyBoard/Motherboard/Host.cc ****  */
 437:src/MightyBoard/Motherboard/Host.cc **** inline void handleWriteEeprom(const InPacket& from_host, OutPacket& to_host) {
 438:src/MightyBoard/Motherboard/Host.cc **** 	xprintf("handleWriteEeprom" " (%s:%d)\n",_F_,_L_);
 439:src/MightyBoard/Motherboard/Host.cc ****     uint16_t offset = from_host.read16(1);
 440:src/MightyBoard/Motherboard/Host.cc ****     uint8_t length = from_host.read8(3);
 441:src/MightyBoard/Motherboard/Host.cc **** //	xprintf("%x" " (%s:%d)\n",offset,_F_,_L_);
 442:src/MightyBoard/Motherboard/Host.cc **** //	xprintf("%x" " (%s:%d)\n",length,_F_,_L_);
 443:src/MightyBoard/Motherboard/Host.cc **** //    uint8_t data[length];
 444:src/MightyBoard/Motherboard/Host.cc **** //    eeprom_read_block(data, (const void*) offset, length);
 445:src/MightyBoard/Motherboard/Host.cc ****     for (int i = 0; i < length; i++) {
 446:src/MightyBoard/Motherboard/Host.cc ****     	eeprom::setEeprom8(offset + i, from_host.read8(i + 4));
 447:src/MightyBoard/Motherboard/Host.cc **** 		xprintf("%x %x %c" "\n",EEPROM_START_ADDRESS + offset + i,eeprom_address(EEPROM_START_ADDRESS, of
 448:src/MightyBoard/Motherboard/Host.cc **** //        data[i] = from_host.read8(i + 4);
 449:src/MightyBoard/Motherboard/Host.cc ****     }
 450:src/MightyBoard/Motherboard/Host.cc **** //    ATOMIC_BLOCK(ATOMIC_RESTORESTATE){
 451:src/MightyBoard/Motherboard/Host.cc **** //    	eeprom::save_to_flash();
 452:src/MightyBoard/Motherboard/Host.cc **** //		eeprom_write_block(data, (void*) offset, length);
 453:src/MightyBoard/Motherboard/Host.cc **** //	}
 454:src/MightyBoard/Motherboard/Host.cc ****     to_host.append8(RC_OK);
 455:src/MightyBoard/Motherboard/Host.cc ****     to_host.append8(length);
 456:src/MightyBoard/Motherboard/Host.cc **** }
 457:src/MightyBoard/Motherboard/Host.cc **** 
 458:src/MightyBoard/Motherboard/Host.cc **** enum { // bit assignments
 459:src/MightyBoard/Motherboard/Host.cc **** 	ES_STEPPERS = 0, // stop steppers
 460:src/MightyBoard/Motherboard/Host.cc **** 	ES_COMMANDS = 1  // clean queue
 461:src/MightyBoard/Motherboard/Host.cc **** };
 462:src/MightyBoard/Motherboard/Host.cc **** 
 463:src/MightyBoard/Motherboard/Host.cc ****     // stop steppers and command execution
 464:src/MightyBoard/Motherboard/Host.cc **** inline void handleExtendedStop(const InPacket& from_host, OutPacket& to_host) {
 465:src/MightyBoard/Motherboard/Host.cc **** 	uint8_t flags = from_host.read8(1);
 466:src/MightyBoard/Motherboard/Host.cc **** 	if (flags & _BV(ES_STEPPERS)) {
 467:src/MightyBoard/Motherboard/Host.cc **** 		planner::abort();
 468:src/MightyBoard/Motherboard/Host.cc **** 	}
 469:src/MightyBoard/Motherboard/Host.cc **** 	if (flags & _BV(ES_COMMANDS)) {
 470:src/MightyBoard/Motherboard/Host.cc **** 		command::reset();
 471:src/MightyBoard/Motherboard/Host.cc **** 	}
 472:src/MightyBoard/Motherboard/Host.cc **** 
 473:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 474:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(0);
 475:src/MightyBoard/Motherboard/Host.cc **** }
 476:src/MightyBoard/Motherboard/Host.cc **** 
 477:src/MightyBoard/Motherboard/Host.cc ****     //set build name and build state
 478:src/MightyBoard/Motherboard/Host.cc **** void handleBuildStartNotification(CircularBuffer& buf) {
 479:src/MightyBoard/Motherboard/Host.cc **** 	
 480:src/MightyBoard/Motherboard/Host.cc **** 	uint8_t idx = 0;
 481:src/MightyBoard/Motherboard/Host.cc **** 	char newName[MAX_FILE_LEN];
 482:src/MightyBoard/Motherboard/Host.cc **** 	switch (currentState){
 483:src/MightyBoard/Motherboard/Host.cc **** 		case HOST_STATE_BUILDING_FROM_SD:
 484:src/MightyBoard/Motherboard/Host.cc **** 			do {
 485:src/MightyBoard/Motherboard/Host.cc **** 				newName[idx++] = buf.pop();		
 486:src/MightyBoard/Motherboard/Host.cc **** 			} while (newName[idx-1] != '\0');
 487:src/MightyBoard/Motherboard/Host.cc **** 			if(strcmp(newName, "RepG Build"))
 488:src/MightyBoard/Motherboard/Host.cc **** 				strcpy(buildName, newName);
 489:src/MightyBoard/Motherboard/Host.cc **** 			break;
 490:src/MightyBoard/Motherboard/Host.cc **** 		case HOST_STATE_READY:
 491:src/MightyBoard/Motherboard/Host.cc **** 			currentState = HOST_STATE_BUILDING;
 492:src/MightyBoard/Motherboard/Host.cc **** 		case HOST_STATE_BUILDING_ONBOARD:
 493:src/MightyBoard/Motherboard/Host.cc **** 		case HOST_STATE_BUILDING:
 494:src/MightyBoard/Motherboard/Host.cc **** 			do {
 495:src/MightyBoard/Motherboard/Host.cc **** 				buildName[idx++] = buf.pop();		
 496:src/MightyBoard/Motherboard/Host.cc **** 			} while (buildName[idx-1] != '\0');
 497:src/MightyBoard/Motherboard/Host.cc **** 			break;
 498:src/MightyBoard/Motherboard/Host.cc **** 	}
 499:src/MightyBoard/Motherboard/Host.cc **** 	startPrintTime();
 500:src/MightyBoard/Motherboard/Host.cc **** 	command::clearLineNumber();
 501:src/MightyBoard/Motherboard/Host.cc **** 	buildState = BUILD_RUNNING;
 502:src/MightyBoard/Motherboard/Host.cc **** }
 503:src/MightyBoard/Motherboard/Host.cc **** 
 504:src/MightyBoard/Motherboard/Host.cc ****     // set build state to ready
 505:src/MightyBoard/Motherboard/Host.cc **** void handleBuildStopNotification(uint8_t stopFlags) {
 506:src/MightyBoard/Motherboard/Host.cc **** 	uint8_t flags = stopFlags;
 507:src/MightyBoard/Motherboard/Host.cc **** 
 508:src/MightyBoard/Motherboard/Host.cc **** 	stopPrintTime();
 509:src/MightyBoard/Motherboard/Host.cc **** 	last_print_line = command::getLineNumber();
 510:src/MightyBoard/Motherboard/Host.cc **** 	buildState = BUILD_FINISHED_NORMALLY;
 511:src/MightyBoard/Motherboard/Host.cc **** 	currentState = HOST_STATE_READY;
 512:src/MightyBoard/Motherboard/Host.cc **** }
 513:src/MightyBoard/Motherboard/Host.cc **** 
 514:src/MightyBoard/Motherboard/Host.cc **** /// get current print stats if printing, or last print stats if not printing
 515:src/MightyBoard/Motherboard/Host.cc **** inline void handleGetBuildStats(OutPacket& to_host) {
 516:src/MightyBoard/Motherboard/Host.cc ****         to_host.append8(RC_OK);
 517:src/MightyBoard/Motherboard/Host.cc ****  
 518:src/MightyBoard/Motherboard/Host.cc **** 		uint8_t hours;
 519:src/MightyBoard/Motherboard/Host.cc **** 		uint8_t minutes;
 520:src/MightyBoard/Motherboard/Host.cc **** 		
 521:src/MightyBoard/Motherboard/Host.cc **** 		getPrintTime(hours, minutes);
 522:src/MightyBoard/Motherboard/Host.cc **** 		
 523:src/MightyBoard/Motherboard/Host.cc ****         to_host.append8(buildState);
 524:src/MightyBoard/Motherboard/Host.cc ****         to_host.append8(hours);
 525:src/MightyBoard/Motherboard/Host.cc ****         to_host.append8(minutes);
 526:src/MightyBoard/Motherboard/Host.cc ****         if((buildState == BUILD_RUNNING) || (buildState == BUILD_PAUSED)){
 527:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append32(command::getLineNumber());
 528:src/MightyBoard/Motherboard/Host.cc **** 		} else {
 529:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append32(last_print_line);
 530:src/MightyBoard/Motherboard/Host.cc **** 		}
 531:src/MightyBoard/Motherboard/Host.cc ****         to_host.append32(0);// open spot for filament detect info
 532:src/MightyBoard/Motherboard/Host.cc **** }
 533:src/MightyBoard/Motherboard/Host.cc **** /// get current print stats if printing, or last print stats if not printing
 534:src/MightyBoard/Motherboard/Host.cc **** inline void handleGetBoardStatus(OutPacket& to_host) {
 535:src/MightyBoard/Motherboard/Host.cc **** 	Motherboard& board = Motherboard::getBoard();
 536:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 537:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(board.GetErrorStatus());
 538:src/MightyBoard/Motherboard/Host.cc **** }
 539:src/MightyBoard/Motherboard/Host.cc **** 
 540:src/MightyBoard/Motherboard/Host.cc **** // query packets (non action, not queued)
 541:src/MightyBoard/Motherboard/Host.cc **** bool processQueryPacket(const InPacket& from_host, OutPacket& to_host) {
 542:src/MightyBoard/Motherboard/Host.cc **** 	if (from_host.getLength() >= 1) {
 543:src/MightyBoard/Motherboard/Host.cc **** 		uint8_t command = from_host.read8(0);
 544:src/MightyBoard/Motherboard/Host.cc **** 		if ((command & 0x80) == 0) {
 545:src/MightyBoard/Motherboard/Host.cc **** 			// Is query command.
 546:src/MightyBoard/Motherboard/Host.cc **** 			switch (command) {
 547:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_VERSION:
 548:src/MightyBoard/Motherboard/Host.cc **** 				handleVersion(from_host,to_host);
 549:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 550:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_GET_BUILD_NAME:
 551:src/MightyBoard/Motherboard/Host.cc **** 				handleGetBuildName(from_host,to_host);
 552:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 553:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_INIT:
 554:src/MightyBoard/Motherboard/Host.cc **** 				// There's really nothing we want to do here; we don't want to
 555:src/MightyBoard/Motherboard/Host.cc **** 				// interrupt a running build, for example.
 556:src/MightyBoard/Motherboard/Host.cc **** 				to_host.append8(RC_OK);
 557:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 558:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_CLEAR_BUFFER: // equivalent at current time
 559:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_ABORT: // equivalent at current time
 560:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_RESET:
 561:src/MightyBoard/Motherboard/Host.cc **** 				if (currentState == HOST_STATE_BUILDING
 562:src/MightyBoard/Motherboard/Host.cc **** 						|| currentState == HOST_STATE_BUILDING_FROM_SD
 563:src/MightyBoard/Motherboard/Host.cc **** 						|| currentState == HOST_STATE_BUILDING_ONBOARD) {
 564:src/MightyBoard/Motherboard/Host.cc **** 					Motherboard::getBoard().indicateError(ERR_RESET_DURING_BUILD);
 565:src/MightyBoard/Motherboard/Host.cc **** 				}
 566:src/MightyBoard/Motherboard/Host.cc **** 
 567:src/MightyBoard/Motherboard/Host.cc **** 				do_host_reset = true; // indicate reset after response has been sent
 568:src/MightyBoard/Motherboard/Host.cc **** 				to_host.append8(RC_OK);
 569:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 570:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_GET_BUFFER_SIZE:
 571:src/MightyBoard/Motherboard/Host.cc **** 				handleGetBufferSize(from_host,to_host);
 572:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 573:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_GET_POSITION:
 574:src/MightyBoard/Motherboard/Host.cc **** 				handleGetPosition(from_host,to_host);
 575:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 576:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_GET_POSITION_EXT:
 577:src/MightyBoard/Motherboard/Host.cc **** 				handleGetPositionExt(from_host,to_host);
 578:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 579:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_CAPTURE_TO_FILE:
 580:src/MightyBoard/Motherboard/Host.cc **** 				handleCaptureToFile(from_host,to_host);
 581:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 582:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_END_CAPTURE:
 583:src/MightyBoard/Motherboard/Host.cc **** 				handleEndCapture(from_host,to_host);
 584:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 585:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_PLAYBACK_CAPTURE:
 586:src/MightyBoard/Motherboard/Host.cc **** 				handlePlayback(from_host,to_host);
 587:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 588:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_NEXT_FILENAME:
 589:src/MightyBoard/Motherboard/Host.cc **** 				handleNextFilename(from_host,to_host);
 590:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 591:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_PAUSE:
 592:src/MightyBoard/Motherboard/Host.cc **** 				handlePause(from_host,to_host);
 593:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 594:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_TOOL_QUERY:
 595:src/MightyBoard/Motherboard/Host.cc **** 				if(processExtruderQueryPacket(from_host,to_host)){
 596:src/MightyBoard/Motherboard/Host.cc **** 					return true;}
 597:src/MightyBoard/Motherboard/Host.cc **** 				break;
 598:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_IS_FINISHED:
 599:src/MightyBoard/Motherboard/Host.cc **** 				handleIsFinished(from_host,to_host);
 600:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 601:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_READ_EEPROM:
 602:src/MightyBoard/Motherboard/Host.cc **** 				handleReadEeprom(from_host,to_host);
 603:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 604:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_WRITE_EEPROM:
 605:src/MightyBoard/Motherboard/Host.cc **** 				handleWriteEeprom(from_host,to_host);
 606:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 607:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_EXTENDED_STOP:
 608:src/MightyBoard/Motherboard/Host.cc **** 				handleExtendedStop(from_host,to_host);
 609:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 610:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_BOARD_STATUS:
 611:src/MightyBoard/Motherboard/Host.cc **** 				handleGetBoardStatus(to_host);
 612:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 613:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_GET_BUILD_STATS:
 614:src/MightyBoard/Motherboard/Host.cc **** 				handleGetBuildStats(to_host);
 615:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 616:src/MightyBoard/Motherboard/Host.cc **** 			case HOST_CMD_ADVANCED_VERSION:
 617:src/MightyBoard/Motherboard/Host.cc **** 				handleGetAdvancedVersion(from_host, to_host);
 618:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 619:src/MightyBoard/Motherboard/Host.cc **** 			}
 620:src/MightyBoard/Motherboard/Host.cc **** 		}
 621:src/MightyBoard/Motherboard/Host.cc **** 	}
 622:src/MightyBoard/Motherboard/Host.cc **** 	return false;
 623:src/MightyBoard/Motherboard/Host.cc **** }
 624:src/MightyBoard/Motherboard/Host.cc **** 
 625:src/MightyBoard/Motherboard/Host.cc **** char* getMachineName() {
 441              	 .loc 1 625 0
 442              	 .cfi_startproc
 443              	 
 444              	 
 445 0000 70B5     	 push {r4,r5,r6,lr}
 446              	.LCFI5:
 447              	 .cfi_def_cfa_offset 16
 448              	 .cfi_offset 14,-4
 449              	 .cfi_offset 6,-8
 450              	 .cfi_offset 5,-12
 451              	 .cfi_offset 4,-16
 452              	.LBB217:
 453              	.LBB218:
 626:src/MightyBoard/Motherboard/Host.cc **** 	// If the machine name hasn't been loaded, load it
 627:src/MightyBoard/Motherboard/Host.cc **** 	if (machineName[0] == 0) {
 454              	 .loc 1 627 0
 455 0002 40F20003 	 movw r3,#:lower16:.LANCHOR2
 456 0006 C0F20003 	 movt r3,#:upper16:.LANCHOR2
 457 000a 1B78     	 ldrb r3,[r3,#0]
 458 000c 1BBB     	 cbnz r3,.L30
 459 000e 144D     	 ldr r5,.L35
 460 0010 4FF02204 	 mov r4,#34
 461              	.LBB219:
 628:src/MightyBoard/Motherboard/Host.cc **** 		for(uint8_t i = 0; i < eeprom_info::MAX_MACHINE_NAME_LEN; i++) {
 629:src/MightyBoard/Motherboard/Host.cc **** 			machineName[i] = eeprom::getEeprom8(eeprom_offsets::MACHINE_NAME+i, 0);
 462              	 .loc 1 629 0
 463 0014 4FF00006 	 mov r6,#0
 464              	.L31:
 465              	 .loc 1 629 0 is_stmt 0 discriminator 2
 466 0018 2046     	 mov r0,r4
 467 001a 3146     	 mov r1,r6
 468 001c FFF7FEFF 	 bl _ZN6eeprom10getEeprom8Eth
 469 0020 05F8010F 	 strb r0,[r5,#1]!
 470 0024 04F10104 	 add r4,r4,#1
 471 0028 A4B2     	 uxth r4,r4
 628:src/MightyBoard/Motherboard/Host.cc **** 		for(uint8_t i = 0; i < eeprom_info::MAX_MACHINE_NAME_LEN; i++) {
 472              	 .loc 1 628 0 is_stmt 1 discriminator 2
 473 002a 322C     	 cmp r4,#50
 474 002c F4D1     	 bne .L31
 475              	.LBE219:
 476              	.LBE218:
 477              	.LBB220:
 630:src/MightyBoard/Motherboard/Host.cc **** 		}
 631:src/MightyBoard/Motherboard/Host.cc **** 	}
 632:src/MightyBoard/Motherboard/Host.cc **** 
 633:src/MightyBoard/Motherboard/Host.cc **** 	// If EEPROM is zero, load in a default. The 0 is there on purpose
 634:src/MightyBoard/Motherboard/Host.cc **** 	// since this fallback should only happen on EEPROM total failure
 635:src/MightyBoard/Motherboard/Host.cc **** 	static PROGMEM char defaultMachineName[] =  "The Replicat0r";
 636:src/MightyBoard/Motherboard/Host.cc **** 
 637:src/MightyBoard/Motherboard/Host.cc **** 	if (machineName[0] == 0) {
 478              	 .loc 1 637 0
 479 002e 40F20003 	 movw r3,#:lower16:.LANCHOR2
 480 0032 C0F20003 	 movt r3,#:upper16:.LANCHOR2
 481 0036 1B78     	 ldrb r3,[r3,#0]
 482 0038 6BB9     	 cbnz r3,.L30
 483              	.LBB221:
 638:src/MightyBoard/Motherboard/Host.cc **** 		for(uint8_t i = 0; i < 15; i++) {
 639:src/MightyBoard/Motherboard/Host.cc **** 			machineName[i] = defaultMachineName[i];
 484              	 .loc 1 639 0
 485 003a 40F20000 	 movw r0,#:lower16:.LANCHOR2
 486 003e C0F20000 	 movt r0,#:upper16:.LANCHOR2
 487 0042 40F20001 	 movw r1,#:lower16:.LANCHOR3
 488 0046 C0F20001 	 movt r1,#:upper16:.LANCHOR3
 489              	.L32:
 490              	 .loc 1 639 0 is_stmt 0 discriminator 2
 491 004a 5A5C     	 ldrb r2,[r3,r1]
 492 004c 1A54     	 strb r2,[r3,r0]
 493 004e 03F10103 	 add r3,r3,#1
 638:src/MightyBoard/Motherboard/Host.cc **** 		for(uint8_t i = 0; i < 15; i++) {
 494              	 .loc 1 638 0 is_stmt 1 discriminator 2
 495 0052 0F2B     	 cmp r3,#15
 496 0054 F9D1     	 bne .L32
 497              	.LVL44:
 498              	.L30:
 499              	.LBE221:
 500              	.LBE220:
 501              	.LBE217:
 640:src/MightyBoard/Motherboard/Host.cc **** //			machineName[i] = pgm_read_byte_near(defaultMachineName+i);
 641:src/MightyBoard/Motherboard/Host.cc **** 		}
 642:src/MightyBoard/Motherboard/Host.cc **** 	}
 643:src/MightyBoard/Motherboard/Host.cc **** 
 644:src/MightyBoard/Motherboard/Host.cc **** 	return machineName;
 645:src/MightyBoard/Motherboard/Host.cc **** }
 502              	 .loc 1 645 0
 503 0056 40F20000 	 movw r0,#:lower16:.LANCHOR2
 504 005a C0F20000 	 movt r0,#:upper16:.LANCHOR2
 505 005e 70BD     	 pop {r4,r5,r6,pc}
 506              	.L36:
 507              	 .align 2
 508              	.L35:
 509 0060 FFFFFFFF 	 .word .LANCHOR2-1
 510              	 .cfi_endproc
 511              	.LFE141:
 513              	 .section .text._ZN4host12getBuildNameEv,"ax",%progbits
 514              	 .align 2
 515              	 .global _ZN4host12getBuildNameEv
 516              	 .thumb
 517              	 .thumb_func
 519              	_ZN4host12getBuildNameEv:
 520              	.LFB142:
 646:src/MightyBoard/Motherboard/Host.cc **** 
 647:src/MightyBoard/Motherboard/Host.cc **** char* getBuildName() {
 521              	 .loc 1 647 0
 522              	 .cfi_startproc
 523              	 
 524              	 
 525              	 
 648:src/MightyBoard/Motherboard/Host.cc **** 	return buildName;
 649:src/MightyBoard/Motherboard/Host.cc **** }
 526              	 .loc 1 649 0
 527 0000 40F20000 	 movw r0,#:lower16:.LANCHOR4
 528 0004 C0F20000 	 movt r0,#:upper16:.LANCHOR4
 529 0008 7047     	 bx lr
 530              	 .cfi_endproc
 531              	.LFE142:
 533 000a 00BF     	 .section .text._ZN4host12getHostStateEv,"ax",%progbits
 534              	 .align 2
 535              	 .global _ZN4host12getHostStateEv
 536              	 .thumb
 537              	 .thumb_func
 539              	_ZN4host12getHostStateEv:
 540              	.LFB143:
 650:src/MightyBoard/Motherboard/Host.cc **** 
 651:src/MightyBoard/Motherboard/Host.cc **** HostState getHostState() {
 541              	 .loc 1 651 0
 542              	 .cfi_startproc
 543              	 
 544              	 
 545              	 
 652:src/MightyBoard/Motherboard/Host.cc **** 	return currentState;
 546              	 .loc 1 652 0
 547 0000 40F20003 	 movw r3,#:lower16:.LANCHOR0
 548 0004 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 653:src/MightyBoard/Motherboard/Host.cc **** }
 549              	 .loc 1 653 0
 550 0008 1878     	 ldrb r0,[r3,#0]
 551 000a 7047     	 bx lr
 552              	 .cfi_endproc
 553              	.LFE143:
 555              	 .section .text._ZN4host16startBuildFromSDEv,"ax",%progbits
 556              	 .align 2
 557              	 .global _ZN4host16startBuildFromSDEv
 558              	 .thumb
 559              	 .thumb_func
 561              	_ZN4host16startBuildFromSDEv:
 562              	.LFB144:
 654:src/MightyBoard/Motherboard/Host.cc **** 
 655:src/MightyBoard/Motherboard/Host.cc **** sdcard::SdErrorCode startBuildFromSD() {
 563              	 .loc 1 655 0
 564              	 .cfi_startproc
 565              	 
 566              	 
 567 0000 38B5     	 push {r3,r4,r5,lr}
 568              	.LCFI6:
 569              	 .cfi_def_cfa_offset 16
 570              	 .cfi_offset 14,-4
 571              	 .cfi_offset 5,-8
 572              	 .cfi_offset 4,-12
 573              	 .cfi_offset 3,-16
 574              	.LBB222:
 656:src/MightyBoard/Motherboard/Host.cc **** 	sdcard::SdErrorCode e;
 657:src/MightyBoard/Motherboard/Host.cc **** 
 658:src/MightyBoard/Motherboard/Host.cc **** 	// Attempt to start build
 659:src/MightyBoard/Motherboard/Host.cc **** 	e = sdcard::startPlayback(buildName);
 575              	 .loc 1 659 0
 576 0002 40F20000 	 movw r0,#:lower16:.LANCHOR4
 577 0006 C0F20000 	 movt r0,#:upper16:.LANCHOR4
 578 000a FFF7FEFF 	 bl _ZN6sdcard13startPlaybackEPc
 579              	.LVL45:
 660:src/MightyBoard/Motherboard/Host.cc **** 	if (e != sdcard::SD_SUCCESS) {
 580              	 .loc 1 660 0
 581 000e 0446     	 mov r4,r0
 582 0010 F0B9     	 cbnz r0,.L40
 583              	.LVL46:
 661:src/MightyBoard/Motherboard/Host.cc **** 		// TODO: report error
 662:src/MightyBoard/Motherboard/Host.cc **** 		return e;
 663:src/MightyBoard/Motherboard/Host.cc **** 	}
 664:src/MightyBoard/Motherboard/Host.cc **** 	
 665:src/MightyBoard/Motherboard/Host.cc **** 	// clear heater temps
 666:src/MightyBoard/Motherboard/Host.cc **** 	Motherboard::getBoard().getPlatformHeater().set_target_temperature(0);
 584              	 .loc 1 666 0
 585 0012 104D     	 ldr r5,.L41
 586 0014 2846     	 mov r0,r5
 587              	.LVL47:
 588 0016 4FF00001 	 mov r1,#0
 589 001a FFF7FEFF 	 bl _ZN6Heater22set_target_temperatureEi
 590              	.LVL48:
 667:src/MightyBoard/Motherboard/Host.cc **** 	Motherboard::getBoard().getExtruderBoard(0).getExtruderHeater().set_target_temperature(0);
 591              	 .loc 1 667 0
 592 001e A5F5DE70 	 sub r0,r5,#444
 593 0022 4FF00001 	 mov r1,#0
 594 0026 FFF7FEFF 	 bl _ZN6Heater22set_target_temperatureEi
 595              	.LVL49:
 668:src/MightyBoard/Motherboard/Host.cc **** 	Motherboard::getBoard().getExtruderBoard(1).getExtruderHeater().set_target_temperature(0);
 596              	 .loc 1 668 0
 597 002a A5F1DC00 	 sub r0,r5,#220
 598 002e 4FF00001 	 mov r1,#0
 599 0032 FFF7FEFF 	 bl _ZN6Heater22set_target_temperatureEi
 669:src/MightyBoard/Motherboard/Host.cc **** 	
 670:src/MightyBoard/Motherboard/Host.cc **** 	command::reset();
 600              	 .loc 1 670 0
 601 0036 FFF7FEFF 	 bl _ZN7command5resetEv
 671:src/MightyBoard/Motherboard/Host.cc **** 	steppers::reset();
 602              	 .loc 1 671 0
 603 003a FFF7FEFF 	 bl _ZN8steppers5resetEv
 672:src/MightyBoard/Motherboard/Host.cc **** 	planner::abort();
 604              	 .loc 1 672 0
 605 003e FFF7FEFF 	 bl _ZN7planner5abortEv
 673:src/MightyBoard/Motherboard/Host.cc **** 	
 674:src/MightyBoard/Motherboard/Host.cc **** 
 675:src/MightyBoard/Motherboard/Host.cc **** 	currentState = HOST_STATE_BUILDING_FROM_SD;
 606              	 .loc 1 675 0
 607 0042 40F20003 	 movw r3,#:lower16:.LANCHOR0
 608 0046 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 609 004a 4FF00202 	 mov r2,#2
 610 004e 1A70     	 strb r2,[r3,#0]
 611              	.LVL50:
 612              	.L40:
 613              	.LBE222:
 676:src/MightyBoard/Motherboard/Host.cc **** 
 677:src/MightyBoard/Motherboard/Host.cc **** 	return e;
 678:src/MightyBoard/Motherboard/Host.cc **** }
 614              	 .loc 1 678 0
 615 0050 2046     	 mov r0,r4
 616 0052 38BD     	 pop {r3,r4,r5,pc}
 617              	.L42:
 618              	 .align 2
 619              	.L41:
 620 0054 0C020000 	 .word _ZN11Motherboard11motherboardE+524
 621              	 .cfi_endproc
 622              	.LFE144:
 624              	 .section .text._ZN4host17startOnboardBuildEh,"ax",%progbits
 625              	 .align 2
 626              	 .global _ZN4host17startOnboardBuildEh
 627              	 .thumb
 628              	 .thumb_func
 630              	_ZN4host17startOnboardBuildEh:
 631              	.LFB145:
 679:src/MightyBoard/Motherboard/Host.cc ****     // start build from utility script
 680:src/MightyBoard/Motherboard/Host.cc **** void startOnboardBuild(uint8_t  build){
 632              	 .loc 1 680 0
 633              	 .cfi_startproc
 634              	 
 635              	 
 636              	.LVL51:
 637 0000 08B5     	 push {r3,lr}
 638              	.LCFI7:
 639              	 .cfi_def_cfa_offset 8
 640              	 .cfi_offset 14,-4
 641              	 .cfi_offset 3,-8
 681:src/MightyBoard/Motherboard/Host.cc **** 	
 682:src/MightyBoard/Motherboard/Host.cc **** 	if(utility::startPlayback(build)){
 642              	 .loc 1 682 0
 643 0002 FFF7FEFF 	 bl _ZN7utility13startPlaybackEh
 644              	.LVL52:
 645 0006 30B1     	 cbz r0,.L44
 683:src/MightyBoard/Motherboard/Host.cc **** 		currentState = HOST_STATE_BUILDING_ONBOARD;
 646              	 .loc 1 683 0
 647 0008 40F20003 	 movw r3,#:lower16:.LANCHOR0
 648 000c C0F20003 	 movt r3,#:upper16:.LANCHOR0
 649 0010 4FF00502 	 mov r2,#5
 650 0014 1A70     	 strb r2,[r3,#0]
 651              	.L44:
 684:src/MightyBoard/Motherboard/Host.cc **** 	}
 685:src/MightyBoard/Motherboard/Host.cc **** 	command::reset();
 652              	 .loc 1 685 0
 653 0016 FFF7FEFF 	 bl _ZN7command5resetEv
 686:src/MightyBoard/Motherboard/Host.cc **** 	planner::abort();
 654              	 .loc 1 686 0
 655 001a FFF7FEFF 	 bl _ZN7planner5abortEv
 687:src/MightyBoard/Motherboard/Host.cc **** }
 656              	 .loc 1 687 0
 657 001e 08BD     	 pop {r3,pc}
 658              	 .cfi_endproc
 659              	.LFE145:
 661              	 .section .text._ZN4host10pauseBuildEb,"ax",%progbits
 662              	 .align 2
 663              	 .global _ZN4host10pauseBuildEb
 664              	 .thumb
 665              	 .thumb_func
 667              	_ZN4host10pauseBuildEb:
 668              	.LFB147:
 688:src/MightyBoard/Motherboard/Host.cc **** 
 689:src/MightyBoard/Motherboard/Host.cc **** // Stop the current build, if any
 690:src/MightyBoard/Motherboard/Host.cc **** void stopBuild() {
 691:src/MightyBoard/Motherboard/Host.cc ****     // if building from repG, try to send a cancel msg to repG before reseting 
 692:src/MightyBoard/Motherboard/Host.cc **** 	if(currentState == HOST_STATE_BUILDING)
 693:src/MightyBoard/Motherboard/Host.cc **** 	{	
 694:src/MightyBoard/Motherboard/Host.cc **** 		currentState = HOST_STATE_CANCEL_BUILD;
 695:src/MightyBoard/Motherboard/Host.cc **** 		cancel_timeout.start(1000000); //look for commands from repG for one second before resetting
 696:src/MightyBoard/Motherboard/Host.cc **** 		cancelBuild = true;
 697:src/MightyBoard/Motherboard/Host.cc **** 	}
 698:src/MightyBoard/Motherboard/Host.cc **** 	last_print_line = command::getLineNumber();
 699:src/MightyBoard/Motherboard/Host.cc **** 	stopPrintTime();
 700:src/MightyBoard/Motherboard/Host.cc **** 	do_host_reset = true; // indicate reset after response has been sent
 701:src/MightyBoard/Motherboard/Host.cc **** 	buildState = BUILD_CANCELED;
 702:src/MightyBoard/Motherboard/Host.cc **** }
 703:src/MightyBoard/Motherboard/Host.cc **** 
 704:src/MightyBoard/Motherboard/Host.cc **** /// update state variables if print is paused
 705:src/MightyBoard/Motherboard/Host.cc **** void pauseBuild(bool pause){
 669              	 .loc 1 705 0
 670              	 .cfi_startproc
 671              	 
 672              	 
 673              	.LVL53:
 674 0000 10B5     	 push {r4,lr}
 675              	.LCFI8:
 676              	 .cfi_def_cfa_offset 8
 677              	 .cfi_offset 14,-4
 678              	 .cfi_offset 4,-8
 679 0002 0446     	 mov r4,r0
 706:src/MightyBoard/Motherboard/Host.cc **** 	
 707:src/MightyBoard/Motherboard/Host.cc **** 	/// don't update time or state if we are already in the desired state
 708:src/MightyBoard/Motherboard/Host.cc **** 	if (!(pause == command::isPaused())){
 680              	 .loc 1 708 0
 681 0004 FFF7FEFF 	 bl _ZN7command8isPausedEv
 682              	.LVL54:
 683 0008 A042     	 cmp r0,r4
 684 000a 22D0     	 beq .L45
 709:src/MightyBoard/Motherboard/Host.cc **** 		
 710:src/MightyBoard/Motherboard/Host.cc **** 		command::pause(pause);
 685              	 .loc 1 710 0
 686 000c 2046     	 mov r0,r4
 687 000e FFF7FEFF 	 bl _ZN7command5pauseEb
 711:src/MightyBoard/Motherboard/Host.cc **** 		if(pause){
 688              	 .loc 1 711 0
 689 0012 7CB1     	 cbz r4,.L47
 712:src/MightyBoard/Motherboard/Host.cc **** 			buildState = BUILD_PAUSED;
 690              	 .loc 1 712 0
 691 0014 40F20003 	 movw r3,#:lower16:.LANCHOR5
 692 0018 C0F20003 	 movt r3,#:upper16:.LANCHOR5
 693 001c 4FF00302 	 mov r2,#3
 694 0020 1A70     	 strb r2,[r3,#0]
 713:src/MightyBoard/Motherboard/Host.cc **** 			print_time.pause(true);
 695              	 .loc 1 713 0
 696 0022 40F20000 	 movw r0,#:lower16:.LANCHOR6
 697 0026 C0F20000 	 movt r0,#:upper16:.LANCHOR6
 698 002a 4FF00101 	 mov r1,#1
 699 002e FFF7FEFF 	 bl _ZN7Timeout5pauseEb
 700 0032 10BD     	 pop {r4,pc}
 701              	.L47:
 714:src/MightyBoard/Motherboard/Host.cc **** 		}else{
 715:src/MightyBoard/Motherboard/Host.cc **** 			buildState = BUILD_RUNNING;
 702              	 .loc 1 715 0
 703 0034 40F20003 	 movw r3,#:lower16:.LANCHOR5
 704 0038 C0F20003 	 movt r3,#:upper16:.LANCHOR5
 705 003c 4FF00102 	 mov r2,#1
 706 0040 1A70     	 strb r2,[r3,#0]
 716:src/MightyBoard/Motherboard/Host.cc **** 			print_time.pause(false);
 707              	 .loc 1 716 0
 708 0042 40F20000 	 movw r0,#:lower16:.LANCHOR6
 709 0046 C0F20000 	 movt r0,#:upper16:.LANCHOR6
 710 004a 4FF00001 	 mov r1,#0
 711 004e FFF7FEFF 	 bl _ZN7Timeout5pauseEb
 712              	.L45:
 713 0052 10BD     	 pop {r4,pc}
 714              	 .cfi_endproc
 715              	.LFE147:
 717              	 .section .text._ZN4host14startPrintTimeEv,"ax",%progbits
 718              	 .align 2
 719              	 .global _ZN4host14startPrintTimeEv
 720              	 .thumb
 721              	 .thumb_func
 723              	_ZN4host14startPrintTimeEv:
 724              	.LFB148:
 717:src/MightyBoard/Motherboard/Host.cc **** 		}
 718:src/MightyBoard/Motherboard/Host.cc **** 	}
 719:src/MightyBoard/Motherboard/Host.cc **** }
 720:src/MightyBoard/Motherboard/Host.cc **** 
 721:src/MightyBoard/Motherboard/Host.cc **** void startPrintTime(){
 725              	 .loc 1 721 0
 726              	 .cfi_startproc
 727              	 
 728              	 
 729 0000 08B5     	 push {r3,lr}
 730              	.LCFI9:
 731              	 .cfi_def_cfa_offset 8
 732              	 .cfi_offset 14,-4
 733              	 .cfi_offset 3,-8
 722:src/MightyBoard/Motherboard/Host.cc **** 	print_time.start(ONE_HOUR);
 734              	 .loc 1 722 0
 735 0002 40F20000 	 movw r0,#:lower16:.LANCHOR6
 736 0006 C0F20000 	 movt r0,#:upper16:.LANCHOR6
 737 000a 4FF42441 	 mov r1,#41984
 738 000e CDF29361 	 movt r1,54931
 739 0012 FFF7FEFF 	 bl _ZN7Timeout5startEm
 723:src/MightyBoard/Motherboard/Host.cc **** 	print_time_hours = 0;
 740              	 .loc 1 723 0
 741 0016 40F20003 	 movw r3,#:lower16:.LANCHOR7
 742 001a C0F20003 	 movt r3,#:upper16:.LANCHOR7
 743 001e 4FF00002 	 mov r2,#0
 744 0022 1A70     	 strb r2,[r3,#0]
 724:src/MightyBoard/Motherboard/Host.cc **** }
 745              	 .loc 1 724 0
 746 0024 08BD     	 pop {r3,pc}
 747              	 .cfi_endproc
 748              	.LFE148:
 750 0026 00BF     	 .section .text._ZN4host28handleBuildStartNotificationER19CircularBufferTemplIhE,"ax",%progbits
 751              	 .align 2
 752              	 .global _ZN4host28handleBuildStartNotificationER19CircularBufferTemplIhE
 753              	 .thumb
 754              	 .thumb_func
 756              	_ZN4host28handleBuildStartNotificationER19CircularBufferTemplIhE:
 757              	.LFB136:
 478:src/MightyBoard/Motherboard/Host.cc **** void handleBuildStartNotification(CircularBuffer& buf) {
 758              	 .loc 1 478 0
 759              	 .cfi_startproc
 760              	 
 761              	 
 762              	.LVL55:
 763 0000 2DE9F041 	 push {r4,r5,r6,r7,r8,lr}
 764              	.LCFI10:
 765              	 .cfi_def_cfa_offset 24
 766              	 .cfi_offset 14,-4
 767              	 .cfi_offset 8,-8
 768              	 .cfi_offset 7,-12
 769              	 .cfi_offset 6,-16
 770              	 .cfi_offset 5,-20
 771              	 .cfi_offset 4,-24
 772 0004 88B0     	 sub sp,sp,#32
 773              	.LCFI11:
 774              	 .cfi_def_cfa_offset 56
 775              	.LVL56:
 776              	.LBB223:
 482:src/MightyBoard/Motherboard/Host.cc **** 	switch (currentState){
 777              	 .loc 1 482 0
 778 0006 40F20003 	 movw r3,#:lower16:.LANCHOR0
 779 000a C0F20003 	 movt r3,#:upper16:.LANCHOR0
 780 000e 1B78     	 ldrb r3,[r3,#0]
 781 0010 052B     	 cmp r3,#5
 782 0012 00F28580 	 bhi .L50
 783 0016 DFE803F0 	 tbb [pc,r3]
 784              	.L54:
 785 001a 47       	 .byte (.L51-.L54)/2
 786 001b 4E       	 .byte (.L52-.L54)/2
 787 001c 03       	 .byte (.L60-.L54)/2
 788 001d 83       	 .byte (.L50-.L54)/2
 789 001e 83       	 .byte (.L50-.L54)/2
 790 001f 4E       	 .byte (.L52-.L54)/2
 791              	 .align 1
 792              	.L60:
 793 0020 4FF00003 	 mov r3,#0
 794              	.LBB224:
 795              	.LBB225:
 796              	 .file 3 "src/MightyBoard/shared/CircularBuffer.hh"
   1:src/MightyBoard/shared/CircularBuffer.hh **** /*
   2:src/MightyBoard/shared/CircularBuffer.hh ****  * Copyright 2010 by Adam Mayer	 <adam@makerbot.com>
   3:src/MightyBoard/shared/CircularBuffer.hh ****  *
   4:src/MightyBoard/shared/CircularBuffer.hh ****  * This program is free software: you can redistribute it and/or modify
   5:src/MightyBoard/shared/CircularBuffer.hh ****  * it under the terms of the GNU General Public License as published by
   6:src/MightyBoard/shared/CircularBuffer.hh ****  * the Free Software Foundation, either version 3 of the License, or
   7:src/MightyBoard/shared/CircularBuffer.hh ****  * (at your option) any later version.
   8:src/MightyBoard/shared/CircularBuffer.hh ****  *
   9:src/MightyBoard/shared/CircularBuffer.hh ****  * This program is distributed in the hope that it will be useful,
  10:src/MightyBoard/shared/CircularBuffer.hh ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:src/MightyBoard/shared/CircularBuffer.hh ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:src/MightyBoard/shared/CircularBuffer.hh ****  * GNU General Public License for more details.
  13:src/MightyBoard/shared/CircularBuffer.hh ****  *
  14:src/MightyBoard/shared/CircularBuffer.hh ****  * You should have received a copy of the GNU General Public License
  15:src/MightyBoard/shared/CircularBuffer.hh ****  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  16:src/MightyBoard/shared/CircularBuffer.hh ****  */
  17:src/MightyBoard/shared/CircularBuffer.hh **** 
  18:src/MightyBoard/shared/CircularBuffer.hh **** 
  19:src/MightyBoard/shared/CircularBuffer.hh **** #ifndef SHARED_CIRCULAR_BUFFER_HH_
  20:src/MightyBoard/shared/CircularBuffer.hh **** #define SHARED_CIRCULAR_BUFFER_HH_
  21:src/MightyBoard/shared/CircularBuffer.hh **** 
  22:src/MightyBoard/shared/CircularBuffer.hh **** #include <stdint.h>
  23:src/MightyBoard/shared/CircularBuffer.hh **** 
  24:src/MightyBoard/shared/CircularBuffer.hh **** typedef uint16_t BufSizeType;
  25:src/MightyBoard/shared/CircularBuffer.hh **** 
  26:src/MightyBoard/shared/CircularBuffer.hh **** /// A simple, reliable circular buffer implementation.
  27:src/MightyBoard/shared/CircularBuffer.hh **** /// This implementation does not offer any protection from
  28:src/MightyBoard/shared/CircularBuffer.hh **** /// interrupts and code writing over each other!  You must
  29:src/MightyBoard/shared/CircularBuffer.hh **** /// disable interrupts before all accesses and writes to
  30:src/MightyBoard/shared/CircularBuffer.hh **** /// a circular buffer that is updated in an interrupt.
  31:src/MightyBoard/shared/CircularBuffer.hh **** template<typename T>
  32:src/MightyBoard/shared/CircularBuffer.hh **** class CircularBufferTempl {
  33:src/MightyBoard/shared/CircularBuffer.hh **** public:
  34:src/MightyBoard/shared/CircularBuffer.hh **** 	typedef T BufDataType;
  35:src/MightyBoard/shared/CircularBuffer.hh **** private:
  36:src/MightyBoard/shared/CircularBuffer.hh **** 	const BufSizeType size; /// Size of this buffer
  37:src/MightyBoard/shared/CircularBuffer.hh **** 	volatile BufSizeType length; /// Current length of valid buffer data
  38:src/MightyBoard/shared/CircularBuffer.hh **** 	volatile BufSizeType start; /// Current start point of valid bufffer data
  39:src/MightyBoard/shared/CircularBuffer.hh **** 	BufDataType* const data; /// Pointer to buffer data
  40:src/MightyBoard/shared/CircularBuffer.hh **** 	volatile bool overflow; /// Overflow indicator
  41:src/MightyBoard/shared/CircularBuffer.hh **** 	volatile bool underflow; /// Underflow indicator
  42:src/MightyBoard/shared/CircularBuffer.hh **** public:
  43:src/MightyBoard/shared/CircularBuffer.hh **** 	CircularBufferTempl(BufSizeType size_in, BufDataType* data_in) :
  44:src/MightyBoard/shared/CircularBuffer.hh **** 		size(size_in), length(0), start(0), data(data_in), overflow(false),
  45:src/MightyBoard/shared/CircularBuffer.hh **** 				underflow(false) {
  46:src/MightyBoard/shared/CircularBuffer.hh **** 	}
  47:src/MightyBoard/shared/CircularBuffer.hh **** 
  48:src/MightyBoard/shared/CircularBuffer.hh **** 	/// Reset the buffer to its empty state.  All data in
  49:src/MightyBoard/shared/CircularBuffer.hh **** 	/// the buffer will be (effectively) lost.
  50:src/MightyBoard/shared/CircularBuffer.hh **** 	inline void reset() {
  51:src/MightyBoard/shared/CircularBuffer.hh **** 		length = 0;
  52:src/MightyBoard/shared/CircularBuffer.hh **** 		start = 0;
  53:src/MightyBoard/shared/CircularBuffer.hh **** 		overflow = false;
  54:src/MightyBoard/shared/CircularBuffer.hh **** 		underflow = false;
  55:src/MightyBoard/shared/CircularBuffer.hh **** 	}
  56:src/MightyBoard/shared/CircularBuffer.hh **** 	/// Append a byte to the tail of the buffer
  57:src/MightyBoard/shared/CircularBuffer.hh **** 	inline void push(BufDataType b) {
  58:src/MightyBoard/shared/CircularBuffer.hh **** 		if (length < size) {
  59:src/MightyBoard/shared/CircularBuffer.hh **** 			operator[](length) = b;
  60:src/MightyBoard/shared/CircularBuffer.hh **** 			length++;
  61:src/MightyBoard/shared/CircularBuffer.hh **** 		} else {
  62:src/MightyBoard/shared/CircularBuffer.hh **** 			overflow = true;
  63:src/MightyBoard/shared/CircularBuffer.hh **** 		}
  64:src/MightyBoard/shared/CircularBuffer.hh **** 	}
  65:src/MightyBoard/shared/CircularBuffer.hh **** 	/// Pop a byte off the head of the buffer
  66:src/MightyBoard/shared/CircularBuffer.hh **** 	inline BufDataType pop() {
  67:src/MightyBoard/shared/CircularBuffer.hh **** 		if (isEmpty()) {
  68:src/MightyBoard/shared/CircularBuffer.hh **** 			underflow = true;
 797              	 .loc 3 68 0
 798 0024 4FF00106 	 mov r6,#1
  69:src/MightyBoard/shared/CircularBuffer.hh **** 			return BufDataType();
 799              	 .loc 3 69 0
 800 0028 1D46     	 mov r5,r3
 801              	.LVL57:
 802              	.L53:
 803              	.LBE225:
 804              	.LBE224:
 485:src/MightyBoard/Motherboard/Host.cc **** 				newName[idx++] = buf.pop();		
 805              	 .loc 1 485 0 discriminator 1
 806 002a 1C46     	 mov r4,r3
 807              	.LVL58:
 808              	.LBB232:
 809              	.LBB230:
 810              	.LBB226:
 811              	.LBB227:
  70:src/MightyBoard/shared/CircularBuffer.hh **** 		}
  71:src/MightyBoard/shared/CircularBuffer.hh **** 		const BufDataType& popped_byte = operator[](0);
  72:src/MightyBoard/shared/CircularBuffer.hh **** 		start = (start + 1) % size;
  73:src/MightyBoard/shared/CircularBuffer.hh **** 		length--;
  74:src/MightyBoard/shared/CircularBuffer.hh **** 		return popped_byte;
  75:src/MightyBoard/shared/CircularBuffer.hh **** 	}
  76:src/MightyBoard/shared/CircularBuffer.hh **** 
  77:src/MightyBoard/shared/CircularBuffer.hh **** 	/// Pop a number of bytes off the head of the buffer.  If there
  78:src/MightyBoard/shared/CircularBuffer.hh **** 	/// are not enough bytes to complete the pop, pop what we can and
  79:src/MightyBoard/shared/CircularBuffer.hh **** 	/// set the underflow flag.
  80:src/MightyBoard/shared/CircularBuffer.hh **** 	inline void pop(BufSizeType sz) {
  81:src/MightyBoard/shared/CircularBuffer.hh **** 		if (length < sz) {
  82:src/MightyBoard/shared/CircularBuffer.hh **** 			underflow = true;
  83:src/MightyBoard/shared/CircularBuffer.hh **** 			sz = length;
  84:src/MightyBoard/shared/CircularBuffer.hh **** 		}
  85:src/MightyBoard/shared/CircularBuffer.hh **** 		start = (start + sz) % size;
  86:src/MightyBoard/shared/CircularBuffer.hh **** 		length -= sz;
  87:src/MightyBoard/shared/CircularBuffer.hh **** 	}
  88:src/MightyBoard/shared/CircularBuffer.hh **** 
  89:src/MightyBoard/shared/CircularBuffer.hh **** 	/// Get the length of the buffer
  90:src/MightyBoard/shared/CircularBuffer.hh **** 	inline const BufSizeType getLength() const {
  91:src/MightyBoard/shared/CircularBuffer.hh **** 		return length;
  92:src/MightyBoard/shared/CircularBuffer.hh **** 	}
  93:src/MightyBoard/shared/CircularBuffer.hh **** 
  94:src/MightyBoard/shared/CircularBuffer.hh **** 	/// Get the remaining capacity of this buffer
  95:src/MightyBoard/shared/CircularBuffer.hh **** 	inline const BufSizeType getRemainingCapacity() const {
  96:src/MightyBoard/shared/CircularBuffer.hh **** 		return size - length;
  97:src/MightyBoard/shared/CircularBuffer.hh **** 	}
  98:src/MightyBoard/shared/CircularBuffer.hh **** 
  99:src/MightyBoard/shared/CircularBuffer.hh **** 	/// Check if the buffer is empty
 100:src/MightyBoard/shared/CircularBuffer.hh **** 	inline const bool isEmpty() const {
 101:src/MightyBoard/shared/CircularBuffer.hh **** 		return length == 0;
 812              	 .loc 3 101 0 discriminator 1
 813 002c 4288     	 ldrh r2,[r0,#2]
 814 002e 92B2     	 uxth r2,r2
 815              	.LBE227:
 816              	.LBE226:
  67:src/MightyBoard/shared/CircularBuffer.hh **** 		if (isEmpty()) {
 817              	 .loc 3 67 0 discriminator 1
 818 0030 12B9     	 cbnz r2,.L55
  68:src/MightyBoard/shared/CircularBuffer.hh **** 			underflow = true;
 819              	 .loc 3 68 0
 820 0032 4673     	 strb r6,[r0,#13]
  69:src/MightyBoard/shared/CircularBuffer.hh **** 			return BufDataType();
 821              	 .loc 3 69 0
 822 0034 2946     	 mov r1,r5
 823 0036 1AE0     	 b .L56
 824              	.L55:
 825              	.LVL59:
 826              	.LBB228:
 827              	.LBB229:
 102:src/MightyBoard/shared/CircularBuffer.hh **** 	}
 103:src/MightyBoard/shared/CircularBuffer.hh **** 	/// Read the buffer directly
 104:src/MightyBoard/shared/CircularBuffer.hh **** 	inline BufDataType& operator[](BufSizeType index) {
 105:src/MightyBoard/shared/CircularBuffer.hh **** 		const BufSizeType actual_index = (index + start) % size;
 828              	 .loc 3 105 0
 829 0038 8188     	 ldrh r1,[r0,#4]
 830 003a 89B2     	 uxth r1,r1
 831 003c 0288     	 ldrh r2,[r0,#0]
 832              	.LVL60:
 833 003e 91FBF2F7 	 sdiv r7,r1,r2
 834 0042 02FB1711 	 mls r1,r2,r7,r1
 835              	.LVL61:
 106:src/MightyBoard/shared/CircularBuffer.hh **** 		return data[actual_index];
 836              	 .loc 3 106 0
 837 0046 8FB2     	 uxth r7,r1
 838 0048 D0F808E0 	 ldr lr,[r0,#8]
 839              	.LBE229:
 840              	.LBE228:
  72:src/MightyBoard/shared/CircularBuffer.hh **** 		start = (start + 1) % size;
 841              	 .loc 3 72 0
 842 004c 8188     	 ldrh r1,[r0,#4]
 843 004e 89B2     	 uxth r1,r1
 844 0050 01F10101 	 add r1,r1,#1
 845 0054 91FBF2FC 	 sdiv ip,r1,r2
 846 0058 02FB1C12 	 mls r2,r2,ip,r1
 847 005c 92B2     	 uxth r2,r2
 848 005e 8280     	 strh r2,[r0,#4]
  73:src/MightyBoard/shared/CircularBuffer.hh **** 		length--;
 849              	 .loc 3 73 0
 850 0060 4288     	 ldrh r2,[r0,#2]
 851 0062 02F1FF32 	 add r2,r2,#-1
 852 0066 92B2     	 uxth r2,r2
 853 0068 4280     	 strh r2,[r0,#2]
  74:src/MightyBoard/shared/CircularBuffer.hh **** 		return popped_byte;
 854              	 .loc 3 74 0
 855 006a 1EF80710 	 ldrb r1,[lr,r7]
 856              	.LVL62:
 857              	.L56:
 858              	.LBE230:
 859              	.LBE232:
 485:src/MightyBoard/Motherboard/Host.cc **** 				newName[idx++] = buf.pop();		
 860              	 .loc 1 485 0
 861 006e 08AF     	 add r7,sp,#32
 862 0070 3A19     	 adds r2,r7,r4
 863 0072 02F8201C 	 strb r1,[r2,#-32]
 864 0076 03F10103 	 add r3,r3,#1
 865              	.LVL63:
 866 007a DBB2     	 uxtb r3,r3
 867              	.LVL64:
 486:src/MightyBoard/Motherboard/Host.cc **** 			} while (newName[idx-1] != '\0');
 868              	 .loc 1 486 0
 869 007c FA18     	 adds r2,r7,r3
 484:src/MightyBoard/Motherboard/Host.cc **** 			do {
 870              	 .loc 1 484 0
 871 007e 12F8212C 	 ldrb r2,[r2,#-33]
 872 0082 002A     	 cmp r2,#0
 873 0084 D1D1     	 bne .L53
 487:src/MightyBoard/Motherboard/Host.cc **** 			if(strcmp(newName, "RepG Build"))
 874              	 .loc 1 487 0
 875 0086 6846     	 mov r0,sp
 876              	.LVL65:
 877 0088 40F20001 	 movw r1,#:lower16:.LC0
 878 008c C0F20001 	 movt r1,#:upper16:.LC0
 879 0090 FFF7FEFF 	 bl strcmp
 880              	.LVL66:
 881 0094 0028     	 cmp r0,#0
 882 0096 43D0     	 beq .L50
 488:src/MightyBoard/Motherboard/Host.cc **** 				strcpy(buildName, newName);
 883              	 .loc 1 488 0
 884 0098 40F20000 	 movw r0,#:lower16:.LANCHOR4
 885 009c C0F20000 	 movt r0,#:upper16:.LANCHOR4
 886 00a0 6946     	 mov r1,sp
 887 00a2 FFF7FEFF 	 bl strcpy
 888 00a6 3BE0     	 b .L50
 889              	.LVL67:
 890              	.L51:
 491:src/MightyBoard/Motherboard/Host.cc **** 			currentState = HOST_STATE_BUILDING;
 891              	 .loc 1 491 0
 892 00a8 40F20003 	 movw r3,#:lower16:.LANCHOR0
 893 00ac C0F20003 	 movt r3,#:upper16:.LANCHOR0
 894 00b0 4FF00102 	 mov r2,#1
 895 00b4 1A70     	 strb r2,[r3,#0]
 896              	.L52:
 897              	.LBB233:
 898              	.LBB231:
  69:src/MightyBoard/shared/CircularBuffer.hh **** 			return BufDataType();
 899              	 .loc 3 69 0 discriminator 1
 900 00b6 4FF00003 	 mov r3,#0
 901              	.LBE231:
 902              	.LBE233:
 903              	.LBB234:
 904              	.LBB235:
  68:src/MightyBoard/shared/CircularBuffer.hh **** 			underflow = true;
 905              	 .loc 3 68 0 discriminator 1
 906 00ba 4FF00107 	 mov r7,#1
  69:src/MightyBoard/shared/CircularBuffer.hh **** 			return BufDataType();
 907              	 .loc 3 69 0 discriminator 1
 908 00be 1E46     	 mov r6,r3
 909              	.LBE235:
 910              	.LBE234:
 495:src/MightyBoard/Motherboard/Host.cc **** 				buildName[idx++] = buf.pop();		
 911              	 .loc 1 495 0 discriminator 1
 912 00c0 40F20001 	 movw r1,#:lower16:.LANCHOR4
 913 00c4 C0F20001 	 movt r1,#:upper16:.LANCHOR4
 914              	.LVL68:
 915              	.L59:
 916 00c8 1C46     	 mov r4,r3
 917              	.LVL69:
 918              	.LBB241:
 919              	.LBB240:
 920              	.LBB236:
 921              	.LBB237:
 101:src/MightyBoard/shared/CircularBuffer.hh **** 		return length == 0;
 922              	 .loc 3 101 0 discriminator 1
 923 00ca 4288     	 ldrh r2,[r0,#2]
 924 00cc 92B2     	 uxth r2,r2
 925              	.LBE237:
 926              	.LBE236:
  67:src/MightyBoard/shared/CircularBuffer.hh **** 		if (isEmpty()) {
 927              	 .loc 3 67 0 discriminator 1
 928 00ce 12B9     	 cbnz r2,.L57
 929              	.LVL70:
  68:src/MightyBoard/shared/CircularBuffer.hh **** 			underflow = true;
 930              	 .loc 3 68 0
 931 00d0 4773     	 strb r7,[r0,#13]
  69:src/MightyBoard/shared/CircularBuffer.hh **** 			return BufDataType();
 932              	 .loc 3 69 0
 933 00d2 3246     	 mov r2,r6
 934 00d4 1BE0     	 b .L58
 935              	.L57:
 936              	.LVL71:
 937              	.LBB238:
 938              	.LBB239:
 105:src/MightyBoard/shared/CircularBuffer.hh **** 		const BufSizeType actual_index = (index + start) % size;
 939              	 .loc 3 105 0
 940 00d6 8588     	 ldrh r5,[r0,#4]
 941 00d8 ADB2     	 uxth r5,r5
 942 00da 0288     	 ldrh r2,[r0,#0]
 943              	.LVL72:
 944 00dc 95FBF2FE 	 sdiv lr,r5,r2
 945 00e0 02FB1E55 	 mls r5,r2,lr,r5
 946              	.LVL73:
 947              	 .loc 3 106 0
 948 00e4 1FFA85FE 	 uxth lr,r5
 949 00e8 D0F808C0 	 ldr ip,[r0,#8]
 950              	.LBE239:
 951              	.LBE238:
  72:src/MightyBoard/shared/CircularBuffer.hh **** 		start = (start + 1) % size;
 952              	 .loc 3 72 0
 953 00ec 8588     	 ldrh r5,[r0,#4]
 954 00ee ADB2     	 uxth r5,r5
 955 00f0 05F10105 	 add r5,r5,#1
 956 00f4 95FBF2F8 	 sdiv r8,r5,r2
 957 00f8 02FB1852 	 mls r2,r2,r8,r5
 958 00fc 92B2     	 uxth r2,r2
 959 00fe 8280     	 strh r2,[r0,#4]
  73:src/MightyBoard/shared/CircularBuffer.hh **** 		length--;
 960              	 .loc 3 73 0
 961 0100 4288     	 ldrh r2,[r0,#2]
 962 0102 02F1FF32 	 add r2,r2,#-1
 963 0106 92B2     	 uxth r2,r2
 964 0108 4280     	 strh r2,[r0,#2]
  74:src/MightyBoard/shared/CircularBuffer.hh **** 		return popped_byte;
 965              	 .loc 3 74 0
 966 010a 1CF80E20 	 ldrb r2,[ip,lr]
 967              	.LVL74:
 968              	.L58:
 969              	.LBE240:
 970              	.LBE241:
 495:src/MightyBoard/Motherboard/Host.cc **** 				buildName[idx++] = buf.pop();		
 971              	 .loc 1 495 0
 972 010e 0A55     	 strb r2,[r1,r4]
 973 0110 03F10103 	 add r3,r3,#1
 974              	.LVL75:
 975 0114 DBB2     	 uxtb r3,r3
 976              	.LVL76:
 496:src/MightyBoard/Motherboard/Host.cc **** 			} while (buildName[idx-1] != '\0');
 977              	 .loc 1 496 0
 978 0116 CA18     	 adds r2,r1,r3
 494:src/MightyBoard/Motherboard/Host.cc **** 			do {
 979              	 .loc 1 494 0
 980 0118 12F8012C 	 ldrb r2,[r2,#-1]
 981 011c 002A     	 cmp r2,#0
 982 011e D3D1     	 bne .L59
 983              	.LVL77:
 984              	.L50:
 499:src/MightyBoard/Motherboard/Host.cc **** 	startPrintTime();
 985              	 .loc 1 499 0
 986 0120 FFF7FEFF 	 bl _ZN4host14startPrintTimeEv
 500:src/MightyBoard/Motherboard/Host.cc **** 	command::clearLineNumber();
 987              	 .loc 1 500 0
 988 0124 FFF7FEFF 	 bl _ZN7command15clearLineNumberEv
 501:src/MightyBoard/Motherboard/Host.cc **** 	buildState = BUILD_RUNNING;
 989              	 .loc 1 501 0
 990 0128 40F20003 	 movw r3,#:lower16:.LANCHOR5
 991 012c C0F20003 	 movt r3,#:upper16:.LANCHOR5
 992 0130 4FF00102 	 mov r2,#1
 993 0134 1A70     	 strb r2,[r3,#0]
 994              	.LBE223:
 502:src/MightyBoard/Motherboard/Host.cc **** }
 995              	 .loc 1 502 0
 996 0136 08B0     	 add sp,sp,#32
 997 0138 BDE8F081 	 pop {r4,r5,r6,r7,r8,pc}
 998              	 .cfi_endproc
 999              	.LFE136:
 1001              	 .section .text._ZN4host15managePrintTimeEv,"ax",%progbits
 1002              	 .align 2
 1003              	 .global _ZN4host15managePrintTimeEv
 1004              	 .thumb
 1005              	 .thumb_func
 1007              	_ZN4host15managePrintTimeEv:
 1008              	.LFB150:
 725:src/MightyBoard/Motherboard/Host.cc **** 
 726:src/MightyBoard/Motherboard/Host.cc **** void stopPrintTime(){
 727:src/MightyBoard/Motherboard/Host.cc **** 	
 728:src/MightyBoard/Motherboard/Host.cc **** 	getPrintTime(last_print_hours, last_print_minutes);
 729:src/MightyBoard/Motherboard/Host.cc **** 	print_time = Timeout();
 730:src/MightyBoard/Motherboard/Host.cc **** 	print_time_hours = 0;
 731:src/MightyBoard/Motherboard/Host.cc **** }
 732:src/MightyBoard/Motherboard/Host.cc **** 
 733:src/MightyBoard/Motherboard/Host.cc **** void managePrintTime(){
 1009              	 .loc 1 733 0
 1010              	 .cfi_startproc
 1011              	 
 1012              	 
 1013 0000 08B5     	 push {r3,lr}
 1014              	.LCFI12:
 1015              	 .cfi_def_cfa_offset 8
 1016              	 .cfi_offset 14,-4
 1017              	 .cfi_offset 3,-8
 734:src/MightyBoard/Motherboard/Host.cc **** 
 735:src/MightyBoard/Motherboard/Host.cc **** 	/// print time is precise to the host loop frequency 
 736:src/MightyBoard/Motherboard/Host.cc **** 	if (print_time.hasElapsed()){
 1018              	 .loc 1 736 0
 1019 0002 40F20000 	 movw r0,#:lower16:.LANCHOR6
 1020 0006 C0F20000 	 movt r0,#:upper16:.LANCHOR6
 1021 000a FFF7FEFF 	 bl _ZN7Timeout10hasElapsedEv
 1022 000e 88B1     	 cbz r0,.L63
 737:src/MightyBoard/Motherboard/Host.cc **** 		print_time.start(ONE_HOUR);
 1023              	 .loc 1 737 0
 1024 0010 40F20000 	 movw r0,#:lower16:.LANCHOR6
 1025 0014 C0F20000 	 movt r0,#:upper16:.LANCHOR6
 1026 0018 4FF42441 	 mov r1,#41984
 1027 001c CDF29361 	 movt r1,54931
 1028 0020 FFF7FEFF 	 bl _ZN7Timeout5startEm
 738:src/MightyBoard/Motherboard/Host.cc **** 		print_time_hours++;
 1029              	 .loc 1 738 0
 1030 0024 40F20003 	 movw r3,#:lower16:.LANCHOR7
 1031 0028 C0F20003 	 movt r3,#:upper16:.LANCHOR7
 1032 002c 1A78     	 ldrb r2,[r3,#0]
 1033 002e 02F10102 	 add r2,r2,#1
 1034 0032 1A70     	 strb r2,[r3,#0]
 1035              	.L63:
 1036 0034 08BD     	 pop {r3,pc}
 1037              	 .cfi_endproc
 1038              	.LFE150:
 1040 0036 00BF     	 .section .text._ZN4host12getPrintTimeERhS0_,"ax",%progbits
 1041              	 .align 2
 1042              	 .global _ZN4host12getPrintTimeERhS0_
 1043              	 .thumb
 1044              	 .thumb_func
 1046              	_ZN4host12getPrintTimeERhS0_:
 1047              	.LFB151:
 739:src/MightyBoard/Motherboard/Host.cc **** 	}
 740:src/MightyBoard/Motherboard/Host.cc **** }
 741:src/MightyBoard/Motherboard/Host.cc **** 
 742:src/MightyBoard/Motherboard/Host.cc **** /// returns time hours and minutes since the start of the print
 743:src/MightyBoard/Motherboard/Host.cc **** void getPrintTime(uint8_t& hours, uint8_t& minutes){
 1048              	 .loc 1 743 0
 1049              	 .cfi_startproc
 1050              	 
 1051              	 
 1052              	.LVL78:
 1053 0000 10B5     	 push {r4,lr}
 1054              	.LCFI13:
 1055              	 .cfi_def_cfa_offset 8
 1056              	 .cfi_offset 14,-4
 1057              	 .cfi_offset 4,-8
 1058 0002 0C46     	 mov r4,r1
 744:src/MightyBoard/Motherboard/Host.cc **** 	
 745:src/MightyBoard/Motherboard/Host.cc **** 	hours = print_time_hours;
 1059              	 .loc 1 745 0
 1060 0004 40F20003 	 movw r3,#:lower16:.LANCHOR7
 1061 0008 C0F20003 	 movt r3,#:upper16:.LANCHOR7
 1062 000c 1B78     	 ldrb r3,[r3,#0]
 1063 000e 0370     	 strb r3,[r0,#0]
 746:src/MightyBoard/Motherboard/Host.cc **** 	minutes = print_time.getCurrentElapsed() / 60000000;
 1064              	 .loc 1 746 0
 1065 0010 40F20000 	 movw r0,#:lower16:.LANCHOR6
 1066              	.LVL79:
 1067 0014 C0F20000 	 movt r0,#:upper16:.LANCHOR6
 1068 0018 FFF7FEFF 	 bl _ZN7Timeout17getCurrentElapsedEv
 1069              	.LVL80:
 1070 001c 4FEA1020 	 lsr r0,r0,#8
 1071 0020 45F2C743 	 movw r3,#21703
 1072 0024 C0F21E13 	 movt r3,286
 1073 0028 A3FB0023 	 umull r2,r3,r3,r0
 1074 002c 4FEA9323 	 lsr r3,r3,#10
 1075 0030 2370     	 strb r3,[r4,#0]
 747:src/MightyBoard/Motherboard/Host.cc **** 	return;
 748:src/MightyBoard/Motherboard/Host.cc **** }
 1076              	 .loc 1 748 0
 1077 0032 10BD     	 pop {r4,pc}
 1078              	 .cfi_endproc
 1079              	.LFE151:
 1081              	 .section .text._ZN4host13stopPrintTimeEv,"ax",%progbits
 1082              	 .align 2
 1083              	 .global _ZN4host13stopPrintTimeEv
 1084              	 .thumb
 1085              	 .thumb_func
 1087              	_ZN4host13stopPrintTimeEv:
 1088              	.LFB149:
 726:src/MightyBoard/Motherboard/Host.cc **** void stopPrintTime(){
 1089              	 .loc 1 726 0
 1090              	 .cfi_startproc
 1091              	 
 1092              	 
 1093 0000 30B5     	 push {r4,r5,lr}
 1094              	.LCFI14:
 1095              	 .cfi_def_cfa_offset 12
 1096              	 .cfi_offset 14,-4
 1097              	 .cfi_offset 5,-8
 1098              	 .cfi_offset 4,-12
 1099 0002 85B0     	 sub sp,sp,#20
 1100              	.LCFI15:
 1101              	 .cfi_def_cfa_offset 32
 728:src/MightyBoard/Motherboard/Host.cc **** 	getPrintTime(last_print_hours, last_print_minutes);
 1102              	 .loc 1 728 0
 1103 0004 40F20000 	 movw r0,#:lower16:.LANCHOR8
 1104 0008 C0F20000 	 movt r0,#:upper16:.LANCHOR8
 1105 000c 40F20001 	 movw r1,#:lower16:.LANCHOR9
 1106 0010 C0F20001 	 movt r1,#:upper16:.LANCHOR9
 1107 0014 FFF7FEFF 	 bl _ZN4host12getPrintTimeERhS0_
 729:src/MightyBoard/Motherboard/Host.cc **** 	print_time = Timeout();
 1108              	 .loc 1 729 0
 1109 0018 6846     	 mov r0,sp
 1110 001a FFF7FEFF 	 bl _ZN7TimeoutC1Ev
 1111 001e 40F20005 	 movw r5,#:lower16:.LANCHOR6
 1112 0022 C0F20005 	 movt r5,#:upper16:.LANCHOR6
 1113 0026 9DE80F00 	 ldmia sp,{r0,r1,r2,r3}
 1114 002a 85E80F00 	 stmia r5,{r0,r1,r2,r3}
 730:src/MightyBoard/Motherboard/Host.cc **** 	print_time_hours = 0;
 1115              	 .loc 1 730 0
 1116 002e 40F20003 	 movw r3,#:lower16:.LANCHOR7
 1117 0032 C0F20003 	 movt r3,#:upper16:.LANCHOR7
 1118 0036 4FF00002 	 mov r2,#0
 1119 003a 1A70     	 strb r2,[r3,#0]
 731:src/MightyBoard/Motherboard/Host.cc **** }
 1120              	 .loc 1 731 0
 1121 003c 05B0     	 add sp,sp,#20
 1122 003e 30BD     	 pop {r4,r5,pc}
 1123              	 .cfi_endproc
 1124              	.LFE149:
 1126              	 .section .text._ZN4host9stopBuildEv,"ax",%progbits
 1127              	 .align 2
 1128              	 .global _ZN4host9stopBuildEv
 1129              	 .thumb
 1130              	 .thumb_func
 1132              	_ZN4host9stopBuildEv:
 1133              	.LFB146:
 690:src/MightyBoard/Motherboard/Host.cc **** void stopBuild() {
 1134              	 .loc 1 690 0
 1135              	 .cfi_startproc
 1136              	 
 1137              	 
 1138 0000 08B5     	 push {r3,lr}
 1139              	.LCFI16:
 1140              	 .cfi_def_cfa_offset 8
 1141              	 .cfi_offset 14,-4
 1142              	 .cfi_offset 3,-8
 692:src/MightyBoard/Motherboard/Host.cc **** 	if(currentState == HOST_STATE_BUILDING)
 1143              	 .loc 1 692 0
 1144 0002 40F20003 	 movw r3,#:lower16:.LANCHOR0
 1145 0006 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 1146 000a 1B78     	 ldrb r3,[r3,#0]
 1147 000c 012B     	 cmp r3,#1
 1148 000e 17D1     	 bne .L68
 694:src/MightyBoard/Motherboard/Host.cc **** 		currentState = HOST_STATE_CANCEL_BUILD;
 1149              	 .loc 1 694 0
 1150 0010 40F20003 	 movw r3,#:lower16:.LANCHOR0
 1151 0014 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 1152 0018 4FF00402 	 mov r2,#4
 1153 001c 1A70     	 strb r2,[r3,#0]
 695:src/MightyBoard/Motherboard/Host.cc **** 		cancel_timeout.start(1000000); //look for commands from repG for one second before resetting
 1154              	 .loc 1 695 0
 1155 001e 40F20000 	 movw r0,#:lower16:.LANCHOR10
 1156 0022 C0F20000 	 movt r0,#:upper16:.LANCHOR10
 1157 0026 44F24021 	 movw r1,#16960
 1158 002a C0F20F01 	 movt r1,15
 1159 002e FFF7FEFF 	 bl _ZN7Timeout5startEm
 696:src/MightyBoard/Motherboard/Host.cc **** 		cancelBuild = true;
 1160              	 .loc 1 696 0
 1161 0032 40F20003 	 movw r3,#:lower16:.LANCHOR1
 1162 0036 C0F20003 	 movt r3,#:upper16:.LANCHOR1
 1163 003a 4FF00102 	 mov r2,#1
 1164 003e 1A70     	 strb r2,[r3,#0]
 1165              	.L68:
 698:src/MightyBoard/Motherboard/Host.cc **** 	last_print_line = command::getLineNumber();
 1166              	 .loc 1 698 0
 1167 0040 FFF7FEFF 	 bl _ZN7command13getLineNumberEv
 1168 0044 40F20003 	 movw r3,#:lower16:.LANCHOR11
 1169 0048 C0F20003 	 movt r3,#:upper16:.LANCHOR11
 1170 004c 1860     	 str r0,[r3,#0]
 699:src/MightyBoard/Motherboard/Host.cc **** 	stopPrintTime();
 1171              	 .loc 1 699 0
 1172 004e FFF7FEFF 	 bl _ZN4host13stopPrintTimeEv
 700:src/MightyBoard/Motherboard/Host.cc **** 	do_host_reset = true; // indicate reset after response has been sent
 1173              	 .loc 1 700 0
 1174 0052 40F20003 	 movw r3,#:lower16:.LANCHOR12
 1175 0056 C0F20003 	 movt r3,#:upper16:.LANCHOR12
 1176 005a 4FF00102 	 mov r2,#1
 1177 005e 1A70     	 strb r2,[r3,#0]
 701:src/MightyBoard/Motherboard/Host.cc **** 	buildState = BUILD_CANCELED;
 1178              	 .loc 1 701 0
 1179 0060 40F20003 	 movw r3,#:lower16:.LANCHOR5
 1180 0064 C0F20003 	 movt r3,#:upper16:.LANCHOR5
 1181 0068 4FF00402 	 mov r2,#4
 1182 006c 1A70     	 strb r2,[r3,#0]
 702:src/MightyBoard/Motherboard/Host.cc **** }
 1183              	 .loc 1 702 0
 1184 006e 08BD     	 pop {r3,pc}
 1185              	 .cfi_endproc
 1186              	.LFE146:
 1188              	 .section .text._ZN4host27handleBuildStopNotificationEh,"ax",%progbits
 1189              	 .align 2
 1190              	 .global _ZN4host27handleBuildStopNotificationEh
 1191              	 .thumb
 1192              	 .thumb_func
 1194              	_ZN4host27handleBuildStopNotificationEh:
 1195              	.LFB137:
 505:src/MightyBoard/Motherboard/Host.cc **** void handleBuildStopNotification(uint8_t stopFlags) {
 1196              	 .loc 1 505 0
 1197              	 .cfi_startproc
 1198              	 
 1199              	 
 1200              	.LVL81:
 1201 0000 08B5     	 push {r3,lr}
 1202              	.LCFI17:
 1203              	 .cfi_def_cfa_offset 8
 1204              	 .cfi_offset 14,-4
 1205              	 .cfi_offset 3,-8
 1206              	.LBB242:
 508:src/MightyBoard/Motherboard/Host.cc **** 	stopPrintTime();
 1207              	 .loc 1 508 0
 1208 0002 FFF7FEFF 	 bl _ZN4host13stopPrintTimeEv
 1209              	.LVL82:
 509:src/MightyBoard/Motherboard/Host.cc **** 	last_print_line = command::getLineNumber();
 1210              	 .loc 1 509 0
 1211 0006 FFF7FEFF 	 bl _ZN7command13getLineNumberEv
 1212 000a 40F20003 	 movw r3,#:lower16:.LANCHOR11
 1213 000e C0F20003 	 movt r3,#:upper16:.LANCHOR11
 1214 0012 1860     	 str r0,[r3,#0]
 510:src/MightyBoard/Motherboard/Host.cc **** 	buildState = BUILD_FINISHED_NORMALLY;
 1215              	 .loc 1 510 0
 1216 0014 40F20003 	 movw r3,#:lower16:.LANCHOR5
 1217 0018 C0F20003 	 movt r3,#:upper16:.LANCHOR5
 1218 001c 4FF00202 	 mov r2,#2
 1219 0020 1A70     	 strb r2,[r3,#0]
 511:src/MightyBoard/Motherboard/Host.cc **** 	currentState = HOST_STATE_READY;
 1220              	 .loc 1 511 0
 1221 0022 40F20003 	 movw r3,#:lower16:.LANCHOR0
 1222 0026 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 1223 002a 4FF00002 	 mov r2,#0
 1224 002e 1A70     	 strb r2,[r3,#0]
 1225              	.LBE242:
 512:src/MightyBoard/Motherboard/Host.cc **** }
 1226              	 .loc 1 512 0
 1227 0030 08BD     	 pop {r3,pc}
 1228              	 .cfi_endproc
 1229              	.LFE137:
 1231 0032 00BF     	 .section .text._ZN4host26processExtruderQueryPacketERK8InPacketR9OutPacket,"ax",%progbits
 1232              	 .align 2
 1233              	 .global _ZN4host26processExtruderQueryPacketERK8InPacketR9OutPacket
 1234              	 .thumb
 1235              	 .thumb_func
 1237              	_ZN4host26processExtruderQueryPacketERK8InPacketR9OutPacket:
 1238              	.LFB152:
 749:src/MightyBoard/Motherboard/Host.cc **** 
 750:src/MightyBoard/Motherboard/Host.cc ****     // legacy tool / motherboard breakout of query commands
 751:src/MightyBoard/Motherboard/Host.cc **** bool processExtruderQueryPacket(const InPacket& from_host, OutPacket& to_host) {
 1239              	 .loc 1 751 0
 1240              	 .cfi_startproc
 1241              	 
 1242              	 
 1243              	.LVL83:
 1244 0000 70B5     	 push {r4,r5,r6,lr}
 1245              	.LCFI18:
 1246              	 .cfi_def_cfa_offset 16
 1247              	 .cfi_offset 14,-4
 1248              	 .cfi_offset 6,-8
 1249              	 .cfi_offset 5,-12
 1250              	 .cfi_offset 4,-16
 1251 0002 0446     	 mov r4,r0
 1252 0004 0D46     	 mov r5,r1
 1253              	.LVL84:
 1254              	.LBB243:
 1255              	.LBB244:
 1256              	.LBB245:
 1257              	.LBB246:
 1258              	 .loc 2 97 0
 1259 0006 0378     	 ldrb r3,[r0,#0]
 1260              	.LBE246:
 1261              	.LBE245:
 752:src/MightyBoard/Motherboard/Host.cc **** 	Motherboard& board = Motherboard::getBoard();
 753:src/MightyBoard/Motherboard/Host.cc **** 	if (from_host.getLength() >= 1) {
 1262              	 .loc 1 753 0
 1263 0008 002B     	 cmp r3,#0
 1264 000a 00F01C81 	 beq .L92
 1265              	.LBB247:
 754:src/MightyBoard/Motherboard/Host.cc **** 			
 755:src/MightyBoard/Motherboard/Host.cc ****         uint8_t	id = from_host.read8(1);
 1266              	 .loc 1 755 0
 1267 000e 4FF00101 	 mov r1,#1
 1268              	.LVL85:
 1269 0012 FFF7FEFF 	 bl _ZNK6Packet5read8Eh
 1270              	.LVL86:
 1271 0016 0646     	 mov r6,r0
 1272              	.LVL87:
 756:src/MightyBoard/Motherboard/Host.cc **** 		uint8_t command = from_host.read8(2);
 1273              	 .loc 1 756 0
 1274 0018 2046     	 mov r0,r4
 1275              	.LVL88:
 1276 001a 4FF00201 	 mov r1,#2
 1277 001e FFF7FEFF 	 bl _ZNK6Packet5read8Eh
 1278              	.LVL89:
 757:src/MightyBoard/Motherboard/Host.cc **** 		// All commands are query commands.	
 758:src/MightyBoard/Motherboard/Host.cc **** 		switch (command) {
 1279              	 .loc 1 758 0
 1280 0022 2528     	 cmp r0,#37
 1281 0024 00F21281 	 bhi .L93
 1282 0028 DFE810F0 	 tbh [pc,r0,lsl#1]
 1283              	.L81:
 1284 002c 2600     	 .2byte (.L72-.L81)/2
 1285 002e 1001     	 .2byte (.L93-.L81)/2
 1286 0030 3300     	 .2byte (.L73-.L81)/2
 1287 0032 1001     	 .2byte (.L93-.L81)/2
 1288 0034 1001     	 .2byte (.L93-.L81)/2
 1289 0036 1001     	 .2byte (.L93-.L81)/2
 1290 0038 1001     	 .2byte (.L93-.L81)/2
 1291 003a 1001     	 .2byte (.L93-.L81)/2
 1292 003c 1001     	 .2byte (.L93-.L81)/2
 1293 003e 1001     	 .2byte (.L93-.L81)/2
 1294 0040 1001     	 .2byte (.L93-.L81)/2
 1295 0042 1001     	 .2byte (.L93-.L81)/2
 1296 0044 1001     	 .2byte (.L93-.L81)/2
 1297 0046 1001     	 .2byte (.L93-.L81)/2
 1298 0048 1001     	 .2byte (.L93-.L81)/2
 1299 004a 1001     	 .2byte (.L93-.L81)/2
 1300 004c 1001     	 .2byte (.L93-.L81)/2
 1301 004e 1001     	 .2byte (.L93-.L81)/2
 1302 0050 1001     	 .2byte (.L93-.L81)/2
 1303 0052 1001     	 .2byte (.L93-.L81)/2
 1304 0054 1001     	 .2byte (.L93-.L81)/2
 1305 0056 1001     	 .2byte (.L93-.L81)/2
 1306 0058 4900     	 .2byte (.L74-.L81)/2
 1307 005a 1001     	 .2byte (.L93-.L81)/2
 1308 005c 1001     	 .2byte (.L93-.L81)/2
 1309 005e 1001     	 .2byte (.L93-.L81)/2
 1310 0060 1001     	 .2byte (.L93-.L81)/2
 1311 0062 1001     	 .2byte (.L93-.L81)/2
 1312 0064 1001     	 .2byte (.L93-.L81)/2
 1313 0066 1001     	 .2byte (.L93-.L81)/2
 1314 0068 5F00     	 .2byte (.L75-.L81)/2
 1315 006a 1001     	 .2byte (.L93-.L81)/2
 1316 006c 6E00     	 .2byte (.L76-.L81)/2
 1317 006e 8400     	 .2byte (.L77-.L81)/2
 1318 0070 1001     	 .2byte (.L93-.L81)/2
 1319 0072 9300     	 .2byte (.L78-.L81)/2
 1320 0074 A200     	 .2byte (.L79-.L81)/2
 1321 0076 D400     	 .2byte (.L80-.L81)/2
 1322              	.L72:
 759:src/MightyBoard/Motherboard/Host.cc **** 		case SLAVE_CMD_VERSION:
 760:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(RC_OK);
 1323              	 .loc 1 760 0
 1324 0078 2846     	 mov r0,r5
 1325              	.LVL90:
 1326 007a 4FF08101 	 mov r1,#129
 1327 007e FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 761:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(firmware_version);
 1328              	 .loc 1 761 0
 1329 0082 2846     	 mov r0,r5
 1330 0084 40F22B21 	 movw r1,#555
 1331 0088 FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 762:src/MightyBoard/Motherboard/Host.cc **** 			return true;
 1332              	 .loc 1 762 0
 1333 008c 4FF00100 	 mov r0,#1
 1334 0090 70BD     	 pop {r4,r5,r6,pc}
 1335              	.LVL91:
 1336              	.L73:
 763:src/MightyBoard/Motherboard/Host.cc **** 		case SLAVE_CMD_GET_TEMP:
 764:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(RC_OK);
 1337              	 .loc 1 764 0
 1338 0092 2846     	 mov r0,r5
 1339              	.LVL92:
 1340 0094 4FF08101 	 mov r1,#129
 1341 0098 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 1342              	.LVL93:
 1343              	.LBB248:
 1344              	.LBB249:
 1345              	 .file 4 "src/MightyBoard/Motherboard/Motherboard.hh"
   1:src/MightyBoard/Motherboard/Motherboard.hh **** /*
   2:src/MightyBoard/Motherboard/Motherboard.hh ****  * Copyright 2010 by Adam Mayer	 <adam@makerbot.com>
   3:src/MightyBoard/Motherboard/Motherboard.hh ****  *
   4:src/MightyBoard/Motherboard/Motherboard.hh ****  * This program is free software: you can redistribute it and/or modify
   5:src/MightyBoard/Motherboard/Motherboard.hh ****  * it under the terms of the GNU General Public License as published by
   6:src/MightyBoard/Motherboard/Motherboard.hh ****  * the Free Software Foundation, either version 3 of the License, or
   7:src/MightyBoard/Motherboard/Motherboard.hh ****  * (at your option) any later version.
   8:src/MightyBoard/Motherboard/Motherboard.hh ****  *
   9:src/MightyBoard/Motherboard/Motherboard.hh ****  * This program is distributed in the hope that it will be useful,
  10:src/MightyBoard/Motherboard/Motherboard.hh ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:src/MightyBoard/Motherboard/Motherboard.hh ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:src/MightyBoard/Motherboard/Motherboard.hh ****  * GNU General Public License for more details.
  13:src/MightyBoard/Motherboard/Motherboard.hh ****  *
  14:src/MightyBoard/Motherboard/Motherboard.hh ****  * You should have received a copy of the GNU General Public License
  15:src/MightyBoard/Motherboard/Motherboard.hh ****  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  16:src/MightyBoard/Motherboard/Motherboard.hh ****  */
  17:src/MightyBoard/Motherboard/Motherboard.hh **** 
  18:src/MightyBoard/Motherboard/Motherboard.hh **** #ifndef BOARDS_MB40_MOTHERBOARD_HH_
  19:src/MightyBoard/Motherboard/Motherboard.hh **** #define BOARDS_MB40_MOTHERBOARD_HH_
  20:src/MightyBoard/Motherboard/Motherboard.hh **** 
  21:src/MightyBoard/Motherboard/Motherboard.hh **** #include "UART.hh"
  22:src/MightyBoard/Motherboard/Motherboard.hh **** #include "DigiPots.hh"
  23:src/MightyBoard/Motherboard/Motherboard.hh **** #include "Types.hh"
  24:src/MightyBoard/Motherboard/Motherboard.hh **** #include "PSU.hh"
  25:src/MightyBoard/Motherboard/Motherboard.hh **** #include "Configuration.hh"
  26:src/MightyBoard/Motherboard/Motherboard.hh **** #include "Timeout.hh"
  27:src/MightyBoard/Motherboard/Motherboard.hh **** //#include "Menu.hh"
  28:src/MightyBoard/Motherboard/Motherboard.hh **** //#include "InterfaceBoard.hh"
  29:src/MightyBoard/Motherboard/Motherboard.hh **** //#include "LiquidCrystalSerial.hh"
  30:src/MightyBoard/Motherboard/Motherboard.hh **** //#include "ButtonArray.hh"
  31:src/MightyBoard/Motherboard/Motherboard.hh **** #include "Thermistor.hh"
  32:src/MightyBoard/Motherboard/Motherboard.hh **** #include "HeatingElement.hh"
  33:src/MightyBoard/Motherboard/Motherboard.hh **** #include "Heater.hh"
  34:src/MightyBoard/Motherboard/Motherboard.hh **** #include "ExtruderBoard.hh"
  35:src/MightyBoard/Motherboard/Motherboard.hh **** #include "Cutoff.hh"
  36:src/MightyBoard/Motherboard/Motherboard.hh **** 
  37:src/MightyBoard/Motherboard/Motherboard.hh **** enum status_states{
  38:src/MightyBoard/Motherboard/Motherboard.hh **** 	STATUS_NONE = 0,
  39:src/MightyBoard/Motherboard/Motherboard.hh **** 	STATUS_HEAT_INACTIVE_SHUTDOWN = 0x40
  40:src/MightyBoard/Motherboard/Motherboard.hh **** };
  41:src/MightyBoard/Motherboard/Motherboard.hh **** 
  42:src/MightyBoard/Motherboard/Motherboard.hh **** 
  43:src/MightyBoard/Motherboard/Motherboard.hh **** /// Build platform heating element on v34 Extruder controller
  44:src/MightyBoard/Motherboard/Motherboard.hh **** /// \ingroup ECv34
  45:src/MightyBoard/Motherboard/Motherboard.hh **** class BuildPlatformHeatingElement : public HeatingElement {
  46:src/MightyBoard/Motherboard/Motherboard.hh **** public:
  47:src/MightyBoard/Motherboard/Motherboard.hh **** 	void setHeatingElement(uint8_t value);
  48:src/MightyBoard/Motherboard/Motherboard.hh **** };
  49:src/MightyBoard/Motherboard/Motherboard.hh **** 
  50:src/MightyBoard/Motherboard/Motherboard.hh **** /// Main class for Motherboard version 4.0+ (Gen4 electronics)
  51:src/MightyBoard/Motherboard/Motherboard.hh **** /// \ingroup HardwareLibraries
  52:src/MightyBoard/Motherboard/Motherboard.hh **** /// \ingroup MBv40
  53:src/MightyBoard/Motherboard/Motherboard.hh **** class Motherboard {
  54:src/MightyBoard/Motherboard/Motherboard.hh **** private:
  55:src/MightyBoard/Motherboard/Motherboard.hh ****         // TODO: Declare this in main, drop the singleton.
  56:src/MightyBoard/Motherboard/Motherboard.hh ****         /// Static instance of the motherboard
  57:src/MightyBoard/Motherboard/Motherboard.hh ****         static Motherboard motherboard;
  58:src/MightyBoard/Motherboard/Motherboard.hh **** 
  59:src/MightyBoard/Motherboard/Motherboard.hh **** public:
  60:src/MightyBoard/Motherboard/Motherboard.hh ****         /// Get the motherboard instance.
  61:src/MightyBoard/Motherboard/Motherboard.hh ****         static Motherboard& getBoard() { return motherboard; }
  62:src/MightyBoard/Motherboard/Motherboard.hh ****        ExtruderBoard& getExtruderBoard(uint8_t id) { if(id == 1){ return Extruder_Two;} else  { ret
 1346              	 .loc 4 62 0
 1347 009c 7A4B     	 ldr r3,.L100
 1348 009e A3F1E000 	 sub r0,r3,#224
 1349 00a2 012E     	 cmp r6,#1
 1350 00a4 08BF     	 it eq
 1351 00a6 1846     	 moveq r0,r3
 1352              	.LVL94:
 1353              	.LBE249:
 1354              	.LBE248:
 765:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(board.getExtruderBoard(id).getExtruderHeater().get_current_temperature());
 1355              	 .loc 1 765 0
 1356 00a8 00F12800 	 add r0,r0,#40
 1357              	.LVL95:
 1358 00ac FFF7FEFF 	 bl _ZN6Heater23get_current_temperatureEv
 1359              	.LVL96:
 1360 00b0 81B2     	 uxth r1,r0
 1361 00b2 2846     	 mov r0,r5
 1362 00b4 FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 766:src/MightyBoard/Motherboard/Host.cc **** 			return true;
 1363              	 .loc 1 766 0
 1364 00b8 4FF00100 	 mov r0,#1
 1365 00bc 70BD     	 pop {r4,r5,r6,pc}
 1366              	.LVL97:
 1367              	.L74:
 767:src/MightyBoard/Motherboard/Host.cc **** 		case SLAVE_CMD_IS_TOOL_READY:
 768:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(RC_OK);
 1368              	 .loc 1 768 0
 1369 00be 2846     	 mov r0,r5
 1370              	.LVL98:
 1371 00c0 4FF08101 	 mov r1,#129
 1372 00c4 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 1373              	.LVL99:
 1374              	.LBB250:
 1375              	.LBB251:
 1376              	 .loc 4 62 0
 1377 00c8 6F4B     	 ldr r3,.L100
 1378 00ca A3F1E000 	 sub r0,r3,#224
 1379 00ce 012E     	 cmp r6,#1
 1380 00d0 08BF     	 it eq
 1381 00d2 1846     	 moveq r0,r3
 1382              	.LVL100:
 1383              	.LBE251:
 1384              	.LBE250:
 769:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(board.getExtruderBoard(id).getExtruderHeater().has_reached_target_temperature()?
 1385              	 .loc 1 769 0
 1386 00d4 00F12800 	 add r0,r0,#40
 1387              	.LVL101:
 1388 00d8 FFF7FEFF 	 bl _ZN6Heater30has_reached_target_temperatureEv
 1389              	.LVL102:
 1390 00dc 0146     	 mov r1,r0
 1391 00de 2846     	 mov r0,r5
 1392 00e0 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 770:src/MightyBoard/Motherboard/Host.cc **** 			return true;
 1393              	 .loc 1 770 0
 1394 00e4 4FF00100 	 mov r0,#1
 1395 00e8 70BD     	 pop {r4,r5,r6,pc}
 1396              	.LVL103:
 1397              	.L75:
 771:src/MightyBoard/Motherboard/Host.cc **** 		case SLAVE_CMD_GET_PLATFORM_TEMP:
 772:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(RC_OK);
 1398              	 .loc 1 772 0
 1399 00ea 2846     	 mov r0,r5
 1400              	.LVL104:
 1401 00ec 4FF08101 	 mov r1,#129
 1402 00f0 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 1403              	.LVL105:
 773:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(board.getPlatformHeater().get_current_temperature());
 1404              	 .loc 1 773 0
 1405 00f4 6548     	 ldr r0,.L100+4
 1406 00f6 FFF7FEFF 	 bl _ZN6Heater23get_current_temperatureEv
 1407 00fa 81B2     	 uxth r1,r0
 1408 00fc 2846     	 mov r0,r5
 1409 00fe FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 774:src/MightyBoard/Motherboard/Host.cc **** 			return true;
 1410              	 .loc 1 774 0
 1411 0102 4FF00100 	 mov r0,#1
 1412 0106 70BD     	 pop {r4,r5,r6,pc}
 1413              	.LVL106:
 1414              	.L76:
 775:src/MightyBoard/Motherboard/Host.cc **** 		case SLAVE_CMD_GET_SP:
 776:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(RC_OK);
 1415              	 .loc 1 776 0
 1416 0108 2846     	 mov r0,r5
 1417              	.LVL107:
 1418 010a 4FF08101 	 mov r1,#129
 1419 010e FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 1420              	.LVL108:
 1421              	.LBB252:
 1422              	.LBB253:
 1423              	 .loc 4 62 0
 1424 0112 5D4B     	 ldr r3,.L100
 1425 0114 A3F1E000 	 sub r0,r3,#224
 1426 0118 012E     	 cmp r6,#1
 1427 011a 08BF     	 it eq
 1428 011c 1846     	 moveq r0,r3
 1429              	.LVL109:
 1430              	.LBE253:
 1431              	.LBE252:
 777:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(board.getExtruderBoard(id).getExtruderHeater().get_set_temperature());
 1432              	 .loc 1 777 0
 1433 011e 00F12800 	 add r0,r0,#40
 1434              	.LVL110:
 1435 0122 FFF7FEFF 	 bl _ZN6Heater19get_set_temperatureEv
 1436              	.LVL111:
 1437 0126 81B2     	 uxth r1,r0
 1438 0128 2846     	 mov r0,r5
 1439 012a FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 778:src/MightyBoard/Motherboard/Host.cc **** 			return true;
 1440              	 .loc 1 778 0
 1441 012e 4FF00100 	 mov r0,#1
 1442 0132 70BD     	 pop {r4,r5,r6,pc}
 1443              	.LVL112:
 1444              	.L77:
 779:src/MightyBoard/Motherboard/Host.cc **** 		case SLAVE_CMD_GET_PLATFORM_SP:
 780:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(RC_OK);
 1445              	 .loc 1 780 0
 1446 0134 2846     	 mov r0,r5
 1447              	.LVL113:
 1448 0136 4FF08101 	 mov r1,#129
 1449 013a FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 1450              	.LVL114:
 781:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(board.getPlatformHeater().get_set_temperature());
 1451              	 .loc 1 781 0
 1452 013e 5348     	 ldr r0,.L100+4
 1453 0140 FFF7FEFF 	 bl _ZN6Heater19get_set_temperatureEv
 1454 0144 81B2     	 uxth r1,r0
 1455 0146 2846     	 mov r0,r5
 1456 0148 FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 782:src/MightyBoard/Motherboard/Host.cc **** 			return true;
 1457              	 .loc 1 782 0
 1458 014c 4FF00100 	 mov r0,#1
 1459 0150 70BD     	 pop {r4,r5,r6,pc}
 1460              	.LVL115:
 1461              	.L78:
 783:src/MightyBoard/Motherboard/Host.cc **** 		case SLAVE_CMD_IS_PLATFORM_READY:
 784:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(RC_OK);
 1462              	 .loc 1 784 0
 1463 0152 2846     	 mov r0,r5
 1464              	.LVL116:
 1465 0154 4FF08101 	 mov r1,#129
 1466 0158 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 1467              	.LVL117:
 785:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(board.getPlatformHeater().has_reached_target_temperature()?1:0);
 1468              	 .loc 1 785 0
 1469 015c 4B48     	 ldr r0,.L100+4
 1470 015e FFF7FEFF 	 bl _ZN6Heater30has_reached_target_temperatureEv
 1471 0162 0146     	 mov r1,r0
 1472 0164 2846     	 mov r0,r5
 1473 0166 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 786:src/MightyBoard/Motherboard/Host.cc **** 			return true;
 1474              	 .loc 1 786 0
 1475 016a 4FF00100 	 mov r0,#1
 1476 016e 70BD     	 pop {r4,r5,r6,pc}
 1477              	.LVL118:
 1478              	.L79:
 787:src/MightyBoard/Motherboard/Host.cc **** 		case SLAVE_CMD_GET_TOOL_STATUS:
 788:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(RC_OK);
 1479              	 .loc 1 788 0
 1480 0170 2846     	 mov r0,r5
 1481              	.LVL119:
 1482 0172 4FF08101 	 mov r1,#129
 1483 0176 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 1484              	.LVL120:
 1485              	.LBB254:
 1486              	.LBB255:
 1487              	 .loc 4 62 0
 1488 017a 434B     	 ldr r3,.L100
 1489 017c A3F1E000 	 sub r0,r3,#224
 1490 0180 012E     	 cmp r6,#1
 1491 0182 08BF     	 it eq
 1492 0184 1846     	 moveq r0,r3
 1493              	.LVL121:
 1494              	.LBE255:
 1495              	.LBE254:
 789:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8((board.getExtruderBoard(id).getExtruderHeater().has_failed()?128:0)
 1496              	 .loc 1 789 0
 1497 0186 00F12800 	 add r0,r0,#40
 1498              	.LVL122:
 1499 018a FFF7FEFF 	 bl _ZN6Heater10has_failedEv
 1500              	.LVL123:
 790:src/MightyBoard/Motherboard/Host.cc **** 							| (board.getPlatformHeater().has_failed()?64:0)
 791:src/MightyBoard/Motherboard/Host.cc **** 							| (board.getExtruderBoard(id).getExtruderHeater().GetFailMode())
 792:src/MightyBoard/Motherboard/Host.cc **** 							| (board.getExtruderBoard(id).getExtruderHeater().has_reached_target_temperature()?1:0));
 1501              	 .loc 1 792 0
 1502 018e 0028     	 cmp r0,#0
 1503 0190 14BF     	 ite ne
 1504 0192 8024     	 movne r4,#128
 1505 0194 0024     	 moveq r4,#0
 1506              	.LVL124:
 790:src/MightyBoard/Motherboard/Host.cc **** 							| (board.getPlatformHeater().has_failed()?64:0)
 1507              	 .loc 1 790 0
 1508 0196 3D48     	 ldr r0,.L100+4
 1509 0198 FFF7FEFF 	 bl _ZN6Heater10has_failedEv
 1510              	 .loc 1 792 0
 1511 019c 0028     	 cmp r0,#0
 1512 019e 14BF     	 ite ne
 1513 01a0 4020     	 movne r0,#64
 1514 01a2 0020     	 moveq r0,#0
 1515 01a4 0443     	 orrs r4,r4,r0
 1516              	.LVL125:
 1517              	.LBB256:
 1518              	.LBB257:
 1519              	 .loc 4 62 0
 1520 01a6 012E     	 cmp r6,#1
 1521 01a8 53D1     	 bne .L88
 1522              	.LVL126:
 1523              	.LBE257:
 1524              	.LBE256:
 791:src/MightyBoard/Motherboard/Host.cc **** 							| (board.getExtruderBoard(id).getExtruderHeater().GetFailMode())
 1525              	 .loc 1 791 0
 1526 01aa 394E     	 ldr r6,.L100+8
 1527              	.LVL127:
 1528 01ac 3046     	 mov r0,r6
 1529 01ae FFF7FEFF 	 bl _ZN6Heater11GetFailModeEv
 1530              	 .loc 1 792 0
 1531 01b2 0443     	 orrs r4,r4,r0
 1532 01b4 E4B2     	 uxtb r4,r4
 1533              	.LVL128:
 1534              	 .loc 4 62 0
 1535 01b6 A6F12800 	 sub r0,r6,#40
 1536              	.LVL129:
 1537              	.L90:
 1538              	 .loc 1 792 0
 1539 01ba 00F12800 	 add r0,r0,#40
 1540              	.LVL130:
 1541 01be FFF7FEFF 	 bl _ZN6Heater30has_reached_target_temperatureEv
 1542              	.LVL131:
 1543 01c2 40EA0401 	 orr r1,r0,r4
 1544 01c6 2846     	 mov r0,r5
 1545 01c8 C9B2     	 uxtb r1,r1
 1546 01ca FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 793:src/MightyBoard/Motherboard/Host.cc **** 			return true;
 1547              	 .loc 1 793 0
 1548 01ce 4FF00100 	 mov r0,#1
 1549 01d2 70BD     	 pop {r4,r5,r6,pc}
 1550              	.LVL132:
 1551              	.L80:
 794:src/MightyBoard/Motherboard/Host.cc **** 		case SLAVE_CMD_GET_PID_STATE:
 795:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append8(RC_OK);
 1552              	 .loc 1 795 0
 1553 01d4 2846     	 mov r0,r5
 1554              	.LVL133:
 1555 01d6 4FF08101 	 mov r1,#129
 1556 01da FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 1557              	.LVL134:
 1558              	.LBB258:
 1559              	.LBB259:
 1560              	 .loc 4 62 0
 1561 01de 012E     	 cmp r6,#1
 1562 01e0 40D1     	 bne .L89
 1563              	.LVL135:
 1564              	.LBE259:
 1565              	.LBE258:
 796:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(board.getExtruderBoard(id).getExtruderHeater().getPIDErrorTerm());
 1566              	 .loc 1 796 0
 1567 01e2 2B4C     	 ldr r4,.L100+8
 1568              	.LVL136:
 1569 01e4 2046     	 mov r0,r4
 1570 01e6 FFF7FEFF 	 bl _ZN6Heater15getPIDErrorTermEv
 1571 01ea 81B2     	 uxth r1,r0
 1572 01ec 2846     	 mov r0,r5
 1573 01ee FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 1574              	.LVL137:
 797:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(board.getExtruderBoard(id).getExtruderHeater().getPIDDeltaTerm());
 1575              	 .loc 1 797 0
 1576 01f2 2046     	 mov r0,r4
 1577 01f4 FFF7FEFF 	 bl _ZN6Heater15getPIDDeltaTermEv
 1578 01f8 81B2     	 uxth r1,r0
 1579 01fa 2846     	 mov r0,r5
 1580 01fc FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 1581              	.LVL138:
 1582              	 .loc 4 62 0
 1583 0200 A4F12800 	 sub r0,r4,#40
 1584              	.LVL139:
 1585              	.L91:
 798:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(board.getExtruderBoard(id).getExtruderHeater().getPIDLastOutput());
 1586              	 .loc 1 798 0
 1587 0204 00F12800 	 add r0,r0,#40
 1588              	.LVL140:
 1589 0208 FFF7FEFF 	 bl _ZN6Heater16getPIDLastOutputEv
 1590              	.LVL141:
 1591 020c 81B2     	 uxth r1,r0
 1592 020e 2846     	 mov r0,r5
 1593 0210 FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 1594              	.LVL142:
 799:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(board.getPlatformHeater().getPIDErrorTerm());
 1595              	 .loc 1 799 0
 1596 0214 1D4C     	 ldr r4,.L100+4
 1597 0216 2046     	 mov r0,r4
 1598 0218 FFF7FEFF 	 bl _ZN6Heater15getPIDErrorTermEv
 1599 021c 81B2     	 uxth r1,r0
 1600 021e 2846     	 mov r0,r5
 1601 0220 FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 1602              	.LVL143:
 800:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(board.getPlatformHeater().getPIDDeltaTerm());
 1603              	 .loc 1 800 0
 1604 0224 2046     	 mov r0,r4
 1605 0226 FFF7FEFF 	 bl _ZN6Heater15getPIDDeltaTermEv
 1606 022a 81B2     	 uxth r1,r0
 1607 022c 2846     	 mov r0,r5
 1608 022e FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 1609              	.LVL144:
 801:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(board.getPlatformHeater().getPIDLastOutput());
 1610              	 .loc 1 801 0
 1611 0232 2046     	 mov r0,r4
 1612 0234 FFF7FEFF 	 bl _ZN6Heater16getPIDLastOutputEv
 1613 0238 81B2     	 uxth r1,r0
 1614 023a 2846     	 mov r0,r5
 1615 023c FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 802:src/MightyBoard/Motherboard/Host.cc **** 			return true;
 1616              	 .loc 1 802 0
 1617 0240 4FF00100 	 mov r0,#1
 1618 0244 70BD     	 pop {r4,r5,r6,pc}
 1619              	.LVL145:
 1620              	.L92:
 1621              	.LBE247:
 803:src/MightyBoard/Motherboard/Host.cc **** 		}
 804:src/MightyBoard/Motherboard/Host.cc **** 	}
 805:src/MightyBoard/Motherboard/Host.cc **** 	return false;
 1622              	 .loc 1 805 0
 1623 0246 4FF00000 	 mov r0,#0
 1624              	.LVL146:
 1625 024a 70BD     	 pop {r4,r5,r6,pc}
 1626              	.LVL147:
 1627              	.L93:
 1628              	.LBB260:
 1629 024c 4FF00000 	 mov r0,#0
 1630              	.LVL148:
 1631              	.LBE260:
 1632              	.LBE244:
 1633              	.LBE243:
 806:src/MightyBoard/Motherboard/Host.cc **** }
 1634              	 .loc 1 806 0
 1635 0250 70BD     	 pop {r4,r5,r6,pc}
 1636              	.LVL149:
 1637              	.L88:
 1638              	.LBB263:
 1639              	.LBB262:
 1640              	.LBB261:
 791:src/MightyBoard/Motherboard/Host.cc **** 							| (board.getExtruderBoard(id).getExtruderHeater().GetFailMode())
 1641              	 .loc 1 791 0
 1642 0252 104E     	 ldr r6,.L100+12
 1643              	.LVL150:
 1644 0254 3046     	 mov r0,r6
 1645 0256 FFF7FEFF 	 bl _ZN6Heater11GetFailModeEv
 792:src/MightyBoard/Motherboard/Host.cc **** 							| (board.getExtruderBoard(id).getExtruderHeater().has_reached_target_temperature()?1:0));
 1646              	 .loc 1 792 0
 1647 025a 0443     	 orrs r4,r4,r0
 1648 025c E4B2     	 uxtb r4,r4
 1649              	.LVL151:
 1650              	 .loc 4 62 0
 1651 025e A6F12800 	 sub r0,r6,#40
 1652 0262 AAE7     	 b .L90
 1653              	.LVL152:
 1654              	.L89:
 796:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(board.getExtruderBoard(id).getExtruderHeater().getPIDErrorTerm());
 1655              	 .loc 1 796 0
 1656 0264 0B4C     	 ldr r4,.L100+12
 1657              	.LVL153:
 1658 0266 2046     	 mov r0,r4
 1659 0268 FFF7FEFF 	 bl _ZN6Heater15getPIDErrorTermEv
 1660 026c 81B2     	 uxth r1,r0
 1661 026e 2846     	 mov r0,r5
 1662 0270 FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 1663              	.LVL154:
 797:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append16(board.getExtruderBoard(id).getExtruderHeater().getPIDDeltaTerm());
 1664              	 .loc 1 797 0
 1665 0274 2046     	 mov r0,r4
 1666 0276 FFF7FEFF 	 bl _ZN6Heater15getPIDDeltaTermEv
 1667 027a 81B2     	 uxth r1,r0
 1668 027c 2846     	 mov r0,r5
 1669 027e FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 1670              	.LVL155:
 1671              	 .loc 4 62 0
 1672 0282 A4F12800 	 sub r0,r4,#40
 1673 0286 BDE7     	 b .L91
 1674              	.L101:
 1675              	 .align 2
 1676              	.L100:
 1677 0288 08010000 	 .word _ZN11Motherboard11motherboardE+264
 1678 028c 0C020000 	 .word _ZN11Motherboard11motherboardE+524
 1679 0290 30010000 	 .word _ZN11Motherboard11motherboardE+304
 1680 0294 50000000 	 .word _ZN11Motherboard11motherboardE+80
 1681              	.LBE261:
 1682              	.LBE262:
 1683              	.LBE263:
 1684              	 .cfi_endproc
 1685              	.LFE152:
 1687              	 .section .text._ZN4host18processQueryPacketERK8InPacketR9OutPacket,"ax",%progbits
 1688              	 .align 2
 1689              	 .global _ZN4host18processQueryPacketERK8InPacketR9OutPacket
 1690              	 .thumb
 1691              	 .thumb_func
 1693              	_ZN4host18processQueryPacketERK8InPacketR9OutPacket:
 1694              	.LFB140:
 541:src/MightyBoard/Motherboard/Host.cc **** bool processQueryPacket(const InPacket& from_host, OutPacket& to_host) {
 1695              	 .loc 1 541 0
 1696              	 .cfi_startproc
 1697              	 
 1698              	 
 1699              	.LVL156:
 1700 0000 2DE9F04F 	 push {r4,r5,r6,r7,r8,r9,sl,fp,lr}
 1701              	.LCFI19:
 1702              	 .cfi_def_cfa_offset 36
 1703              	 .cfi_offset 14,-4
 1704              	 .cfi_offset 11,-8
 1705              	 .cfi_offset 10,-12
 1706              	 .cfi_offset 9,-16
 1707              	 .cfi_offset 8,-20
 1708              	 .cfi_offset 7,-24
 1709              	 .cfi_offset 6,-28
 1710              	 .cfi_offset 5,-32
 1711              	 .cfi_offset 4,-36
 1712 0004 87B0     	 sub sp,sp,#28
 1713              	.LCFI20:
 1714              	 .cfi_def_cfa_offset 64
 1715 0006 0446     	 mov r4,r0
 1716 0008 0E46     	 mov r6,r1
 1717              	.LVL157:
 1718              	.LBB308:
 1719              	.LBB309:
 1720              	.LBB310:
 1721              	 .loc 2 97 0
 1722 000a 0378     	 ldrb r3,[r0,#0]
 1723              	.LBE310:
 1724              	.LBE309:
 542:src/MightyBoard/Motherboard/Host.cc **** 	if (from_host.getLength() >= 1) {
 1725              	 .loc 1 542 0
 1726 000c 002B     	 cmp r3,#0
 1727 000e 00F06582 	 beq .L137
 1728              	.LBB311:
 543:src/MightyBoard/Motherboard/Host.cc **** 		uint8_t command = from_host.read8(0);
 1729              	 .loc 1 543 0
 1730 0012 0746     	 mov r7,r0
 1731 0014 4FF00001 	 mov r1,#0
 1732              	.LVL158:
 1733 0018 FFF7FEFF 	 bl _ZNK6Packet5read8Eh
 1734              	.LVL159:
 544:src/MightyBoard/Motherboard/Host.cc **** 		if ((command & 0x80) == 0) {
 1735              	 .loc 1 544 0
 1736 001c 10F0800F 	 tst r0,#128
 622:src/MightyBoard/Motherboard/Host.cc **** 	return false;
 1737              	 .loc 1 622 0
 1738 0020 18BF     	 it ne
 1739 0022 0020     	 movne r0,#0
 1740              	.LVL160:
 544:src/MightyBoard/Motherboard/Host.cc **** 		if ((command & 0x80) == 0) {
 1741              	 .loc 1 544 0
 1742 0024 40F06282 	 bne .L103
 546:src/MightyBoard/Motherboard/Host.cc **** 			switch (command) {
 1743              	 .loc 1 546 0
 1744 0028 1B28     	 cmp r0,#27
 1745 002a 00F25A82 	 bhi .L139
 1746 002e DFE810F0 	 tbh [pc,r0,lsl#1]
 1747              	.L124:
 1748 0032 1C00     	 .2byte (.L104-.L124)/2
 1749 0034 5600     	 .2byte (.L105-.L124)/2
 1750 0036 8500     	 .2byte (.L106-.L124)/2
 1751 0038 5E00     	 .2byte (.L107-.L124)/2
 1752 003a 9300     	 .2byte (.L108-.L124)/2
 1753 003c 5802     	 .2byte (.L139-.L124)/2
 1754 003e 5802     	 .2byte (.L139-.L124)/2
 1755 0040 5E00     	 .2byte (.L107-.L124)/2
 1756 0042 4B01     	 .2byte (.L109-.L124)/2
 1757 0044 5802     	 .2byte (.L139-.L124)/2
 1758 0046 5A01     	 .2byte (.L110-.L124)/2
 1759 0048 5F01     	 .2byte (.L111-.L124)/2
 1760 004a 7401     	 .2byte (.L112-.L124)/2
 1761 004c 7B01     	 .2byte (.L113-.L124)/2
 1762 004e FD00     	 .2byte (.L114-.L124)/2
 1763 0050 0D01     	 .2byte (.L115-.L124)/2
 1764 0052 1D01     	 .2byte (.L116-.L124)/2
 1765 0054 5E00     	 .2byte (.L107-.L124)/2
 1766 0056 4401     	 .2byte (.L117-.L124)/2
 1767 0058 5802     	 .2byte (.L139-.L124)/2
 1768 005a 3D00     	 .2byte (.L118-.L124)/2
 1769 005c BF00     	 .2byte (.L119-.L124)/2
 1770 005e C601     	 .2byte (.L120-.L124)/2
 1771 0060 E301     	 .2byte (.L121-.L124)/2
 1772 0062 F501     	 .2byte (.L122-.L124)/2
 1773 0064 5802     	 .2byte (.L139-.L124)/2
 1774 0066 5802     	 .2byte (.L139-.L124)/2
 1775 0068 3402     	 .2byte (.L123-.L124)/2
 1776              	.L104:
 1777              	.LVL161:
 1778              	.LBB312:
 1779              	.LBB313:
 274:src/MightyBoard/Motherboard/Host.cc ****     if(from_host.read16(1)  <=  25   ) {
 1780              	 .loc 1 274 0
 1781 006a 2046     	 mov r0,r4
 1782 006c 4FF00101 	 mov r1,#1
 1783 0070 FFF7FEFF 	 bl _ZNK6Packet6read16Eh
 1784 0074 1928     	 cmp r0,#25
 1785 0076 0CD8     	 bhi .L125
 275:src/MightyBoard/Motherboard/Host.cc ****         to_host.append8(RC_OK);
 1786              	 .loc 1 275 0
 1787 0078 3046     	 mov r0,r6
 1788 007a 4FF08101 	 mov r1,#129
 1789 007e FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 276:src/MightyBoard/Motherboard/Host.cc ****         to_host.append16(0x0000);
 1790              	 .loc 1 276 0
 1791 0082 3046     	 mov r0,r6
 1792 0084 4FF00001 	 mov r1,#0
 1793 0088 FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 549:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 1794              	 .loc 1 549 0
 1795 008c 4FF00100 	 mov r0,#1
 1796 0090 2CE2     	 b .L103
 1797              	.L125:
 279:src/MightyBoard/Motherboard/Host.cc ****         to_host.append8(RC_OK);
 1798              	 .loc 1 279 0
 1799 0092 3046     	 mov r0,r6
 1800 0094 4FF08101 	 mov r1,#129
 1801 0098 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 280:src/MightyBoard/Motherboard/Host.cc ****         to_host.append16(firmware_version);
 1802              	 .loc 1 280 0
 1803 009c 3046     	 mov r0,r6
 1804 009e 40F22B21 	 movw r1,#555
 1805 00a2 FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 549:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 1806              	 .loc 1 549 0
 1807 00a6 4FF00100 	 mov r0,#1
 1808 00aa 1FE2     	 b .L103
 1809              	.LVL162:
 1810              	.L118:
 1811              	.LBE313:
 1812              	.LBE312:
 1813              	.LBB314:
 1814              	.LBB315:
 302:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 1815              	 .loc 1 302 0
 1816 00ac 3046     	 mov r0,r6
 1817 00ae 4FF08101 	 mov r1,#129
 1818 00b2 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 1819              	.LVL163:
 1820 00b6 40F20004 	 movw r4,#:lower16:.LANCHOR4
 1821              	.LVL164:
 1822 00ba C0F20004 	 movt r4,#:upper16:.LANCHOR4
 541:src/MightyBoard/Motherboard/Host.cc **** bool processQueryPacket(const InPacket& from_host, OutPacket& to_host) {
 1823              	 .loc 1 541 0
 1824 00be 04F11F05 	 add r5,r4,#31
 1825              	.LVL165:
 1826              	.L126:
 1827              	.LBB316:
 304:src/MightyBoard/Motherboard/Host.cc **** 	  to_host.append8(buildName[idx]);
 1828              	 .loc 1 304 0
 1829 00c2 3046     	 mov r0,r6
 1830 00c4 2178     	 ldrb r1,[r4,#0]
 1831 00c6 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 305:src/MightyBoard/Motherboard/Host.cc **** 	  if (buildName[idx] == '\0') { break; }
 1832              	 .loc 1 305 0
 1833 00ca 14F8013B 	 ldrb r3,[r4],#1
 1834 00ce 002B     	 cmp r3,#0
 1835 00d0 00F00A82 	 beq .L140
 303:src/MightyBoard/Motherboard/Host.cc **** 	for (uint8_t idx = 0; idx < MAX_FILE_LEN; idx++) {
 1836              	 .loc 1 303 0
 1837 00d4 AC42     	 cmp r4,r5
 1838 00d6 F4D1     	 bne .L126
 552:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 1839              	 .loc 1 552 0
 1840 00d8 4FF00100 	 mov r0,#1
 1841 00dc 06E2     	 b .L103
 1842              	.LVL166:
 1843              	.L105:
 1844              	.LBE316:
 1845              	.LBE315:
 1846              	.LBE314:
 556:src/MightyBoard/Motherboard/Host.cc **** 				to_host.append8(RC_OK);
 1847              	 .loc 1 556 0
 1848 00de 3046     	 mov r0,r6
 1849 00e0 4FF08101 	 mov r1,#129
 1850 00e4 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 557:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 1851              	 .loc 1 557 0
 1852 00e8 4FF00100 	 mov r0,#1
 1853 00ec FEE1     	 b .L103
 1854              	.L107:
 561:src/MightyBoard/Motherboard/Host.cc **** 				if (currentState == HOST_STATE_BUILDING
 1855              	 .loc 1 561 0
 1856 00ee 40F20003 	 movw r3,#:lower16:.LANCHOR0
 1857 00f2 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 1858 00f6 1B78     	 ldrb r3,[r3,#0]
 1859 00f8 03F1FF32 	 add r2,r3,#-1
 1860 00fc D2B2     	 uxtb r2,r2
 1861 00fe 052B     	 cmp r3,#5
 1862 0100 14BF     	 ite ne
 1863 0102 0023     	 movne r3,#0
 1864 0104 0123     	 moveq r3,#1
 1865 0106 012A     	 cmp r2,#1
 1866 0108 98BF     	 it ls
 1867 010a 43F00103 	 orrls r3,r3,#1
 1868 010e 3BB1     	 cbz r3,.L127
 564:src/MightyBoard/Motherboard/Host.cc **** 					Motherboard::getBoard().indicateError(ERR_RESET_DURING_BUILD);
 1869              	 .loc 1 564 0
 1870 0110 40F20000 	 movw r0,#:lower16:_ZN11Motherboard11motherboardE
 1871 0114 C0F20000 	 movt r0,#:upper16:_ZN11Motherboard11motherboardE
 1872 0118 4FF00401 	 mov r1,#4
 1873 011c FFF7FEFF 	 bl _ZN11Motherboard13indicateErrorEi
 1874              	.L127:
 567:src/MightyBoard/Motherboard/Host.cc **** 				do_host_reset = true; // indicate reset after response has been sent
 1875              	 .loc 1 567 0
 1876 0120 40F20003 	 movw r3,#:lower16:.LANCHOR12
 1877 0124 C0F20003 	 movt r3,#:upper16:.LANCHOR12
 1878 0128 4FF00104 	 mov r4,#1
 1879 012c 1C70     	 strb r4,[r3,#0]
 568:src/MightyBoard/Motherboard/Host.cc **** 				to_host.append8(RC_OK);
 1880              	 .loc 1 568 0
 1881 012e 3046     	 mov r0,r6
 1882 0130 4FF08101 	 mov r1,#129
 1883 0134 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 569:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 1884              	 .loc 1 569 0
 1885 0138 2046     	 mov r0,r4
 1886 013a D7E1     	 b .L103
 1887              	.L106:
 1888              	.LVL167:
 1889              	.LBB319:
 1890              	.LBB320:
 310:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 1891              	 .loc 1 310 0
 1892 013c 3046     	 mov r0,r6
 1893 013e 4FF08101 	 mov r1,#129
 1894 0142 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 311:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append32(command::getRemainingCapacity());
 1895              	 .loc 1 311 0
 1896 0146 FFF7FEFF 	 bl _ZN7command20getRemainingCapacityEv
 1897 014a 0146     	 mov r1,r0
 1898 014c 3046     	 mov r0,r6
 1899 014e FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 1900              	.LBE320:
 1901              	.LBE319:
 572:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 1902              	 .loc 1 572 0
 1903 0152 4FF00100 	 mov r0,#1
 1904 0156 C9E1     	 b .L103
 1905              	.LVL168:
 1906              	.L108:
 1907              	.LBB321:
 1908              	.LBB322:
 316:src/MightyBoard/Motherboard/Host.cc **** 		const Point p = planner::getPosition();
 1909              	 .loc 1 316 0
 1910 0158 6846     	 mov r0,sp
 1911 015a FFF7FEFF 	 bl _ZN7planner11getPositionEv
 317:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append8(RC_OK);
 1912              	 .loc 1 317 0
 1913 015e 3046     	 mov r0,r6
 1914 0160 4FF08101 	 mov r1,#129
 1915 0164 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 318:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[0]);
 1916              	 .loc 1 318 0
 1917 0168 6846     	 mov r0,sp
 1918 016a 4FF00001 	 mov r1,#0
 1919 016e FFF7FEFF 	 bl _ZNK5PointixEj
 1920 0172 0168     	 ldr r1,[r0,#0]
 1921 0174 3046     	 mov r0,r6
 1922 0176 FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 319:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[1]);
 1923              	 .loc 1 319 0
 1924 017a 6846     	 mov r0,sp
 1925 017c 4FF00101 	 mov r1,#1
 1926 0180 FFF7FEFF 	 bl _ZNK5PointixEj
 1927 0184 0168     	 ldr r1,[r0,#0]
 1928 0186 3046     	 mov r0,r6
 1929 0188 FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 320:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[2]);
 1930              	 .loc 1 320 0
 1931 018c 6846     	 mov r0,sp
 1932 018e 4FF00201 	 mov r1,#2
 1933 0192 FFF7FEFF 	 bl _ZNK5PointixEj
 1934 0196 0168     	 ldr r1,[r0,#0]
 1935 0198 3046     	 mov r0,r6
 1936 019a FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 324:src/MightyBoard/Motherboard/Host.cc **** 		uint8_t endstop_status = steppers::getEndstopStatus();
 1937              	 .loc 1 324 0
 1938 019e FFF7FEFF 	 bl _ZN8steppers16getEndstopStatusEv
 1939 01a2 0146     	 mov r1,r0
 1940              	.LVL169:
 325:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append8(endstop_status);
 1941              	 .loc 1 325 0
 1942 01a4 3046     	 mov r0,r6
 1943              	.LVL170:
 1944 01a6 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 1945              	.LVL171:
 575:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 1946              	 .loc 1 575 0
 1947 01aa 4FF00100 	 mov r0,#1
 1948 01ae 9DE1     	 b .L103
 1949              	.LVL172:
 1950              	.L119:
 1951              	.LBE322:
 1952              	.LBE321:
 1953              	.LBB323:
 1954              	.LBB324:
 331:src/MightyBoard/Motherboard/Host.cc **** 		const Point p = planner::getPosition();
 1955              	 .loc 1 331 0
 1956 01b0 6846     	 mov r0,sp
 1957 01b2 FFF7FEFF 	 bl _ZN7planner11getPositionEv
 332:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append8(RC_OK);
 1958              	 .loc 1 332 0
 1959 01b6 3046     	 mov r0,r6
 1960 01b8 4FF08101 	 mov r1,#129
 1961 01bc FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 333:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[0]);
 1962              	 .loc 1 333 0
 1963 01c0 6846     	 mov r0,sp
 1964 01c2 4FF00001 	 mov r1,#0
 1965 01c6 FFF7FEFF 	 bl _ZNK5PointixEj
 1966 01ca 0168     	 ldr r1,[r0,#0]
 1967 01cc 3046     	 mov r0,r6
 1968 01ce FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 334:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[1]);
 1969              	 .loc 1 334 0
 1970 01d2 6846     	 mov r0,sp
 1971 01d4 4FF00101 	 mov r1,#1
 1972 01d8 FFF7FEFF 	 bl _ZNK5PointixEj
 1973 01dc 0168     	 ldr r1,[r0,#0]
 1974 01de 3046     	 mov r0,r6
 1975 01e0 FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 335:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[2]);
 1976              	 .loc 1 335 0
 1977 01e4 6846     	 mov r0,sp
 1978 01e6 4FF00201 	 mov r1,#2
 1979 01ea FFF7FEFF 	 bl _ZNK5PointixEj
 1980 01ee 0168     	 ldr r1,[r0,#0]
 1981 01f0 3046     	 mov r0,r6
 1982 01f2 FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 337:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[3]);
 1983              	 .loc 1 337 0
 1984 01f6 6846     	 mov r0,sp
 1985 01f8 4FF00301 	 mov r1,#3
 1986 01fc FFF7FEFF 	 bl _ZNK5PointixEj
 1987 0200 0168     	 ldr r1,[r0,#0]
 1988 0202 3046     	 mov r0,r6
 1989 0204 FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 338:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append32(p[4]);
 1990              	 .loc 1 338 0
 1991 0208 6846     	 mov r0,sp
 1992 020a 4FF00401 	 mov r1,#4
 1993 020e FFF7FEFF 	 bl _ZNK5PointixEj
 1994 0212 0168     	 ldr r1,[r0,#0]
 1995 0214 3046     	 mov r0,r6
 1996 0216 FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 346:src/MightyBoard/Motherboard/Host.cc **** 		uint8_t endstop_status = steppers::getEndstopStatus();
 1997              	 .loc 1 346 0
 1998 021a FFF7FEFF 	 bl _ZN8steppers16getEndstopStatusEv
 1999 021e 0146     	 mov r1,r0
 2000              	.LVL173:
 348:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append16((uint16_t)endstop_status);
 2001              	 .loc 1 348 0
 2002 0220 3046     	 mov r0,r6
 2003              	.LVL174:
 2004 0222 FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 2005              	.LVL175:
 578:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2006              	 .loc 1 578 0
 2007 0226 4FF00100 	 mov r0,#1
 2008 022a 5FE1     	 b .L103
 2009              	.LVL176:
 2010              	.L114:
 2011              	.LBE324:
 2012              	.LBE323:
 2013              	.LBB325:
 2014              	.LBB326:
 355:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 2015              	 .loc 1 355 0
 2016 022c 3046     	 mov r0,r6
 2017 022e 4FF08101 	 mov r1,#129
 2018 0232 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 356:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(sdcard::startCapture(p));
 2019              	 .loc 1 356 0
 2020 0236 04F10300 	 add r0,r4,#3
 2021 023a FFF7FEFF 	 bl _ZN6sdcard12startCaptureEPc
 2022 023e 0146     	 mov r1,r0
 2023 0240 3046     	 mov r0,r6
 2024 0242 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 2025              	.LBE326:
 2026              	.LBE325:
 581:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2027              	 .loc 1 581 0
 2028 0246 4FF00100 	 mov r0,#1
 2029 024a 4FE1     	 b .L103
 2030              	.LVL177:
 2031              	.L115:
 2032              	.LBB327:
 2033              	.LBB328:
 360:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 2034              	 .loc 1 360 0
 2035 024c 3046     	 mov r0,r6
 2036 024e 4FF08101 	 mov r1,#129
 2037 0252 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 361:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append32(sdcard::finishCapture());
 2038              	 .loc 1 361 0
 2039 0256 FFF7FEFF 	 bl _ZN6sdcard13finishCaptureEv
 2040 025a 0146     	 mov r1,r0
 2041 025c 3046     	 mov r0,r6
 2042 025e FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 362:src/MightyBoard/Motherboard/Host.cc **** 	sdcard::reset();
 2043              	 .loc 1 362 0
 2044 0262 FFF7FEFF 	 bl _ZN6sdcard5resetEv
 2045              	.LBE328:
 2046              	.LBE327:
 584:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2047              	 .loc 1 584 0
 2048 0266 4FF00100 	 mov r0,#1
 2049 026a 3FE1     	 b .L103
 2050              	.LVL178:
 2051              	.L116:
 2052              	.LBB329:
 2053              	.LBB330:
 367:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 2054              	 .loc 1 367 0
 2055 026c 3046     	 mov r0,r6
 2056 026e 4FF08101 	 mov r1,#129
 2057 0272 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 2058              	.LVL179:
 2059              	.LBB331:
 2060              	.LBB332:
 2061              	.LBB333:
 2062              	 .loc 2 97 0
 2063 0276 2378     	 ldrb r3,[r4,#0]
 2064              	.LBE333:
 2065              	.LBE332:
 368:src/MightyBoard/Motherboard/Host.cc **** 	for (int idx = 1; idx < from_host.getLength(); idx++) {
 2066              	 .loc 1 368 0
 2067 0278 012B     	 cmp r3,#1
 2068 027a 0EDD     	 ble .L128
 2069 027c DFF87882 	 ldr r8,.L146+4
 2070 0280 4FF00105 	 mov r5,#1
 2071              	.LVL180:
 2072              	.L129:
 369:src/MightyBoard/Motherboard/Host.cc **** 		buildName[idx-1] = from_host.read8(idx);
 2073              	 .loc 1 369 0
 2074 0284 3846     	 mov r0,r7
 2075 0286 E9B2     	 uxtb r1,r5
 2076 0288 FFF7FEFF 	 bl _ZNK6Packet5read8Eh
 2077 028c 08F8010F 	 strb r0,[r8,#1]!
 368:src/MightyBoard/Motherboard/Host.cc **** 	for (int idx = 1; idx < from_host.getLength(); idx++) {
 2078              	 .loc 1 368 0
 2079 0290 05F10105 	 add r5,r5,#1
 2080              	.LVL181:
 2081              	.LBB335:
 2082              	.LBB334:
 2083              	 .loc 2 97 0
 2084 0294 2378     	 ldrb r3,[r4,#0]
 2085              	.LBE334:
 2086              	.LBE335:
 368:src/MightyBoard/Motherboard/Host.cc **** 	for (int idx = 1; idx < from_host.getLength(); idx++) {
 2087              	 .loc 1 368 0
 2088 0296 9D42     	 cmp r5,r3
 2089 0298 F4DB     	 blt .L129
 2090              	.LVL182:
 2091              	.L128:
 2092              	.LBE331:
 371:src/MightyBoard/Motherboard/Host.cc **** 	buildName[MAX_FILE_LEN-1] = '\0';
 2093              	 .loc 1 371 0
 2094 029a 40F20003 	 movw r3,#:lower16:.LANCHOR4
 2095 029e C0F20003 	 movt r3,#:upper16:.LANCHOR4
 2096 02a2 4FF00002 	 mov r2,#0
 2097 02a6 9A77     	 strb r2,[r3,#30]
 373:src/MightyBoard/Motherboard/Host.cc **** 	uint8_t response = startBuildFromSD();
 2098              	 .loc 1 373 0
 2099 02a8 FFF7FEFF 	 bl _ZN4host16startBuildFromSDEv
 2100 02ac 0146     	 mov r1,r0
 2101              	.LVL183:
 374:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(response);
 2102              	 .loc 1 374 0
 2103 02ae 3046     	 mov r0,r6
 2104              	.LVL184:
 2105 02b0 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 2106              	.LVL185:
 2107              	.LBE330:
 2108              	.LBE329:
 587:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2109              	 .loc 1 587 0
 2110 02b4 4FF00100 	 mov r0,#1
 2111 02b8 18E1     	 b .L103
 2112              	.LVL186:
 2113              	.L117:
 589:src/MightyBoard/Motherboard/Host.cc **** 				handleNextFilename(from_host,to_host);
 2114              	 .loc 1 589 0
 2115 02ba 2046     	 mov r0,r4
 2116 02bc 3146     	 mov r1,r6
 2117 02be FFF7FEFF 	 bl _ZN4host18handleNextFilenameERK8InPacketR9OutPacket
 590:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2118              	 .loc 1 590 0
 2119 02c2 4FF00100 	 mov r0,#1
 2120 02c6 11E1     	 b .L103
 2121              	.L109:
 2122              	.LVL187:
 2123              	.LBB336:
 2124              	.LBB337:
 408:src/MightyBoard/Motherboard/Host.cc **** 	pauseBuild(!command::isPaused());
 2125              	 .loc 1 408 0
 2126 02c8 FFF7FEFF 	 bl _ZN7command8isPausedEv
 2127 02cc 80F00100 	 eor r0,r0,#1
 2128 02d0 C0B2     	 uxtb r0,r0
 2129 02d2 FFF7FEFF 	 bl _ZN4host10pauseBuildEb
 409:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 2130              	 .loc 1 409 0
 2131 02d6 3046     	 mov r0,r6
 2132 02d8 4FF08101 	 mov r1,#129
 2133 02dc FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 2134              	.LBE337:
 2135              	.LBE336:
 593:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2136              	 .loc 1 593 0
 2137 02e0 4FF00100 	 mov r0,#1
 2138 02e4 02E1     	 b .L103
 2139              	.LVL188:
 2140              	.L110:
 595:src/MightyBoard/Motherboard/Host.cc **** 				if(processExtruderQueryPacket(from_host,to_host)){
 2141              	 .loc 1 595 0
 2142 02e6 2046     	 mov r0,r4
 2143 02e8 3146     	 mov r1,r6
 2144 02ea FFF7FEFF 	 bl _ZN4host26processExtruderQueryPacketERK8InPacketR9OutPacket
 2145 02ee FDE0     	 b .L103
 2146              	.L111:
 2147              	.LVL189:
 2148              	.LBB338:
 2149              	.LBB339:
 414:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 2150              	 .loc 1 414 0
 2151 02f0 3046     	 mov r0,r6
 2152 02f2 4FF08101 	 mov r1,#129
 2153 02f6 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 416:src/MightyBoard/Motherboard/Host.cc **** 		bool done = !steppers::isRunning() && command::isEmpty();
 2154              	 .loc 1 416 0
 2155 02fa FFF7FEFF 	 bl _ZN8steppers9isRunningEv
 2156 02fe 4FF00001 	 mov r1,#0
 2157 0302 20B9     	 cbnz r0,.L130
 2158 0304 FFF7FEFF 	 bl _ZN7command7isEmptyEv
 2159 0308 011C     	 adds r1,r0,#0
 2160 030a 18BF     	 it ne
 2161 030c 0121     	 movne r1,#1
 2162              	.L130:
 2163              	.LVL190:
 417:src/MightyBoard/Motherboard/Host.cc **** 		to_host.append8(done?1:0);
 2164              	 .loc 1 417 0
 2165 030e 3046     	 mov r0,r6
 2166 0310 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 2167              	.LVL191:
 2168              	.LBE339:
 2169              	.LBE338:
 600:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2170              	 .loc 1 600 0
 2171 0314 4FF00100 	 mov r0,#1
 2172 0318 E8E0     	 b .L103
 2173              	.LVL192:
 2174              	.L112:
 602:src/MightyBoard/Motherboard/Host.cc **** 				handleReadEeprom(from_host,to_host);
 2175              	 .loc 1 602 0
 2176 031a 2046     	 mov r0,r4
 2177 031c 3146     	 mov r1,r6
 2178 031e FFF7FEFF 	 bl _ZN4host16handleReadEepromERK8InPacketR9OutPacket
 603:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2179              	 .loc 1 603 0
 2180 0322 4FF00100 	 mov r0,#1
 2181 0326 E1E0     	 b .L103
 2182              	.L113:
 2183              	.LVL193:
 2184              	.LBB341:
 2185              	.LBB342:
 438:src/MightyBoard/Motherboard/Host.cc **** 	xprintf("handleWriteEeprom" " (%s:%d)\n",_F_,_L_);
 2186              	 .loc 1 438 0
 2187 0328 40F20000 	 movw r0,#:lower16:.LC1
 2188 032c C0F20000 	 movt r0,#:upper16:.LC1
 2189 0330 7049     	 ldr r1,.L146
 2190 0332 4FF4DB72 	 mov r2,#438
 2191 0336 FFF7FEFF 	 bl xprintf
 439:src/MightyBoard/Motherboard/Host.cc ****     uint16_t offset = from_host.read16(1);
 2192              	 .loc 1 439 0
 2193 033a 2046     	 mov r0,r4
 2194 033c 4FF00101 	 mov r1,#1
 2195 0340 FFF7FEFF 	 bl _ZNK6Packet6read16Eh
 2196 0344 8246     	 mov sl,r0
 2197              	.LVL194:
 440:src/MightyBoard/Motherboard/Host.cc ****     uint8_t length = from_host.read8(3);
 2198              	 .loc 1 440 0
 2199 0346 2046     	 mov r0,r4
 2200              	.LVL195:
 2201 0348 4FF00301 	 mov r1,#3
 2202 034c FFF7FEFF 	 bl _ZNK6Packet5read8Eh
 2203              	.LVL196:
 2204              	.LBB343:
 445:src/MightyBoard/Motherboard/Host.cc ****     for (int i = 0; i < length; i++) {
 2205              	 .loc 1 445 0
 2206 0350 B0F1000B 	 subs fp,r0,#0
 2207 0354 27DD     	 ble .L131
 541:src/MightyBoard/Motherboard/Host.cc **** bool processQueryPacket(const InPacket& from_host, OutPacket& to_host) {
 2208              	 .loc 1 541 0
 2209 0356 0AF18065 	 add r5,sl,#67108864
 2210 035a 05F5E055 	 add r5,r5,#7168
 2211 035e 4FEA8505 	 lsl r5,r5,#2
 445:src/MightyBoard/Motherboard/Host.cc ****     for (int i = 0; i < length; i++) {
 2212              	 .loc 1 445 0
 2213 0362 5446     	 mov r4,sl
 541:src/MightyBoard/Motherboard/Host.cc **** bool processQueryPacket(const InPacket& from_host, OutPacket& to_host) {
 2214              	 .loc 1 541 0
 2215 0364 DA44     	 add sl,sl,fp
 2216              	.LVL197:
 2217              	.LBE343:
 2218              	.LBE342:
 2219              	.LBE341:
 2220              	.LBB346:
 2221              	.LBB340:
 2222 0366 4FF00408 	 mov r8,#4
 2223              	.LBE340:
 2224              	.LBE346:
 2225              	.LBB347:
 2226              	.LBB345:
 2227              	.LBB344:
 447:src/MightyBoard/Motherboard/Host.cc **** 		xprintf("%x %x %c" "\n",EEPROM_START_ADDRESS + offset + i,eeprom_address(EEPROM_START_ADDRESS, of
 2228              	 .loc 1 447 0
 2229 036a 40F20009 	 movw r9,#:lower16:.LC3
 2230 036e C0F20009 	 movt r9,#:upper16:.LC3
 2231              	.LVL198:
 2232              	.L132:
 446:src/MightyBoard/Motherboard/Host.cc ****     	eeprom::setEeprom8(offset + i, from_host.read8(i + 4));
 2233              	 .loc 1 446 0
 2234 0372 3846     	 mov r0,r7
 2235 0374 4146     	 mov r1,r8
 2236 0376 FFF7FEFF 	 bl _ZNK6Packet5read8Eh
 2237 037a 0146     	 mov r1,r0
 2238 037c A0B2     	 uxth r0,r4
 2239 037e FFF7FEFF 	 bl _ZN6eeprom10setEeprom8Eth
 447:src/MightyBoard/Motherboard/Host.cc **** 		xprintf("%x %x %c" "\n",EEPROM_START_ADDRESS + offset + i,eeprom_address(EEPROM_START_ADDRESS, of
 2240              	 .loc 1 447 0
 2241 0382 2A68     	 ldr r2,[r5,#0]
 2242 0384 55F8043B 	 ldr r3,[r5],#4
 541:src/MightyBoard/Motherboard/Host.cc **** bool processQueryPacket(const InPacket& from_host, OutPacket& to_host) {
 2243              	 .loc 1 541 0
 2244 0388 04F18051 	 add r1,r4,#268435456
 447:src/MightyBoard/Motherboard/Host.cc **** 		xprintf("%x %x %c" "\n",EEPROM_START_ADDRESS + offset + i,eeprom_address(EEPROM_START_ADDRESS, of
 2245              	 .loc 1 447 0
 2246 038c 4846     	 mov r0,r9
 2247 038e 01F5E041 	 add r1,r1,#28672
 2248 0392 FFF7FEFF 	 bl xprintf
 2249 0396 08F10108 	 add r8,r8,#1
 2250 039a 5FFA88F8 	 uxtb r8,r8
 2251 039e 04F10104 	 add r4,r4,#1
 445:src/MightyBoard/Motherboard/Host.cc ****     for (int i = 0; i < length; i++) {
 2252              	 .loc 1 445 0
 2253 03a2 5445     	 cmp r4,sl
 2254 03a4 E5D1     	 bne .L132
 2255              	.L131:
 2256              	.LBE344:
 454:src/MightyBoard/Motherboard/Host.cc ****     to_host.append8(RC_OK);
 2257              	 .loc 1 454 0
 2258 03a6 3046     	 mov r0,r6
 2259 03a8 4FF08101 	 mov r1,#129
 2260 03ac FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 455:src/MightyBoard/Motherboard/Host.cc ****     to_host.append8(length);
 2261              	 .loc 1 455 0
 2262 03b0 3046     	 mov r0,r6
 2263 03b2 5946     	 mov r1,fp
 2264 03b4 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 606:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2265              	 .loc 1 606 0
 2266 03b8 4FF00100 	 mov r0,#1
 2267 03bc 96E0     	 b .L103
 2268              	.LVL199:
 2269              	.L120:
 2270              	.LBE345:
 2271              	.LBE347:
 2272              	.LBB348:
 2273              	.LBB349:
 465:src/MightyBoard/Motherboard/Host.cc **** 	uint8_t flags = from_host.read8(1);
 2274              	 .loc 1 465 0
 2275 03be 2046     	 mov r0,r4
 2276 03c0 4FF00101 	 mov r1,#1
 2277 03c4 FFF7FEFF 	 bl _ZNK6Packet5read8Eh
 2278 03c8 0446     	 mov r4,r0
 2279              	.LVL200:
 466:src/MightyBoard/Motherboard/Host.cc **** 	if (flags & _BV(ES_STEPPERS)) {
 2280              	 .loc 1 466 0
 2281 03ca 10F0010F 	 tst r0,#1
 2282 03ce 01D0     	 beq .L133
 467:src/MightyBoard/Motherboard/Host.cc **** 		planner::abort();
 2283              	 .loc 1 467 0
 2284 03d0 FFF7FEFF 	 bl _ZN7planner5abortEv
 2285              	.LVL201:
 2286              	.L133:
 469:src/MightyBoard/Motherboard/Host.cc **** 	if (flags & _BV(ES_COMMANDS)) {
 2287              	 .loc 1 469 0
 2288 03d4 14F0020F 	 tst r4,#2
 2289 03d8 01D0     	 beq .L134
 470:src/MightyBoard/Motherboard/Host.cc **** 		command::reset();
 2290              	 .loc 1 470 0
 2291 03da FFF7FEFF 	 bl _ZN7command5resetEv
 2292              	.L134:
 473:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 2293              	 .loc 1 473 0
 2294 03de 3046     	 mov r0,r6
 2295 03e0 4FF08101 	 mov r1,#129
 2296 03e4 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 474:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(0);
 2297              	 .loc 1 474 0
 2298 03e8 3046     	 mov r0,r6
 2299 03ea 4FF00001 	 mov r1,#0
 2300 03ee FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 2301              	.LBE349:
 2302              	.LBE348:
 609:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2303              	 .loc 1 609 0
 2304 03f2 4FF00100 	 mov r0,#1
 2305 03f6 79E0     	 b .L103
 2306              	.LVL202:
 2307              	.L121:
 2308              	.LBB350:
 2309              	.LBB351:
 536:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 2310              	 .loc 1 536 0
 2311 03f8 3046     	 mov r0,r6
 2312 03fa 4FF08101 	 mov r1,#129
 2313 03fe FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 537:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(board.GetErrorStatus());
 2314              	 .loc 1 537 0
 2315 0402 40F20000 	 movw r0,#:lower16:_ZN11Motherboard11motherboardE
 2316 0406 C0F20000 	 movt r0,#:upper16:_ZN11Motherboard11motherboardE
 2317 040a FFF7FEFF 	 bl _ZN11Motherboard14GetErrorStatusEv
 2318 040e 0146     	 mov r1,r0
 2319 0410 3046     	 mov r0,r6
 2320 0412 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 2321              	.LBE351:
 2322              	.LBE350:
 612:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2323              	 .loc 1 612 0
 2324 0416 4FF00100 	 mov r0,#1
 2325 041a 67E0     	 b .L103
 2326              	.LVL203:
 2327              	.L122:
 2328              	.LBB352:
 2329              	.LBB353:
 516:src/MightyBoard/Motherboard/Host.cc ****         to_host.append8(RC_OK);
 2330              	 .loc 1 516 0
 2331 041c 3046     	 mov r0,r6
 2332 041e 4FF08101 	 mov r1,#129
 2333 0422 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 521:src/MightyBoard/Motherboard/Host.cc **** 		getPrintTime(hours, minutes);
 2334              	 .loc 1 521 0
 2335 0426 0DF11600 	 add r0,sp,#22
 2336 042a 0DF11701 	 add r1,sp,#23
 2337 042e FFF7FEFF 	 bl _ZN4host12getPrintTimeERhS0_
 523:src/MightyBoard/Motherboard/Host.cc ****         to_host.append8(buildState);
 2338              	 .loc 1 523 0
 2339 0432 40F20004 	 movw r4,#:lower16:.LANCHOR5
 2340 0436 C0F20004 	 movt r4,#:upper16:.LANCHOR5
 2341 043a 3046     	 mov r0,r6
 2342 043c 2178     	 ldrb r1,[r4,#0]
 2343 043e FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 524:src/MightyBoard/Motherboard/Host.cc ****         to_host.append8(hours);
 2344              	 .loc 1 524 0
 2345 0442 3046     	 mov r0,r6
 2346              	.LVL204:
 2347 0444 9DF81610 	 ldrb r1,[sp,#22]
 2348 0448 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 525:src/MightyBoard/Motherboard/Host.cc ****         to_host.append8(minutes);
 2349              	 .loc 1 525 0
 2350 044c 3046     	 mov r0,r6
 2351              	.LVL205:
 2352 044e 9DF81710 	 ldrb r1,[sp,#23]
 2353 0452 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 526:src/MightyBoard/Motherboard/Host.cc ****         if((buildState == BUILD_RUNNING) || (buildState == BUILD_PAUSED)){
 2354              	 .loc 1 526 0
 2355 0456 2378     	 ldrb r3,[r4,#0]
 2356 0458 032B     	 cmp r3,#3
 2357 045a 14BF     	 ite ne
 2358 045c 0022     	 movne r2,#0
 2359 045e 0122     	 moveq r2,#1
 2360 0460 012B     	 cmp r3,#1
 2361 0462 14BF     	 ite ne
 2362 0464 1346     	 movne r3,r2
 2363 0466 42F00103 	 orreq r3,r2,#1
 2364 046a 33B1     	 cbz r3,.L135
 527:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append32(command::getLineNumber());
 2365              	 .loc 1 527 0
 2366 046c FFF7FEFF 	 bl _ZN7command13getLineNumberEv
 2367 0470 0146     	 mov r1,r0
 2368 0472 3046     	 mov r0,r6
 2369 0474 FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 2370 0478 07E0     	 b .L136
 2371              	.L135:
 529:src/MightyBoard/Motherboard/Host.cc **** 			to_host.append32(last_print_line);
 2372              	 .loc 1 529 0
 2373 047a 40F20003 	 movw r3,#:lower16:.LANCHOR11
 2374 047e C0F20003 	 movt r3,#:upper16:.LANCHOR11
 2375 0482 3046     	 mov r0,r6
 2376 0484 1968     	 ldr r1,[r3,#0]
 2377 0486 FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 2378              	.L136:
 531:src/MightyBoard/Motherboard/Host.cc ****         to_host.append32(0);// open spot for filament detect info
 2379              	 .loc 1 531 0
 2380 048a 3046     	 mov r0,r6
 2381 048c 4FF00001 	 mov r1,#0
 2382 0490 FFF7FEFF 	 bl _ZN9OutPacket8append32Em
 615:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2383              	 .loc 1 615 0
 2384 0494 4FF00100 	 mov r0,#1
 2385 0498 28E0     	 b .L103
 2386              	.LVL206:
 2387              	.L123:
 2388              	.LBE353:
 2389              	.LBE352:
 2390              	.LBB354:
 2391              	.LBB355:
 290:src/MightyBoard/Motherboard/Host.cc **** 	uint16_t host_version = from_host.read16(1);
 2392              	 .loc 1 290 0
 2393 049a 2046     	 mov r0,r4
 2394 049c 4FF00101 	 mov r1,#1
 2395 04a0 FFF7FEFF 	 bl _ZNK6Packet6read16Eh
 292:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append8(RC_OK);
 2396              	 .loc 1 292 0
 2397 04a4 3046     	 mov r0,r6
 2398 04a6 4FF08101 	 mov r1,#129
 2399 04aa FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 293:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append16(firmware_version);
 2400              	 .loc 1 293 0
 2401 04ae 3046     	 mov r0,r6
 2402 04b0 40F22B21 	 movw r1,#555
 2403 04b4 FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 294:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append16(internal_version);
 2404              	 .loc 1 294 0
 2405 04b8 3046     	 mov r0,r6
 2406 04ba 4FF00001 	 mov r1,#0
 2407 04be FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 295:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append16(0);
 2408              	 .loc 1 295 0
 2409 04c2 3046     	 mov r0,r6
 2410 04c4 4FF00001 	 mov r1,#0
 2411 04c8 FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 296:src/MightyBoard/Motherboard/Host.cc **** 	to_host.append16(0);
 2412              	 .loc 1 296 0
 2413 04cc 3046     	 mov r0,r6
 2414 04ce 4FF00001 	 mov r1,#0
 2415 04d2 FFF7FEFF 	 bl _ZN9OutPacket8append16Et
 2416              	.LBE355:
 2417              	.LBE354:
 618:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2418              	 .loc 1 618 0
 2419 04d6 4FF00100 	 mov r0,#1
 2420 04da 07E0     	 b .L103
 2421              	.LVL207:
 2422              	.L137:
 2423              	.LBE311:
 622:src/MightyBoard/Motherboard/Host.cc **** 	return false;
 2424              	 .loc 1 622 0
 2425 04dc 4FF00000 	 mov r0,#0
 2426              	.LVL208:
 2427 04e0 04E0     	 b .L103
 2428              	.L139:
 2429              	.LBB357:
 2430 04e2 4FF00000 	 mov r0,#0
 2431 04e6 01E0     	 b .L103
 2432              	.LVL209:
 2433              	.L140:
 2434              	.LBB356:
 2435              	.LBB318:
 2436              	.LBB317:
 552:src/MightyBoard/Motherboard/Host.cc **** 				return true;
 2437              	 .loc 1 552 0
 2438 04e8 4FF00100 	 mov r0,#1
 2439              	.LVL210:
 2440              	.L103:
 2441              	.LBE317:
 2442              	.LBE318:
 2443              	.LBE356:
 2444              	.LBE357:
 2445              	.LBE308:
 623:src/MightyBoard/Motherboard/Host.cc **** }
 2446              	 .loc 1 623 0
 2447 04ec 07B0     	 add sp,sp,#28
 2448 04ee BDE8F08F 	 pop {r4,r5,r6,r7,r8,r9,sl,fp,pc}
 2449              	.L147:
 2450 04f2 00BF     	 .align 2
 2451              	.L146:
 2452 04f4 1C000000 	 .word .LC2+28
 2453 04f8 FFFFFFFF 	 .word .LANCHOR4-1
 2454              	 .cfi_endproc
 2455              	.LFE140:
 2457              	 .section .text._ZN4host12runHostSliceEv,"ax",%progbits
 2458              	 .align 2
 2459              	 .global _ZN4host12runHostSliceEv
 2460              	 .thumb
 2461              	 .thumb_func
 2463              	_ZN4host12runHostSliceEv:
 2464              	.LFB118:
  98:src/MightyBoard/Motherboard/Host.cc **** void runHostSlice() {
 2465              	 .loc 1 98 0
 2466              	 .cfi_startproc
 2467              	 
 2468              	 
 2469 0000 30B5     	 push {r4,r5,lr}
 2470              	.LCFI21:
 2471              	 .cfi_def_cfa_offset 12
 2472              	 .cfi_offset 14,-4
 2473              	 .cfi_offset 5,-8
 2474              	 .cfi_offset 4,-12
 2475 0002 85B0     	 sub sp,sp,#20
 2476              	.LCFI22:
 2477              	 .cfi_def_cfa_offset 32
 2478              	.LBB386:
 2479              	.LBB387:
 2480              	.LBB388:
 2481              	 .file 5 "src/MightyBoard/shared/UART.hh"
   1:src/MightyBoard/shared/UART.hh **** /*
   2:src/MightyBoard/shared/UART.hh ****  * Copyright 2010 by Adam Mayer	 <adam@makerbot.com>
   3:src/MightyBoard/shared/UART.hh ****  *
   4:src/MightyBoard/shared/UART.hh ****  * This program is free software: you can redistribute it and/or modify
   5:src/MightyBoard/shared/UART.hh ****  * it under the terms of the GNU General Public License as published by
   6:src/MightyBoard/shared/UART.hh ****  * the Free Software Foundation, either version 3 of the License, or
   7:src/MightyBoard/shared/UART.hh ****  * (at your option) any later version.
   8:src/MightyBoard/shared/UART.hh ****  *
   9:src/MightyBoard/shared/UART.hh ****  * This program is distributed in the hope that it will be useful,
  10:src/MightyBoard/shared/UART.hh ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:src/MightyBoard/shared/UART.hh ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:src/MightyBoard/shared/UART.hh ****  * GNU General Public License for more details.
  13:src/MightyBoard/shared/UART.hh ****  *
  14:src/MightyBoard/shared/UART.hh ****  * You should have received a copy of the GNU General Public License
  15:src/MightyBoard/shared/UART.hh ****  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  16:src/MightyBoard/shared/UART.hh ****  */
  17:src/MightyBoard/shared/UART.hh **** 
  18:src/MightyBoard/shared/UART.hh **** #ifndef UART_HH_
  19:src/MightyBoard/shared/UART.hh **** #define UART_HH_
  20:src/MightyBoard/shared/UART.hh **** 
  21:src/MightyBoard/shared/UART.hh **** #include "Packet.hh"
  22:src/MightyBoard/shared/UART.hh **** #include "Configuration.hh"
  23:src/MightyBoard/shared/UART.hh **** #include <stdint.h>
  24:src/MightyBoard/shared/UART.hh **** 
  25:src/MightyBoard/shared/UART.hh **** // TODO: Move to UART class
  26:src/MightyBoard/shared/UART.hh **** /// Communication mode selection
  27:src/MightyBoard/shared/UART.hh **** enum communication_mode {
  28:src/MightyBoard/shared/UART.hh ****     RS232,  // USB        ///< Act as an asynchronous, full duplex RS232 transciever
  29:src/MightyBoard/shared/UART.hh ****     RS485   // RS485        ///< Act as an asynchronous, half duplex RS485 transciever
  30:src/MightyBoard/shared/UART.hh **** };
  31:src/MightyBoard/shared/UART.hh **** 
  32:src/MightyBoard/shared/UART.hh **** 
  33:src/MightyBoard/shared/UART.hh **** /// The UART object implements the serial communication protocol using one
  34:src/MightyBoard/shared/UART.hh **** /// or two hardware UART libraries.
  35:src/MightyBoard/shared/UART.hh **** ///
  36:src/MightyBoard/shared/UART.hh **** /// UARTs, when constructed, start off disabled.
  37:src/MightyBoard/shared/UART.hh **** /// They begin receiving data only after an enable(true)
  38:src/MightyBoard/shared/UART.hh **** /// call is made.  beginSend() calls will send completed
  39:src/MightyBoard/shared/UART.hh **** /// packets.
  40:src/MightyBoard/shared/UART.hh **** ///
  41:src/MightyBoard/shared/UART.hh **** /// Porting notes:
  42:src/MightyBoard/shared/UART.hh **** /// The current implementation supports one UART on the atmega168/328, and two UARTs
  43:src/MightyBoard/shared/UART.hh **** /// on the atmega644 and atmega1280/2560. The code will need to be updated to support
  44:src/MightyBoard/shared/UART.hh **** /// new architectures.
  45:src/MightyBoard/shared/UART.hh **** /// \ingroup HardwareLibraries
  46:src/MightyBoard/shared/UART.hh **** class UART {
  47:src/MightyBoard/shared/UART.hh **** private:
  48:src/MightyBoard/shared/UART.hh **** //	static UART hostUART;       ///< The controller accepts commands from the host UART
  49:src/MightyBoard/shared/UART.hh **** #if HAS_SLAVE_UART
  50:src/MightyBoard/shared/UART.hh **** //	static UART slaveUART;      ///< The controller can forward commands to the slave UART
  51:src/MightyBoard/shared/UART.hh **** #endif
  52:src/MightyBoard/shared/UART.hh **** 
  53:src/MightyBoard/shared/UART.hh **** public:
  54:src/MightyBoard/shared/UART.hh ****     /// Get a reference to the host UART
  55:src/MightyBoard/shared/UART.hh ****     /// \return hostUART instance, which should act as a slave to a computer (or motherboard)
  56:src/MightyBoard/shared/UART.hh ****     static UART& getHostUART() {static UART hostUART(0,RS232); return hostUART; }
 2482              	 .loc 5 56 0
 2483 0004 40F20003 	 movw r3,#:lower16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2484 0008 C0F20003 	 movt r3,#:upper16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2485 000c 1B68     	 ldr r3,[r3,#0]
 2486 000e 13F0010F 	 tst r3,#1
 2487 0012 33D1     	 bne .L149
 2488 0014 40F20000 	 movw r0,#:lower16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2489 0018 C0F20000 	 movt r0,#:upper16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2490 001c FFF7FEFF 	 bl __cxa_guard_acquire
 2491 0020 70B1     	 cbz r0,.L150
 2492 0022 40F20000 	 movw r0,#:lower16:_ZZN4UART11getHostUARTEvE8hostUART
 2493 0026 C0F20000 	 movt r0,#:upper16:_ZZN4UART11getHostUARTEvE8hostUART
 2494 002a 4FF00001 	 mov r1,#0
 2495 002e 0A46     	 mov r2,r1
 2496 0030 FFF7FEFF 	 bl _ZN4UARTC1Eh18communication_mode
 2497 0034 40F20000 	 movw r0,#:lower16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2498 0038 C0F20000 	 movt r0,#:upper16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2499 003c FFF7FEFF 	 bl __cxa_guard_release
 2500              	.L150:
 2501              	.LVL211:
 2502              	.LBE388:
 2503              	.LBE387:
 2504              	.LBB389:
 2505              	.LBB390:
 2506 0040 40F20003 	 movw r3,#:lower16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2507 0044 C0F20003 	 movt r3,#:upper16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2508 0048 1B68     	 ldr r3,[r3,#0]
 2509 004a 13F0010F 	 tst r3,#1
 2510 004e 15D1     	 bne .L149
 2511 0050 40F20000 	 movw r0,#:lower16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2512 0054 C0F20000 	 movt r0,#:upper16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2513 0058 FFF7FEFF 	 bl __cxa_guard_acquire
 2514 005c 70B1     	 cbz r0,.L149
 2515 005e 40F20000 	 movw r0,#:lower16:_ZZN4UART11getHostUARTEvE8hostUART
 2516 0062 C0F20000 	 movt r0,#:upper16:_ZZN4UART11getHostUARTEvE8hostUART
 2517 0066 4FF00001 	 mov r1,#0
 2518 006a 0A46     	 mov r2,r1
 2519 006c FFF7FEFF 	 bl _ZN4UARTC1Eh18communication_mode
 2520 0070 40F20000 	 movw r0,#:lower16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2521 0074 C0F20000 	 movt r0,#:upper16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2522 0078 FFF7FEFF 	 bl __cxa_guard_release
 2523              	.LVL212:
 2524              	.L149:
 2525              	.LBE390:
 2526              	.LBE389:
 2527              	.LBB391:
 2528              	.LBB392:
  98:src/MightyBoard/shared/Packet.hh **** 
  99:src/MightyBoard/shared/Packet.hh **** 	bool hasError() const {
 100:src/MightyBoard/shared/Packet.hh **** 		return error_code != PacketError::NO_ERROR;
 101:src/MightyBoard/shared/Packet.hh **** 	}
 102:src/MightyBoard/shared/Packet.hh **** 
 103:src/MightyBoard/shared/Packet.hh **** 	uint8_t getErrorCode() const { return error_code; }
 104:src/MightyBoard/shared/Packet.hh **** 
 105:src/MightyBoard/shared/Packet.hh **** 	// Reads an 8-bit byte from the specified index of the payload
 106:src/MightyBoard/shared/Packet.hh **** 	uint8_t read8(uint8_t idx) const;
 107:src/MightyBoard/shared/Packet.hh **** 	uint16_t read16(uint8_t idx) const;
 108:src/MightyBoard/shared/Packet.hh **** 	uint32_t read32(uint8_t idx) const;
 109:src/MightyBoard/shared/Packet.hh **** 
 110:src/MightyBoard/shared/Packet.hh **** 	uint8_t debugGetState() const { return state; }
 111:src/MightyBoard/shared/Packet.hh **** 
 112:src/MightyBoard/shared/Packet.hh **** 	const volatile uint8_t* getData() const { return payload; }
 113:src/MightyBoard/shared/Packet.hh **** };
 114:src/MightyBoard/shared/Packet.hh **** 
 115:src/MightyBoard/shared/Packet.hh **** /// Input Packet.
 116:src/MightyBoard/shared/Packet.hh **** class InPacket: public Packet {
 117:src/MightyBoard/shared/Packet.hh **** private:
 118:src/MightyBoard/shared/Packet.hh **** 	volatile uint8_t expected_length;
 119:src/MightyBoard/shared/Packet.hh **** public:
 120:src/MightyBoard/shared/Packet.hh **** 	InPacket();
 121:src/MightyBoard/shared/Packet.hh **** 
 122:src/MightyBoard/shared/Packet.hh **** 	/// Reset the entire packet reception.
 123:src/MightyBoard/shared/Packet.hh **** 	void reset();
 124:src/MightyBoard/shared/Packet.hh **** 
 125:src/MightyBoard/shared/Packet.hh **** 	//process a byte for our packet.
 126:src/MightyBoard/shared/Packet.hh **** 	void processByte(uint8_t b);
 127:src/MightyBoard/shared/Packet.hh **** 
 128:src/MightyBoard/shared/Packet.hh **** 	bool isFinished() const {
 129:src/MightyBoard/shared/Packet.hh **** 		return state == PS_LAST;
 130:src/MightyBoard/shared/Packet.hh **** 	}
 131:src/MightyBoard/shared/Packet.hh **** 
 132:src/MightyBoard/shared/Packet.hh **** 	bool isStarted() const {
 133:src/MightyBoard/shared/Packet.hh **** 		return state != PS_START;
 134:src/MightyBoard/shared/Packet.hh **** 	}
 135:src/MightyBoard/shared/Packet.hh **** 
 136:src/MightyBoard/shared/Packet.hh **** 	/// Indicate that this packet has timed out.  This means:
 137:src/MightyBoard/shared/Packet.hh **** 	/// * setting the PACKET_TIMEOUT error on the packet
 138:src/MightyBoard/shared/Packet.hh **** 	/// * the packet gets reset
 139:src/MightyBoard/shared/Packet.hh **** 	void timeout() {
 140:src/MightyBoard/shared/Packet.hh **** 		error(PacketError::PACKET_TIMEOUT);
 141:src/MightyBoard/shared/Packet.hh **** 	}
 142:src/MightyBoard/shared/Packet.hh **** };
 143:src/MightyBoard/shared/Packet.hh **** 
 144:src/MightyBoard/shared/Packet.hh **** /// Output Packet.
 145:src/MightyBoard/shared/Packet.hh **** class OutPacket: public Packet {
 146:src/MightyBoard/shared/Packet.hh **** private:
 147:src/MightyBoard/shared/Packet.hh **** 	uint8_t send_payload_index;
 148:src/MightyBoard/shared/Packet.hh **** public:
 149:src/MightyBoard/shared/Packet.hh **** 	OutPacket();
 150:src/MightyBoard/shared/Packet.hh **** 
 151:src/MightyBoard/shared/Packet.hh **** 	/// Reset the entire packet transmission.
 152:src/MightyBoard/shared/Packet.hh **** 	void reset();
 153:src/MightyBoard/shared/Packet.hh **** 
 154:src/MightyBoard/shared/Packet.hh **** 	bool isFinished() const {
 155:src/MightyBoard/shared/Packet.hh **** 		return state == PS_LAST;
 156:src/MightyBoard/shared/Packet.hh **** 	}
 157:src/MightyBoard/shared/Packet.hh **** 
 158:src/MightyBoard/shared/Packet.hh **** 	bool isSending() const {
 159:src/MightyBoard/shared/Packet.hh **** 		return state != PS_START && state != PS_LAST;
 2529              	 .loc 2 159 0
 2530 007c 40F20003 	 movw r3,#:lower16:_ZZN4UART11getHostUARTEvE8hostUART
 2531 0080 C0F20003 	 movt r3,#:upper16:_ZZN4UART11getHostUARTEvE8hostUART
 2532 0084 93F84B30 	 ldrb r3,[r3,#75]
 2533 0088 002B     	 cmp r3,#0
 2534 008a 00F05681 	 beq .L151
 2535 008e 40F20003 	 movw r3,#:lower16:_ZZN4UART11getHostUARTEvE8hostUART
 2536 0092 C0F20003 	 movt r3,#:upper16:_ZZN4UART11getHostUARTEvE8hostUART
 2537 0096 93F84B30 	 ldrb r3,[r3,#75]
 2538 009a 042B     	 cmp r3,#4
 2539 009c 40F05F81 	 bne .L148
 2540 00a0 4BE1     	 b .L151
 2541              	.L168:
 2542              	.LBE392:
 2543              	.LBE391:
 107:src/MightyBoard/Motherboard/Host.cc **** 	if (do_host_reset && (!cancelBuild || cancel_timeout.hasElapsed())){
 2544              	 .loc 1 107 0 discriminator 1
 2545 00a2 40F20003 	 movw r3,#:lower16:.LANCHOR1
 2546 00a6 C0F20003 	 movt r3,#:upper16:.LANCHOR1
 2547 00aa 1B78     	 ldrb r3,[r3,#0]
 2548 00ac 43B1     	 cbz r3,.L153
 107:src/MightyBoard/Motherboard/Host.cc **** 	if (do_host_reset && (!cancelBuild || cancel_timeout.hasElapsed())){
 2549              	 .loc 1 107 0 is_stmt 0 discriminator 4
 2550 00ae 40F20000 	 movw r0,#:lower16:.LANCHOR10
 2551 00b2 C0F20000 	 movt r0,#:upper16:.LANCHOR10
 2552 00b6 FFF7FEFF 	 bl _ZN7Timeout10hasElapsedEv
 2553 00ba 0028     	 cmp r0,#0
 2554 00bc 00F04581 	 beq .L154
 2555              	.L153:
 111:src/MightyBoard/Motherboard/Host.cc **** 		if((buildState == BUILD_RUNNING) || (buildState == BUILD_PAUSED)){
 2556              	 .loc 1 111 0 is_stmt 1 discriminator 5
 2557 00c0 40F20003 	 movw r3,#:lower16:.LANCHOR5
 2558 00c4 C0F20003 	 movt r3,#:upper16:.LANCHOR5
 2559 00c8 1B78     	 ldrb r3,[r3,#0]
 2560 00ca 032B     	 cmp r3,#3
 2561 00cc 14BF     	 ite ne
 2562 00ce 0022     	 movne r2,#0
 2563 00d0 0122     	 moveq r2,#1
 2564 00d2 012B     	 cmp r3,#1
 2565 00d4 14BF     	 ite ne
 2566 00d6 1346     	 movne r3,r2
 2567 00d8 42F00103 	 orreq r3,r2,#1
 2568 00dc 0BB1     	 cbz r3,.L155
 112:src/MightyBoard/Motherboard/Host.cc **** 			stopBuild();
 2569              	 .loc 1 112 0
 2570 00de FFF7FEFF 	 bl _ZN4host9stopBuildEv
 2571              	.L155:
 114:src/MightyBoard/Motherboard/Host.cc **** 		do_host_reset = false;
 2572              	 .loc 1 114 0
 2573 00e2 40F20003 	 movw r3,#:lower16:.LANCHOR12
 2574 00e6 C0F20003 	 movt r3,#:upper16:.LANCHOR12
 2575 00ea 4FF00004 	 mov r4,#0
 2576 00ee 1C70     	 strb r4,[r3,#0]
 117:src/MightyBoard/Motherboard/Host.cc **** 		reset(hard_reset);
 2577              	 .loc 1 117 0
 2578 00f0 40F20005 	 movw r5,#:lower16:.LANCHOR13
 2579 00f4 C0F20005 	 movt r5,#:upper16:.LANCHOR13
 2580 00f8 2878     	 ldrb r0,[r5,#0]
 2581 00fa FFF7FEFF 	 bl _Z5resetb
 121:src/MightyBoard/Motherboard/Host.cc **** 		hard_reset = false;
 2582              	 .loc 1 121 0
 2583 00fe 2C70     	 strb r4,[r5,#0]
 122:src/MightyBoard/Motherboard/Host.cc **** 		packet_in_timeout.abort();
 2584              	 .loc 1 122 0
 2585 0100 40F20000 	 movw r0,#:lower16:.LANCHOR14
 2586 0104 C0F20000 	 movt r0,#:upper16:.LANCHOR14
 2587 0108 FFF7FEFF 	 bl _ZN7Timeout5abortEv
 125:src/MightyBoard/Motherboard/Host.cc **** 		machineName[0] = 0;
 2588              	 .loc 1 125 0
 2589 010c 40F20003 	 movw r3,#:lower16:.LANCHOR2
 2590 0110 C0F20003 	 movt r3,#:upper16:.LANCHOR2
 2591 0114 1C70     	 strb r4,[r3,#0]
 126:src/MightyBoard/Motherboard/Host.cc **** 		buildName[0] = 0;
 2592              	 .loc 1 126 0
 2593 0116 40F20003 	 movw r3,#:lower16:.LANCHOR4
 2594 011a C0F20003 	 movt r3,#:upper16:.LANCHOR4
 2595 011e 1C70     	 strb r4,[r3,#0]
 127:src/MightyBoard/Motherboard/Host.cc **** 		currentState = HOST_STATE_READY;
 2596              	 .loc 1 127 0
 2597 0120 40F20003 	 movw r3,#:lower16:.LANCHOR0
 2598 0124 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 2599 0128 1C70     	 strb r4,[r3,#0]
 129:src/MightyBoard/Motherboard/Host.cc **** 		return;
 2600              	 .loc 1 129 0
 2601 012a 18E1     	 b .L148
 2602              	.LVL213:
 2603              	.L169:
 2604              	.LBB393:
 2605              	.LBB394:
 129:src/MightyBoard/shared/Packet.hh **** 		return state == PS_LAST;
 2606              	 .loc 2 129 0
 2607 012c 40F20003 	 movw r3,#:lower16:_ZZN4UART11getHostUARTEvE8hostUART
 2608 0130 C0F20003 	 movt r3,#:upper16:_ZZN4UART11getHostUARTEvE8hostUART
 2609 0134 93F82630 	 ldrb r3,[r3,#38]
 2610              	.LBE394:
 2611              	.LBE393:
 132:src/MightyBoard/Motherboard/Host.cc **** 	if (in.isStarted() && !in.isFinished()) {
 2612              	 .loc 1 132 0
 2613 0138 042B     	 cmp r3,#4
 2614 013a 28D0     	 beq .L156
 133:src/MightyBoard/Motherboard/Host.cc **** 		xprintf("in.isStarted() && !in.isFinished()" " (%s:%d)\n",_F_,_L_);
 2615              	 .loc 1 133 0 discriminator 1
 2616 013c 40F20000 	 movw r0,#:lower16:.LC4
 2617 0140 C0F20000 	 movt r0,#:upper16:.LC4
 2618 0144 8749     	 ldr r1,.L170
 2619 0146 4FF08502 	 mov r2,#133
 2620 014a FFF7FEFF 	 bl xprintf
 2621              	.LVL214:
 2622              	.LBB395:
 2623              	.LBB396:
 2624              	 .file 6 "src/MightyBoard/shared/Timeout.hh"
   1:src/MightyBoard/shared/Timeout.hh **** /*
   2:src/MightyBoard/shared/Timeout.hh ****  * Copyright 2010 by Adam Mayer	 <adam@makerbot.com>
   3:src/MightyBoard/shared/Timeout.hh ****  *
   4:src/MightyBoard/shared/Timeout.hh ****  * This program is free software: you can redistribute it and/or modify
   5:src/MightyBoard/shared/Timeout.hh ****  * it under the terms of the GNU General Public License as published by
   6:src/MightyBoard/shared/Timeout.hh ****  * the Free Software Foundation, either version 3 of the License, or
   7:src/MightyBoard/shared/Timeout.hh ****  * (at your option) any later version.
   8:src/MightyBoard/shared/Timeout.hh ****  *
   9:src/MightyBoard/shared/Timeout.hh ****  * This program is distributed in the hope that it will be useful,
  10:src/MightyBoard/shared/Timeout.hh ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:src/MightyBoard/shared/Timeout.hh ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:src/MightyBoard/shared/Timeout.hh ****  * GNU General Public License for more details.
  13:src/MightyBoard/shared/Timeout.hh ****  *
  14:src/MightyBoard/shared/Timeout.hh ****  * You should have received a copy of the GNU General Public License
  15:src/MightyBoard/shared/Timeout.hh ****  * along with this program.  If not, see <http://www.gnu.org/licenses/>
  16:src/MightyBoard/shared/Timeout.hh ****  */
  17:src/MightyBoard/shared/Timeout.hh **** 
  18:src/MightyBoard/shared/Timeout.hh **** #ifndef TIMEOUT_HH_
  19:src/MightyBoard/shared/Timeout.hh **** #define TIMEOUT_HH_
  20:src/MightyBoard/shared/Timeout.hh **** 
  21:src/MightyBoard/shared/Timeout.hh **** #include <stdint.h>
  22:src/MightyBoard/shared/Timeout.hh **** #include "Types.hh"
  23:src/MightyBoard/shared/Timeout.hh **** 
  24:src/MightyBoard/shared/Timeout.hh **** /// The timeout object is a simple 1-shot timer, which can be used to schedule a low-frequency
  25:src/MightyBoard/shared/Timeout.hh **** /// event such as polling a temperature sensor. To start a timeout, call the #start() function with
  26:src/MightyBoard/shared/Timeout.hh **** /// the minimum number of microseconds to wait before
  27:src/MightyBoard/shared/Timeout.hh **** ///
  28:src/MightyBoard/shared/Timeout.hh **** /// Timeout objects maintain timestamps and check the universal clock to figure out when they've
  29:src/MightyBoard/shared/Timeout.hh **** /// elapsed.  Resolution is at best that of the system interval.  Maximum timeout length is
  30:src/MightyBoard/shared/Timeout.hh **** /// 4294967295 microseconds.
  31:src/MightyBoard/shared/Timeout.hh **** /// Timeouts must be checked before the maximum timeout length to remain valid 
  32:src/MightyBoard/shared/Timeout.hh **** /// After a timeout has elapsed, it can not go back to a valid state without being explicitly reset
  33:src/MightyBoard/shared/Timeout.hh **** /// \ingroup SoftwareLibraries
  34:src/MightyBoard/shared/Timeout.hh **** class Timeout {
  35:src/MightyBoard/shared/Timeout.hh **** private:
  36:src/MightyBoard/shared/Timeout.hh ****         bool active;                    ///< True if the timeout object is actively counting down.
  37:src/MightyBoard/shared/Timeout.hh ****         bool elapsed;                   ///< True if the timeout object has elapsed.
  38:src/MightyBoard/shared/Timeout.hh ****         bool is_paused;					///< True if the timeout object is paused
  39:src/MightyBoard/shared/Timeout.hh **** 
  40:src/MightyBoard/shared/Timeout.hh ****         //TODO: Instead of storing start and duration, precompute and store the elapse time.
  41:src/MightyBoard/shared/Timeout.hh **** 	micros_t start_stamp_micros;
  42:src/MightyBoard/shared/Timeout.hh **** 	micros_t duration_micros;
  43:src/MightyBoard/shared/Timeout.hh **** 	micros_t pause_micros;
  44:src/MightyBoard/shared/Timeout.hh **** public:
  45:src/MightyBoard/shared/Timeout.hh ****         /// Instantiate a new timeout object.
  46:src/MightyBoard/shared/Timeout.hh **** 	Timeout();
  47:src/MightyBoard/shared/Timeout.hh **** 
  48:src/MightyBoard/shared/Timeout.hh ****         /// Start a new timeout cycle that will elapse after the given amount of time.
  49:src/MightyBoard/shared/Timeout.hh ****         /// \param [in] duration_micros Microseconds until the timeout cycle should elapse.
  50:src/MightyBoard/shared/Timeout.hh **** 	void start(micros_t duration_micros);
  51:src/MightyBoard/shared/Timeout.hh **** 
  52:src/MightyBoard/shared/Timeout.hh ****         /// Test whether the current timeout cycle has elapsed. When called, this function will
  53:src/MightyBoard/shared/Timeout.hh ****         /// compare the system time to the calculated time that the timeout should expire, and
  54:src/MightyBoard/shared/Timeout.hh ****         /// if it has, the timer is marked as elapsed and not active.
  55:src/MightyBoard/shared/Timeout.hh ****         /// \return True if the timeout has elapsed.
  56:src/MightyBoard/shared/Timeout.hh **** 	bool hasElapsed();
  57:src/MightyBoard/shared/Timeout.hh **** 
  58:src/MightyBoard/shared/Timeout.hh ****         ///
  59:src/MightyBoard/shared/Timeout.hh ****         /// \return True if the timeout is still running.
  60:src/MightyBoard/shared/Timeout.hh **** 	bool isActive() const { return active; }
 2625              	 .loc 6 60 0 discriminator 1
 2626 014e 40F20003 	 movw r3,#:lower16:.LANCHOR14
 2627 0152 C0F20003 	 movt r3,#:upper16:.LANCHOR14
 2628              	.LBE396:
 2629              	.LBE395:
 134:src/MightyBoard/Motherboard/Host.cc **** 		if (!packet_in_timeout.isActive()) {
 2630              	 .loc 1 134 0 discriminator 1
 2631 0156 1B78     	 ldrb r3,[r3,#0]
 2632 0158 53B9     	 cbnz r3,.L157
 136:src/MightyBoard/Motherboard/Host.cc **** 			packet_in_timeout.start(HOST_PACKET_TIMEOUT_MICROS);
 2633              	 .loc 1 136 0
 2634 015a 40F20000 	 movw r0,#:lower16:.LANCHOR14
 2635 015e C0F20000 	 movt r0,#:upper16:.LANCHOR14
 2636 0162 4FF45461 	 mov r1,#3392
 2637 0166 C0F20301 	 movt r1,3
 2638 016a FFF7FEFF 	 bl _ZN7Timeout5startEm
 2639 016e 0EE0     	 b .L156
 2640              	.L157:
 137:src/MightyBoard/Motherboard/Host.cc **** 		} else if (packet_in_timeout.hasElapsed()) {
 2641              	 .loc 1 137 0
 2642 0170 40F20000 	 movw r0,#:lower16:.LANCHOR14
 2643 0174 C0F20000 	 movt r0,#:upper16:.LANCHOR14
 2644 0178 FFF7FEFF 	 bl _ZN7Timeout10hasElapsedEv
 2645 017c 38B1     	 cbz r0,.L156
 2646              	.LVL215:
 2647              	.LBB397:
 2648              	.LBB398:
 2649              	.LBB399:
  93:src/MightyBoard/shared/Packet.hh **** 		reset();
 2650              	 .loc 2 93 0
 2651 017e 7A4C     	 ldr r4,.L170+4
 2652              	.LVL216:
 2653 0180 2046     	 mov r0,r4
 2654 0182 FFF7FEFF 	 bl _ZN6Packet5resetEv
  94:src/MightyBoard/shared/Packet.hh **** 		error_code = error_code_in;
 2655              	 .loc 2 94 0
 2656 0186 4FF00403 	 mov r3,#4
 2657 018a 84F82230 	 strb r3,[r4,#34]
 2658              	.LVL217:
 2659              	.L156:
 2660              	.LBE399:
 2661              	.LBE398:
 2662              	.LBE397:
 2663              	.LBB400:
 2664              	.LBB401:
 100:src/MightyBoard/shared/Packet.hh **** 		return error_code != PacketError::NO_ERROR;
 2665              	 .loc 2 100 0
 2666 018e 40F20003 	 movw r3,#:lower16:_ZZN4UART11getHostUARTEvE8hostUART
 2667 0192 C0F20003 	 movt r3,#:upper16:_ZZN4UART11getHostUARTEvE8hostUART
 2668 0196 93F82530 	 ldrb r3,[r3,#37]
 2669              	.LBE401:
 2670              	.LBE400:
 142:src/MightyBoard/Motherboard/Host.cc **** 	if (in.hasError()) {
 2671              	 .loc 1 142 0
 2672 019a 13B1     	 cbz r3,.L158
 164:src/MightyBoard/Motherboard/Host.cc **** 		in.reset();
 2673              	 .loc 1 164 0
 2674 019c 7248     	 ldr r0,.L170+4
 2675              	.LVL218:
 2676 019e FFF7FEFF 	 bl _ZN8InPacket5resetEv
 2677              	.LVL219:
 2678              	.L158:
 2679              	.LBB402:
 2680              	.LBB403:
 129:src/MightyBoard/shared/Packet.hh **** 		return state == PS_LAST;
 2681              	 .loc 2 129 0
 2682 01a2 40F20003 	 movw r3,#:lower16:_ZZN4UART11getHostUARTEvE8hostUART
 2683 01a6 C0F20003 	 movt r3,#:upper16:_ZZN4UART11getHostUARTEvE8hostUART
 2684 01aa 93F82630 	 ldrb r3,[r3,#38]
 2685              	.LBE403:
 2686              	.LBE402:
 169:src/MightyBoard/Motherboard/Host.cc **** 	if (in.isFinished()) {
 2687              	 .loc 1 169 0
 2688 01ae 042B     	 cmp r3,#4
 2689 01b0 40F09D80 	 bne .L159
 171:src/MightyBoard/Motherboard/Host.cc **** 		DEBUG_PIN1.setValue(false);
 2690              	 .loc 1 171 0
 2691 01b4 03A8     	 add r0,sp,#12
 2692 01b6 4FF0FF01 	 mov r1,#255
 2693 01ba FFF7FEFF 	 bl _ZN7LPCPortC1Eh
 2694 01be 01A8     	 add r0,sp,#4
 2695 01c0 03A9     	 add r1,sp,#12
 2696 01c2 4FF0FF02 	 mov r2,#255
 2697 01c6 FFF7FEFF 	 bl _ZN3PinC1ERK7LPCPorth
 2698              	.LVL220:
 2699              	.LBB404:
 2700              	.LBB405:
 2701              	 .file 7 "src/MightyBoard/shared/Pin.hh"
   1:src/MightyBoard/shared/Pin.hh **** #ifndef PIN_HH
   2:src/MightyBoard/shared/Pin.hh **** #define PIN_HH
   3:src/MightyBoard/shared/Pin.hh **** 
   4:src/MightyBoard/shared/Pin.hh **** #include "LPCPort.hh"
   5:src/MightyBoard/shared/Pin.hh **** #include "Pin.hh"
   6:src/MightyBoard/shared/Pin.hh **** extern "C" {
   7:src/MightyBoard/shared/Pin.hh **** 	#include "lpc17xx_gpio.h"
   8:src/MightyBoard/shared/Pin.hh **** 	#include "lpc17xx_pinsel.h"
   9:src/MightyBoard/shared/Pin.hh **** 	#include "comm.h"
  10:src/MightyBoard/shared/Pin.hh **** }
  11:src/MightyBoard/shared/Pin.hh **** 
  12:src/MightyBoard/shared/Pin.hh **** /// \ingroup HardwareLibraries
  13:src/MightyBoard/shared/Pin.hh **** class Pin {
  14:src/MightyBoard/shared/Pin.hh **** private:
  15:src/MightyBoard/shared/Pin.hh **** 	uint8_t port_base;
  16:src/MightyBoard/shared/Pin.hh **** 	bool is_null;
  17:src/MightyBoard/shared/Pin.hh **** 	uint8_t pin_index;
  18:src/MightyBoard/shared/Pin.hh **** 	uint8_t pin_mask;
  19:src/MightyBoard/shared/Pin.hh **** 	uint8_t pin_mask_inverted;
  20:src/MightyBoard/shared/Pin.hh **** 
  21:src/MightyBoard/shared/Pin.hh **** public:
  22:src/MightyBoard/shared/Pin.hh **** 	Pin();
  23:src/MightyBoard/shared/Pin.hh **** 	Pin(const LPCPort& port_in, uint8_t pin_index_in);
  24:src/MightyBoard/shared/Pin.hh **** 	Pin(const Pin& other_pin);
  25:src/MightyBoard/shared/Pin.hh **** 	bool isNull() const;
  26:src/MightyBoard/shared/Pin.hh **** 	void setDirection(bool out) const;
  27:src/MightyBoard/shared/Pin.hh **** 	bool /*Pin::*/getValue() const {
  28:src/MightyBoard/shared/Pin.hh **** 		if (is_null)
  29:src/MightyBoard/shared/Pin.hh **** 			return false; // null pin is always low ... ?
  30:src/MightyBoard/shared/Pin.hh **** 		return ((uint8_t)(FIO_ReadValue(port_base) & _BV(pin_index))?1:0);
  31:src/MightyBoard/shared/Pin.hh **** //		return (uint8_t)((uint8_t)PINx & (uint8_t)pin_mask) != 0;
  32:src/MightyBoard/shared/Pin.hh **** 	};
  33:src/MightyBoard/shared/Pin.hh **** 
  34:src/MightyBoard/shared/Pin.hh **** 	void /*Pin::*/setValue(bool on) const {
  35:src/MightyBoard/shared/Pin.hh **** 		if (is_null)
 2702              	 .loc 7 35 0
 2703 01ca 9DF80530 	 ldrb r3,[sp,#5]
 2704 01ce 4BB9     	 cbnz r3,.L160
  36:src/MightyBoard/shared/Pin.hh **** 		 	return;
  37:src/MightyBoard/shared/Pin.hh **** 		// uint8_t oldSREG = SREG;
  38:src/MightyBoard/shared/Pin.hh **** 
  39:src/MightyBoard/shared/Pin.hh **** //		xprintf("on:%d port_base:%d pi_index:%d" " (%s:%d)\n",on,port_base,pin_index,_F_,_L_);
  40:src/MightyBoard/shared/Pin.hh **** 		// cli();
  41:src/MightyBoard/shared/Pin.hh **** 		if (on) {
  42:src/MightyBoard/shared/Pin.hh **** //			PORTx |= pin_mask;
  43:src/MightyBoard/shared/Pin.hh **** //			xprintf("%x (%s:%d)\n",&GPIO_SetValue,_F_,_L_);
  44:src/MightyBoard/shared/Pin.hh **** 			GPIO_SetValue(port_base, _BV(pin_index));
  45:src/MightyBoard/shared/Pin.hh **** 		} else {
  46:src/MightyBoard/shared/Pin.hh **** //			PORTx &= pin_mask_inverted;
  47:src/MightyBoard/shared/Pin.hh **** //			xprintf("%x (%s:%d)\n",&GPIO_ClearValue,_F_,_L_);
  48:src/MightyBoard/shared/Pin.hh **** 			GPIO_ClearValue(port_base, _BV(pin_index));
 2705              	 .loc 7 48 0
 2706 01d0 9DF80630 	 ldrb r3,[sp,#6]
 2707 01d4 9DF80400 	 ldrb r0,[sp,#4]
 2708 01d8 4FF00101 	 mov r1,#1
 2709 01dc 01FA03F1 	 lsl r1,r1,r3
 2710 01e0 FFF7FEFF 	 bl GPIO_ClearValue
 2711              	.L160:
 2712              	.LBE405:
 2713              	.LBE404:
 172:src/MightyBoard/Motherboard/Host.cc **** 		packet_in_timeout.abort();
 2714              	 .loc 1 172 0
 2715 01e4 40F20000 	 movw r0,#:lower16:.LANCHOR14
 2716 01e8 C0F20000 	 movt r0,#:upper16:.LANCHOR14
 2717 01ec FFF7FEFF 	 bl _ZN7Timeout5abortEv
 173:src/MightyBoard/Motherboard/Host.cc **** 		out.reset();
 2718              	 .loc 1 173 0
 2719 01f0 5E48     	 ldr r0,.L170+8
 2720 01f2 FFF7FEFF 	 bl _ZN9OutPacket5resetEv
 175:src/MightyBoard/Motherboard/Host.cc **** 		if(currentState == HOST_STATE_HEAT_SHUTDOWN){
 2721              	 .loc 1 175 0
 2722 01f6 40F20003 	 movw r3,#:lower16:.LANCHOR0
 2723 01fa C0F20003 	 movt r3,#:upper16:.LANCHOR0
 2724 01fe 1B78     	 ldrb r3,[r3,#0]
 2725 0200 062B     	 cmp r3,#6
 2726 0202 18D1     	 bne .L161
 176:src/MightyBoard/Motherboard/Host.cc **** 			if(cancelBuild){
 2727              	 .loc 1 176 0
 2728 0204 40F20003 	 movw r3,#:lower16:.LANCHOR1
 2729 0208 C0F20003 	 movt r3,#:upper16:.LANCHOR1
 2730 020c 1B78     	 ldrb r3,[r3,#0]
 2731 020e 63B1     	 cbz r3,.L162
 177:src/MightyBoard/Motherboard/Host.cc **** 				out.append8(RC_CANCEL_BUILD);
 2732              	 .loc 1 177 0
 2733 0210 5648     	 ldr r0,.L170+8
 2734 0212 4FF08901 	 mov r1,#137
 2735 0216 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 178:src/MightyBoard/Motherboard/Host.cc **** 				cancelBuild= false;
 2736              	 .loc 1 178 0
 2737 021a 40F20003 	 movw r3,#:lower16:.LANCHOR1
 2738 021e C0F20003 	 movt r3,#:upper16:.LANCHOR1
 2739 0222 4FF00002 	 mov r2,#0
 2740 0226 1A70     	 strb r2,[r3,#0]
 2741 0228 3AE0     	 b .L163
 2742              	.L162:
 180:src/MightyBoard/Motherboard/Host.cc **** 				out.append8(RC_BOT_OVERHEAT);
 2743              	 .loc 1 180 0
 2744 022a 5048     	 ldr r0,.L170+8
 2745 022c 4FF08B01 	 mov r1,#139
 2746 0230 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 2747 0234 34E0     	 b .L163
 2748              	.L161:
 182:src/MightyBoard/Motherboard/Host.cc **** 		}else if(cancelBuild){
 2749              	 .loc 1 182 0
 2750 0236 40F20003 	 movw r3,#:lower16:.LANCHOR1
 2751 023a C0F20003 	 movt r3,#:upper16:.LANCHOR1
 2752 023e 1B78     	 ldrb r3,[r3,#0]
 2753 0240 A3B1     	 cbz r3,.L164
 183:src/MightyBoard/Motherboard/Host.cc **** 			out.append8(RC_CANCEL_BUILD);
 2754              	 .loc 1 183 0
 2755 0242 4A48     	 ldr r0,.L170+8
 2756 0244 4FF08901 	 mov r1,#137
 2757 0248 FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 184:src/MightyBoard/Motherboard/Host.cc **** 			cancelBuild = false;
 2758              	 .loc 1 184 0
 2759 024c 40F20003 	 movw r3,#:lower16:.LANCHOR1
 2760 0250 C0F20003 	 movt r3,#:upper16:.LANCHOR1
 2761 0254 4FF00002 	 mov r2,#0
 2762 0258 1A70     	 strb r2,[r3,#0]
 185:src/MightyBoard/Motherboard/Host.cc **** 			Motherboard::getBoard().indicateError(6);
 2763              	 .loc 1 185 0
 2764 025a 40F20000 	 movw r0,#:lower16:_ZN11Motherboard11motherboardE
 2765 025e C0F20000 	 movt r0,#:upper16:_ZN11Motherboard11motherboardE
 2766 0262 4FF00601 	 mov r1,#6
 2767 0266 FFF7FEFF 	 bl _ZN11Motherboard13indicateErrorEi
 2768 026a 19E0     	 b .L163
 2769              	.L164:
 188:src/MightyBoard/Motherboard/Host.cc **** 		if (processDebugPacket(in, out)) {
 2770              	 .loc 1 188 0
 2771 026c 3E49     	 ldr r1,.L170+4
 2772              	.LVL221:
 2773 026e 0846     	 mov r0,r1
 2774 0270 01F12501 	 add r1,r1,#37
 2775              	.LVL222:
 2776 0274 FFF7FEFF 	 bl _Z18processDebugPacketRK8InPacketR9OutPacket
 2777              	.LVL223:
 2778 0278 90B9     	 cbnz r0,.L163
 192:src/MightyBoard/Motherboard/Host.cc **** 		if (processCommandPacket(in, out)) {
 2779              	 .loc 1 192 0
 2780 027a 3B49     	 ldr r1,.L170+4
 2781              	.LVL224:
 2782 027c 0846     	 mov r0,r1
 2783 027e 01F12501 	 add r1,r1,#37
 2784              	.LVL225:
 2785 0282 FFF7FEFF 	 bl _ZN4host20processCommandPacketERK8InPacketR9OutPacket
 2786              	.LVL226:
 2787 0286 58B9     	 cbnz r0,.L163
 194:src/MightyBoard/Motherboard/Host.cc **** 		} else if (processQueryPacket(in, out)) {
 2788              	 .loc 1 194 0
 2789 0288 3749     	 ldr r1,.L170+4
 2790              	.LVL227:
 2791 028a 0846     	 mov r0,r1
 2792 028c 01F12501 	 add r1,r1,#37
 2793              	.LVL228:
 2794 0290 FFF7FEFF 	 bl _ZN4host18processQueryPacketERK8InPacketR9OutPacket
 2795              	.LVL229:
 2796 0294 20B9     	 cbnz r0,.L163
 198:src/MightyBoard/Motherboard/Host.cc **** 			out.append8(RC_CMD_UNSUPPORTED);
 2797              	 .loc 1 198 0
 2798 0296 3548     	 ldr r0,.L170+8
 2799 0298 4FF08501 	 mov r1,#133
 2800 029c FFF7FEFF 	 bl _ZN9OutPacket7append8Eh
 2801              	.L163:
 200:src/MightyBoard/Motherboard/Host.cc **** 		in.reset();
 2802              	 .loc 1 200 0
 2803 02a0 3148     	 ldr r0,.L170+4
 2804              	.LVL230:
 2805 02a2 FFF7FEFF 	 bl _ZN8InPacket5resetEv
 2806              	.LVL231:
 2807              	.LBB406:
 2808              	.LBB407:
 2809              	 .loc 5 56 0
 2810 02a6 40F20003 	 movw r3,#:lower16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2811 02aa C0F20003 	 movt r3,#:upper16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2812 02ae 1B68     	 ldr r3,[r3,#0]
 2813 02b0 13F0010F 	 tst r3,#1
 2814 02b4 15D1     	 bne .L165
 2815 02b6 40F20000 	 movw r0,#:lower16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2816 02ba C0F20000 	 movt r0,#:upper16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2817 02be FFF7FEFF 	 bl __cxa_guard_acquire
 2818 02c2 70B1     	 cbz r0,.L165
 2819 02c4 40F20000 	 movw r0,#:lower16:_ZZN4UART11getHostUARTEvE8hostUART
 2820 02c8 C0F20000 	 movt r0,#:upper16:_ZZN4UART11getHostUARTEvE8hostUART
 2821 02cc 4FF00001 	 mov r1,#0
 2822 02d0 0A46     	 mov r2,r1
 2823 02d2 FFF7FEFF 	 bl _ZN4UARTC1Eh18communication_mode
 2824 02d6 40F20000 	 movw r0,#:lower16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2825 02da C0F20000 	 movt r0,#:upper16:_ZGVZN4UART11getHostUARTEvE8hostUART
 2826 02de FFF7FEFF 	 bl __cxa_guard_release
 2827              	.L165:
 2828              	.LBE407:
 2829              	.LBE406:
 201:src/MightyBoard/Motherboard/Host.cc ****                 UART::getHostUART().beginSend();
 2830              	 .loc 1 201 0
 2831 02e2 40F20000 	 movw r0,#:lower16:_ZZN4UART11getHostUARTEvE8hostUART
 2832 02e6 C0F20000 	 movt r0,#:upper16:_ZZN4UART11getHostUARTEvE8hostUART
 2833 02ea FFF7FEFF 	 bl _ZN4UART9beginSendEv
 2834              	.LVL232:
 2835              	.L159:
 204:src/MightyBoard/Motherboard/Host.cc **** 	if(currentState==HOST_STATE_BUILDING_FROM_SD)
 2836              	 .loc 1 204 0
 2837 02ee 40F20003 	 movw r3,#:lower16:.LANCHOR0
 2838 02f2 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 2839 02f6 1B78     	 ldrb r3,[r3,#0]
 2840 02f8 022B     	 cmp r3,#2
 2841 02fa 0AD1     	 bne .L166
 206:src/MightyBoard/Motherboard/Host.cc **** 		if(!sdcard::isPlaying())
 2842              	 .loc 1 206 0
 2843 02fc FFF7FEFF 	 bl _ZN6sdcard9isPlayingEv
 2844 0300 38B9     	 cbnz r0,.L166
 207:src/MightyBoard/Motherboard/Host.cc **** 			currentState = HOST_STATE_READY;
 2845              	 .loc 1 207 0
 2846 0302 40F20003 	 movw r3,#:lower16:.LANCHOR0
 2847 0306 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 2848 030a 4FF00002 	 mov r2,#0
 2849 030e 1A70     	 strb r2,[r3,#0]
 2850 0310 10E0     	 b .L167
 2851              	.L166:
 210:src/MightyBoard/Motherboard/Host.cc **** 	if((currentState==HOST_STATE_BUILDING_ONBOARD))
 2852              	 .loc 1 210 0
 2853 0312 40F20003 	 movw r3,#:lower16:.LANCHOR0
 2854 0316 C0F20003 	 movt r3,#:upper16:.LANCHOR0
 2855 031a 1B78     	 ldrb r3,[r3,#0]
 2856 031c 052B     	 cmp r3,#5
 2857 031e 09D1     	 bne .L167
 212:src/MightyBoard/Motherboard/Host.cc **** 		if(!utility::isPlaying()){
 2858              	 .loc 1 212 0
 2859 0320 FFF7FEFF 	 bl _ZN7utility9isPlayingEv
 2860 0324 30B9     	 cbnz r0,.L167
 213:src/MightyBoard/Motherboard/Host.cc **** 			currentState = HOST_STATE_READY;
 2861              	 .loc 1 213 0
 2862 0326 40F20003 	 movw r3,#:lower16:.LANCHOR0
 2863 032a C0F20003 	 movt r3,#:upper16:.LANCHOR0
 2864 032e 4FF00002 	 mov r2,#0
 2865 0332 1A70     	 strb r2,[r3,#0]
 2866              	.L167:
 216:src/MightyBoard/Motherboard/Host.cc **** 	managePrintTime();
 2867              	 .loc 1 216 0
 2868 0334 FFF7FEFF 	 bl _ZN4host15managePrintTimeEv
 2869 0338 11E0     	 b .L148
 2870              	.LVL233:
 2871              	.L151:
 107:src/MightyBoard/Motherboard/Host.cc **** 	if (do_host_reset && (!cancelBuild || cancel_timeout.hasElapsed())){
 2872              	 .loc 1 107 0
 2873 033a 40F20003 	 movw r3,#:lower16:.LANCHOR12
 2874 033e C0F20003 	 movt r3,#:upper16:.LANCHOR12
 2875 0342 1B78     	 ldrb r3,[r3,#0]
 2876 0344 002B     	 cmp r3,#0
 2877 0346 7FF4ACAE 	 bne .L168
 2878              	.L154:
 2879              	.LVL234:
 2880              	.LBB408:
 2881              	.LBB409:
 133:src/MightyBoard/shared/Packet.hh **** 		return state != PS_START;
 2882              	 .loc 2 133 0
 2883 034a 40F20003 	 movw r3,#:lower16:_ZZN4UART11getHostUARTEvE8hostUART
 2884 034e C0F20003 	 movt r3,#:upper16:_ZZN4UART11getHostUARTEvE8hostUART
 2885 0352 93F82630 	 ldrb r3,[r3,#38]
 2886              	.LBE409:
 2887              	.LBE408:
 132:src/MightyBoard/Motherboard/Host.cc **** 	if (in.isStarted() && !in.isFinished()) {
 2888              	 .loc 1 132 0
 2889 0356 002B     	 cmp r3,#0
 2890 0358 7FF4E8AE 	 bne .L169
 2891 035c 17E7     	 b .L156
 2892              	.LVL235:
 2893              	.L148:
 2894              	.LBE386:
 217:src/MightyBoard/Motherboard/Host.cc **** }
 2895              	 .loc 1 217 0
 2896 035e 05B0     	 add sp,sp,#20
 2897 0360 30BD     	 pop {r4,r5,pc}
 2898              	.L171:
 2899 0362 00BF     	 .align 2
 2900              	.L170:
 2901 0364 1C000000 	 .word .LC2+28
 2902 0368 03000000 	 .word _ZZN4UART11getHostUARTEvE8hostUART+3
 2903 036c 28000000 	 .word _ZZN4UART11getHostUARTEvE8hostUART+40
 2904              	 .cfi_endproc
 2905              	.LFE118:
 2907              	 .section .text._GLOBAL__sub_I__ZN4host17packet_in_timeoutE,"ax",%progbits
 2908              	 .align 2
 2909              	 .thumb
 2910              	 .thumb_func
 2912              	_GLOBAL__sub_I__ZN4host17packet_in_timeoutE:
 2913              	.LFB157:
 807:src/MightyBoard/Motherboard/Host.cc **** 
 808:src/MightyBoard/Motherboard/Host.cc **** }
 2914              	 .loc 1 808 0
 2915              	 .cfi_startproc
 2916              	 
 2917              	 
 2918 0000 10B5     	 push {r4,lr}
 2919              	.LCFI23:
 2920              	 .cfi_def_cfa_offset 8
 2921              	 .cfi_offset 14,-4
 2922              	 .cfi_offset 4,-8
 2923              	.LVL236:
 2924              	.LBB412:
 2925              	.LBB413:
 2926              	 .file 8 "src/MightyBoard/shared/LPCPort.hh"
   1:src/MightyBoard/shared/LPCPort.hh **** /*
   2:src/MightyBoard/shared/LPCPort.hh **** * Copyright 2010 by Adam Mayer	 <adam@makerbot.com>
   3:src/MightyBoard/shared/LPCPort.hh **** *
   4:src/MightyBoard/shared/LPCPort.hh **** * This program is free software: you can redistribute it and/or modify
   5:src/MightyBoard/shared/LPCPort.hh **** * it under the terms of the GNU General Public License as published by
   6:src/MightyBoard/shared/LPCPort.hh **** * the Free Software Foundation, either version 3 of the License, or
   7:src/MightyBoard/shared/LPCPort.hh **** * (at your option) any later version.
   8:src/MightyBoard/shared/LPCPort.hh **** *
   9:src/MightyBoard/shared/LPCPort.hh **** * This program is distributed in the hope that it will be useful,
  10:src/MightyBoard/shared/LPCPort.hh **** * but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:src/MightyBoard/shared/LPCPort.hh **** * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:src/MightyBoard/shared/LPCPort.hh **** * GNU General Public License for more details.
  13:src/MightyBoard/shared/LPCPort.hh **** *
  14:src/MightyBoard/shared/LPCPort.hh **** * You should have received a copy of the GNU General Public License
  15:src/MightyBoard/shared/LPCPort.hh **** * along with this program.  If not, see <http://www.gnu.org/licenses/>
  16:src/MightyBoard/shared/LPCPort.hh **** */
  17:src/MightyBoard/shared/LPCPort.hh **** 
  18:src/MightyBoard/shared/LPCPort.hh **** #ifndef SHARED_AVR_PORT_HH_
  19:src/MightyBoard/shared/LPCPort.hh **** #define SHARED_AVR_PORT_HH_
  20:src/MightyBoard/shared/LPCPort.hh **** 
  21:src/MightyBoard/shared/LPCPort.hh **** #define __STDC_LIMIT_MACROS
  22:src/MightyBoard/shared/LPCPort.hh **** //#include <stdint.h>
  23:src/MightyBoard/shared/LPCPort.hh **** //#include <util/atomic.h>
  24:src/MightyBoard/shared/LPCPort.hh **** 
  25:src/MightyBoard/shared/LPCPort.hh **** extern "C" {
  26:src/MightyBoard/shared/LPCPort.hh **** 	#include "lpc_types.h"
  27:src/MightyBoard/shared/LPCPort.hh **** 	#include "lpc17xx_gpio.h"
  28:src/MightyBoard/shared/LPCPort.hh **** }
  29:src/MightyBoard/shared/LPCPort.hh **** 
  30:src/MightyBoard/shared/LPCPort.hh **** 
  31:src/MightyBoard/shared/LPCPort.hh **** #define NULL_PORT 0xff
  32:src/MightyBoard/shared/LPCPort.hh **** 
  33:src/MightyBoard/shared/LPCPort.hh **** class LPCPort {
  34:src/MightyBoard/shared/LPCPort.hh **** private:
  35:src/MightyBoard/shared/LPCPort.hh **** 	const uint8_t port_base;
  36:src/MightyBoard/shared/LPCPort.hh **** 	friend class Pin;
  37:src/MightyBoard/shared/LPCPort.hh **** public:
  38:src/MightyBoard/shared/LPCPort.hh **** 	LPCPort();
  39:src/MightyBoard/shared/LPCPort.hh **** 	LPCPort(uint8_t port_base_in);
  40:src/MightyBoard/shared/LPCPort.hh **** 	bool isNull() const;
  41:src/MightyBoard/shared/LPCPort.hh **** 	void setPinDirectionOut(uint8_t pin_index) const;
  42:src/MightyBoard/shared/LPCPort.hh **** 	void setPinDirectionIn(uint8_t pin_index) const;
  43:src/MightyBoard/shared/LPCPort.hh **** 	bool getPin(uint8_t pin_index) const;
  44:src/MightyBoard/shared/LPCPort.hh **** 	void setPinOn(uint8_t pin_index) const;
  45:src/MightyBoard/shared/LPCPort.hh **** 	void setPinOff(uint8_t pin_index) const;
  46:src/MightyBoard/shared/LPCPort.hh **** };
  47:src/MightyBoard/shared/LPCPort.hh **** 
  48:src/MightyBoard/shared/LPCPort.hh **** 
  49:src/MightyBoard/shared/LPCPort.hh **** const LPCPort Port0(0);
 2927              	 .loc 8 49 0
 2928 0002 40F20000 	 movw r0,#:lower16:.LANCHOR15
 2929 0006 C0F20000 	 movt r0,#:upper16:.LANCHOR15
 2930 000a 4FF00001 	 mov r1,#0
 2931 000e FFF7FEFF 	 bl _ZN7LPCPortC1Eh
  50:src/MightyBoard/shared/LPCPort.hh **** const LPCPort Port1(1);
 2932              	 .loc 8 50 0
 2933 0012 40F20000 	 movw r0,#:lower16:.LANCHOR16
 2934 0016 C0F20000 	 movt r0,#:upper16:.LANCHOR16
 2935 001a 4FF00101 	 mov r1,#1
 2936 001e FFF7FEFF 	 bl _ZN7LPCPortC1Eh
  51:src/MightyBoard/shared/LPCPort.hh **** const LPCPort Port2(2);
 2937              	 .loc 8 51 0
 2938 0022 40F20000 	 movw r0,#:lower16:.LANCHOR17
 2939 0026 C0F20000 	 movt r0,#:upper16:.LANCHOR17
 2940 002a 4FF00201 	 mov r1,#2
 2941 002e FFF7FEFF 	 bl _ZN7LPCPortC1Eh
  52:src/MightyBoard/shared/LPCPort.hh **** const LPCPort Port3(3);
 2942              	 .loc 8 52 0
 2943 0032 40F20000 	 movw r0,#:lower16:.LANCHOR18
 2944 0036 C0F20000 	 movt r0,#:upper16:.LANCHOR18
 2945 003a 4FF00301 	 mov r1,#3
 2946 003e FFF7FEFF 	 bl _ZN7LPCPortC1Eh
  53:src/MightyBoard/shared/LPCPort.hh **** const LPCPort Port4(4);
 2947              	 .loc 8 53 0
 2948 0042 40F20000 	 movw r0,#:lower16:.LANCHOR19
 2949 0046 C0F20000 	 movt r0,#:upper16:.LANCHOR19
 2950 004a 4FF00401 	 mov r1,#4
 2951 004e FFF7FEFF 	 bl _ZN7LPCPortC1Eh
  54:src/MightyBoard/shared/LPCPort.hh **** 
  55:src/MightyBoard/shared/LPCPort.hh **** const LPCPort NullPort(0xff);
 2952              	 .loc 8 55 0
 2953 0052 40F20004 	 movw r4,#:lower16:.LANCHOR20
 2954 0056 C0F20004 	 movt r4,#:upper16:.LANCHOR20
 2955 005a 2046     	 mov r0,r4
 2956 005c 4FF0FF01 	 mov r1,#255
 2957 0060 FFF7FEFF 	 bl _ZN7LPCPortC1Eh
  49:src/MightyBoard/shared/Pin.hh **** 		}
  50:src/MightyBoard/shared/Pin.hh **** 		// SREG = oldSREG;
  51:src/MightyBoard/shared/Pin.hh **** 	};
  52:src/MightyBoard/shared/Pin.hh **** 
  53:src/MightyBoard/shared/Pin.hh **** 	void /*Pin::*/setValueOn() const {
  54:src/MightyBoard/shared/Pin.hh **** 		if (is_null)
  55:src/MightyBoard/shared/Pin.hh **** 		 	return;
  56:src/MightyBoard/shared/Pin.hh **** 		// uint8_t oldSREG = SREG;
  57:src/MightyBoard/shared/Pin.hh **** 		// cli();
  58:src/MightyBoard/shared/Pin.hh **** //		PORTx |= pin_mask;
  59:src/MightyBoard/shared/Pin.hh **** 		GPIO_SetValue(port_base, _BV(pin_index));
  60:src/MightyBoard/shared/Pin.hh **** 		// SREG = oldSREG;
  61:src/MightyBoard/shared/Pin.hh **** 	};
  62:src/MightyBoard/shared/Pin.hh **** 
  63:src/MightyBoard/shared/Pin.hh **** 	void /*Pin::*/setValueOff() const {
  64:src/MightyBoard/shared/Pin.hh **** 		// if (is_null)
  65:src/MightyBoard/shared/Pin.hh **** 		// 	return;
  66:src/MightyBoard/shared/Pin.hh **** 		// uint8_t oldSREG = SREG;
  67:src/MightyBoard/shared/Pin.hh **** 		// cli();
  68:src/MightyBoard/shared/Pin.hh **** //		PORTx &= pin_mask_inverted;
  69:src/MightyBoard/shared/Pin.hh **** 		GPIO_ClearValue(port_base, _BV(pin_index));
  70:src/MightyBoard/shared/Pin.hh **** 		// SREG = oldSREG;
  71:src/MightyBoard/shared/Pin.hh **** 	};
  72:src/MightyBoard/shared/Pin.hh **** 	// currently not used:
  73:src/MightyBoard/shared/Pin.hh **** 	//const uint8_t getPinIndex() const { return pin_index; }
  74:src/MightyBoard/shared/Pin.hh **** };
  75:src/MightyBoard/shared/Pin.hh **** 
  76:src/MightyBoard/shared/Pin.hh **** static const Pin NullPin(NullPort, 0);
 2958              	 .loc 7 76 0
 2959 0064 40F20000 	 movw r0,#:lower16:.LANCHOR21
 2960 0068 C0F20000 	 movt r0,#:upper16:.LANCHOR21
 2961 006c 2146     	 mov r1,r4
 2962 006e 4FF00002 	 mov r2,#0
 2963 0072 FFF7FEFF 	 bl _ZN3PinC1ERK7LPCPorth
  57:src/MightyBoard/Motherboard/Host.cc **** Timeout packet_in_timeout;
 2964              	 .loc 1 57 0
 2965 0076 40F20000 	 movw r0,#:lower16:.LANCHOR14
 2966 007a C0F20000 	 movt r0,#:upper16:.LANCHOR14
 2967 007e FFF7FEFF 	 bl _ZN7TimeoutC1Ev
  58:src/MightyBoard/Motherboard/Host.cc **** Timeout cancel_timeout;
 2968              	 .loc 1 58 0
 2969 0082 40F20000 	 movw r0,#:lower16:.LANCHOR10
 2970 0086 C0F20000 	 movt r0,#:upper16:.LANCHOR10
 2971 008a FFF7FEFF 	 bl _ZN7TimeoutC1Ev
  89:src/MightyBoard/Motherboard/Host.cc **** Timeout print_time;
 2972              	 .loc 1 89 0
 2973 008e 40F20000 	 movw r0,#:lower16:.LANCHOR6
 2974 0092 C0F20000 	 movt r0,#:upper16:.LANCHOR6
 2975 0096 FFF7FEFF 	 bl _ZN7TimeoutC1Ev
 2976              	.LBE413:
 2977              	.LBE412:
 2978              	 .loc 1 808 0
 2979 009a 10BD     	 pop {r4,pc}
 2980              	 .cfi_endproc
 2981              	.LFE157:
 2983              	 .section .init_array,"aw",%init_array
 2984              	 .align 2
 2985 0000 00000000 	 .word _GLOBAL__sub_I__ZN4host17packet_in_timeoutE(target1)
 2986              	 .global _ZN4host11cancelBuildE
 2987              	 .global _ZN4host10hard_resetE
 2988              	 .global _ZN4host13do_host_resetE
 2989              	 .global _ZN4host10print_timeE
 2990              	 .global _ZN4host16print_time_hoursE
 2991              	 .global _ZN4host15last_print_lineE
 2992              	 .global _ZN4host18last_print_minutesE
 2993              	 .global _ZN4host16last_print_hoursE
 2994              	 .global _ZN4host10buildStateE
 2995              	 .global _ZN4host12currentStateE
 2996              	 .global _ZN4host10buildStepsE
 2997              	 .global _ZN4host9buildNameE
 2998              	 .global _ZN4host11machineNameE
 2999              	 .global _ZN4host14cancel_timeoutE
 3000              	 .global _ZN4host17packet_in_timeoutE
 3001              	 .weak _ZGVZN4UART11getHostUARTEvE8hostUART
 3002              	 .section .bss._ZGVZN4UART11getHostUARTEvE8hostUART,"awG",%nobits,_ZGVZN4UART11getHostUARTEvE8hostUART,comdat
 3003              	 .align 2
 3006              	_ZGVZN4UART11getHostUARTEvE8hostUART:
 3007 0000 00000000 	 .space 4
 3008              	 .weak _ZZN4UART11getHostUARTEvE8hostUART
 3009              	 .section .bss._ZZN4UART11getHostUARTEvE8hostUART,"awG",%nobits,_ZZN4UART11getHostUARTEvE8hostUART,comdat
 3010              	 .align 2
 3013              	_ZZN4UART11getHostUARTEvE8hostUART:
 3014 0000 00000000 	 .space 77
 3014      00000000 
 3014      00000000 
 3014      00000000 
 3014      00000000 
 3015 004d 000000   	 .section .bss._ZN4host12currentStateE,"aw",%nobits
 3016              	 .set .LANCHOR0,.+0
 3019              	_ZN4host12currentStateE:
 3020 0000 00       	 .space 1
 3021              	 .section .bss._ZN4host15last_print_lineE,"aw",%nobits
 3022              	 .align 2
 3023              	 .set .LANCHOR11,.+0
 3026              	_ZN4host15last_print_lineE:
 3027 0000 00000000 	 .space 4
 3028              	 .section .bss._ZL5Port0,"aw",%nobits
 3029              	 .align 2
 3030              	 .set .LANCHOR15,.+0
 3033              	_ZL5Port0:
 3034 0000 00       	 .space 1
 3035 0001 000000   	 .section .bss._ZN4host16last_print_hoursE,"aw",%nobits
 3036              	 .set .LANCHOR8,.+0
 3039              	_ZN4host16last_print_hoursE:
 3040 0000 00       	 .space 1
 3041              	 .section .bss._ZL5Port1,"aw",%nobits
 3042              	 .align 2
 3043              	 .set .LANCHOR16,.+0
 3046              	_ZL5Port1:
 3047 0000 00       	 .space 1
 3048 0001 000000   	 .section .bss._ZL5Port2,"aw",%nobits
 3049              	 .align 2
 3050              	 .set .LANCHOR17,.+0
 3053              	_ZL5Port2:
 3054 0000 00       	 .space 1
 3055 0001 000000   	 .section .bss._ZN4host13do_host_resetE,"aw",%nobits
 3056              	 .set .LANCHOR12,.+0
 3059              	_ZN4host13do_host_resetE:
 3060 0000 00       	 .space 1
 3061              	 .section .bss._ZN4host11machineNameE,"aw",%nobits
 3062              	 .align 2
 3063              	 .set .LANCHOR2,.+0
 3066              	_ZN4host11machineNameE:
 3067 0000 00000000 	 .space 16
 3067      00000000 
 3067      00000000 
 3067      00000000 
 3068              	 .section .bss._ZN4host11cancelBuildE,"aw",%nobits
 3069              	 .set .LANCHOR1,.+0
 3072              	_ZN4host11cancelBuildE:
 3073 0000 00       	 .space 1
 3074              	 .section .rodata._ZZN4host14getMachineNameEvE18defaultMachineName,"a",%progbits
 3075              	 .align 2
 3076              	 .set .LANCHOR3,.+0
 3079              	_ZZN4host14getMachineNameEvE18defaultMachineName:
 3080 0000 54686520 	 .ascii "The Replicat0r\000"
 3080      5265706C 
 3080      69636174 
 3080      307200
 3081 000f 00       	 .section .bss._ZL5Port3,"aw",%nobits
 3082              	 .align 2
 3083              	 .set .LANCHOR18,.+0
 3086              	_ZL5Port3:
 3087 0000 00       	 .space 1
 3088 0001 000000   	 .section .bss._ZN4host10print_timeE,"aw",%nobits
 3089              	 .align 2
 3090              	 .set .LANCHOR6,.+0
 3093              	_ZN4host10print_timeE:
 3094 0000 00000000 	 .space 16
 3094      00000000 
 3094      00000000 
 3094      00000000 
 3095              	 .section .bss._ZL5Port4,"aw",%nobits
 3096              	 .align 2
 3097              	 .set .LANCHOR19,.+0
 3100              	_ZL5Port4:
 3101 0000 00       	 .space 1
 3102 0001 000000   	 .section .rodata.str1.4,"aMS",%progbits,1
 3103              	 .align 2
 3104              	.LC0:
 3105 0000 52657047 	 .ascii "RepG Build\000"
 3105      20427569 
 3105      6C6400
 3106 000b 00       	 .space 1
 3107              	.LC1:
 3108 000c 68616E64 	 .ascii "handleWriteEeprom (%s:%d)\012\000"
 3108      6C655772 
 3108      69746545 
 3108      6570726F 
 3108      6D202825 
 3109 0027 00       	 .space 1
 3110              	.LC2:
 3111 0028 7372632F 	 .ascii "src/MightyBoard/Motherboard/Host.cc\000"
 3111      4D696768 
 3111      7479426F 
 3111      6172642F 
 3111      4D6F7468 
 3112              	.LC3:
 3113 004c 25782025 	 .ascii "%x %x %c\012\000"
 3113      78202563 
 3113      0A00
 3114 0056 0000     	 .space 2
 3115              	.LC4:
 3116 0058 696E2E69 	 .ascii "in.isStarted() && !in.isFinished() (%s:%d)\012\000"
 3116      73537461 
 3116      72746564 
 3116      28292026 
 3116      26202169 
 3117              	 .section .bss._ZN4host17packet_in_timeoutE,"aw",%nobits
 3118              	 .align 2
 3119              	 .set .LANCHOR14,.+0
 3122              	_ZN4host17packet_in_timeoutE:
 3123 0000 00000000 	 .space 16
 3123      00000000 
 3123      00000000 
 3123      00000000 
 3124              	 .section .bss._ZL8NullPort,"aw",%nobits
 3125              	 .align 2
 3126              	 .set .LANCHOR20,.+0
 3129              	_ZL8NullPort:
 3130 0000 00       	 .space 1
 3131 0001 000000   	 .section .bss._ZN4host14cancel_timeoutE,"aw",%nobits
 3132              	 .align 2
 3133              	 .set .LANCHOR10,.+0
 3136              	_ZN4host14cancel_timeoutE:
 3137 0000 00000000 	 .space 16
 3137      00000000 
 3137      00000000 
 3137      00000000 
 3138              	 .section .bss._ZN4host10hard_resetE,"aw",%nobits
 3139              	 .set .LANCHOR13,.+0
 3142              	_ZN4host10hard_resetE:
 3143 0000 00       	 .space 1
 3144              	 .section .bss._ZN4host18last_print_minutesE,"aw",%nobits
 3145              	 .set .LANCHOR9,.+0
 3148              	_ZN4host18last_print_minutesE:
 3149 0000 00       	 .space 1
 3150              	 .section .bss._ZN4host10buildStepsE,"aw",%nobits
 3151              	 .align 2
 3154              	_ZN4host10buildStepsE:
 3155 0000 00000000 	 .space 4
 3156              	 .section .bss._ZL7NullPin,"aw",%nobits
 3157              	 .align 2
 3158              	 .set .LANCHOR21,.+0
 3161              	_ZL7NullPin:
 3162 0000 00000000 	 .space 5
 3162      00
 3163 0005 000000   	 .section .bss._ZN4host10buildStateE,"aw",%nobits
 3164              	 .set .LANCHOR5,.+0
 3167              	_ZN4host10buildStateE:
 3168 0000 00       	 .space 1
 3169              	 .section .bss._ZN4host9buildNameE,"aw",%nobits
 3170              	 .align 2
 3171              	 .set .LANCHOR4,.+0
 3174              	_ZN4host9buildNameE:
 3175 0000 00000000 	 .space 31
 3175      00000000 
 3175      00000000 
 3175      00000000 
 3175      00000000 
 3176 001f 00       	 .section .bss._ZN4host16print_time_hoursE,"aw",%nobits
 3177              	 .set .LANCHOR7,.+0
 3180              	_ZN4host16print_time_hoursE:
 3181 0000 00       	 .space 1
 3182              	 .text
 3183              	.Letext0:
 3184              	 .file 9 "c:\\program files\\codesourcery\\sourcery_codebench_lite_for_arm_eabi\\bin\\../lib/gcc/arm-none-eabi/4.6.3/../../../../arm-none-eabi/include/stdint.h"
 3185              	 .file 10 "src/MightyBoard/Motherboard/SDCard.hh"
 3186              	 .file 11 "src/MightyBoard/Motherboard/Host.hh"
 3187              	 .file 12 "src/MightyBoard/shared/Types.hh"
 3188              	 .file 13 "src/MightyBoard/Motherboard/Point.hh"
 3189              	 .file 14 "src/MightyBoard/shared/TemperatureSensor.hh"
 3190              	 .file 15 "src/MightyBoard/shared/PID.hh"
 3191              	 .file 16 "src/MightyBoard/shared/Heater.hh"
 3192              	 .file 17 "src/MightyBoard/shared/HeatingElement.hh"
 3193              	 .file 18 "src/MightyBoard/Motherboard/EepromMap.hh"
 3194              	 .file 19 "src/MightyBoard/shared/CoolingFan.hh"
 3195              	 .file 20 "src/MightyBoard/Motherboard/ExtruderBoard.hh"
 3196              	 .file 21 "src/MightyBoard/Motherboard/Cutoff.hh"
 3197              	 .file 22 "src/MightyBoard/Motherboard/Planner.hh"
 3198              	 .file 23 "src/MightyBoard/Motherboard/UtilityScripts.hh"
 3199              	 .file 24 "src/MightyBoard/Motherboard/system/core_cm3.h"
 3200              	 .file 25 "src/MightyBoard/Motherboard/Version.hh"
 3201              	 .file 26 "src/MightyBoard/Motherboard/Command.hh"
DEFINED SYMBOLS
                            *ABS*:00000000 Host.cc
    {standard input}:19     .text._ZN4host20processCommandPacketERK8InPacketR9OutPacket:00000000 $t
    {standard input}:24     .text._ZN4host20processCommandPacketERK8InPacketR9OutPacket:00000000 _ZN4host20processCommandPacketERK8InPacketR9OutPacket
    {standard input}:187    .text._ZN4host12heatShutdownEv:00000000 $t
    {standard input}:192    .text._ZN4host12heatShutdownEv:00000000 _ZN4host12heatShutdownEv
    {standard input}:3016   .bss._ZN4host12currentStateE:00000000 .LANCHOR0
    {standard input}:3069   .bss._ZN4host11cancelBuildE:00000000 .LANCHOR1
    {standard input}:215    .text._ZN4host18handleNextFilenameERK8InPacketR9OutPacket:00000000 $t
    {standard input}:220    .text._ZN4host18handleNextFilenameERK8InPacketR9OutPacket:00000000 _ZN4host18handleNextFilenameERK8InPacketR9OutPacket
    {standard input}:344    .text._ZN4host16handleReadEepromERK8InPacketR9OutPacket:00000000 $t
    {standard input}:349    .text._ZN4host16handleReadEepromERK8InPacketR9OutPacket:00000000 _ZN4host16handleReadEepromERK8InPacketR9OutPacket
    {standard input}:434    .text._ZN4host14getMachineNameEv:00000000 $t
    {standard input}:439    .text._ZN4host14getMachineNameEv:00000000 _ZN4host14getMachineNameEv
    {standard input}:3063   .bss._ZN4host11machineNameE:00000000 .LANCHOR2
    {standard input}:3076   .rodata._ZZN4host14getMachineNameEvE18defaultMachineName:00000000 .LANCHOR3
    {standard input}:509    .text._ZN4host14getMachineNameEv:00000060 $d
    {standard input}:514    .text._ZN4host12getBuildNameEv:00000000 $t
    {standard input}:519    .text._ZN4host12getBuildNameEv:00000000 _ZN4host12getBuildNameEv
    {standard input}:3171   .bss._ZN4host9buildNameE:00000000 .LANCHOR4
    {standard input}:534    .text._ZN4host12getHostStateEv:00000000 $t
    {standard input}:539    .text._ZN4host12getHostStateEv:00000000 _ZN4host12getHostStateEv
    {standard input}:556    .text._ZN4host16startBuildFromSDEv:00000000 $t
    {standard input}:561    .text._ZN4host16startBuildFromSDEv:00000000 _ZN4host16startBuildFromSDEv
    {standard input}:620    .text._ZN4host16startBuildFromSDEv:00000054 $d
    {standard input}:625    .text._ZN4host17startOnboardBuildEh:00000000 $t
    {standard input}:630    .text._ZN4host17startOnboardBuildEh:00000000 _ZN4host17startOnboardBuildEh
    {standard input}:662    .text._ZN4host10pauseBuildEb:00000000 $t
    {standard input}:667    .text._ZN4host10pauseBuildEb:00000000 _ZN4host10pauseBuildEb
    {standard input}:3164   .bss._ZN4host10buildStateE:00000000 .LANCHOR5
    {standard input}:3090   .bss._ZN4host10print_timeE:00000000 .LANCHOR6
    {standard input}:718    .text._ZN4host14startPrintTimeEv:00000000 $t
    {standard input}:723    .text._ZN4host14startPrintTimeEv:00000000 _ZN4host14startPrintTimeEv
    {standard input}:3177   .bss._ZN4host16print_time_hoursE:00000000 .LANCHOR7
    {standard input}:751    .text._ZN4host28handleBuildStartNotificationER19CircularBufferTemplIhE:00000000 $t
    {standard input}:756    .text._ZN4host28handleBuildStartNotificationER19CircularBufferTemplIhE:00000000 _ZN4host28handleBuildStartNotificationER19CircularBufferTemplIhE
    {standard input}:785    .text._ZN4host28handleBuildStartNotificationER19CircularBufferTemplIhE:0000001a $d
    {standard input}:791    .text._ZN4host28handleBuildStartNotificationER19CircularBufferTemplIhE:00000020 $t
    {standard input}:3104   .rodata.str1.4:00000000 .LC0
    {standard input}:1002   .text._ZN4host15managePrintTimeEv:00000000 $t
    {standard input}:1007   .text._ZN4host15managePrintTimeEv:00000000 _ZN4host15managePrintTimeEv
    {standard input}:1041   .text._ZN4host12getPrintTimeERhS0_:00000000 $t
    {standard input}:1046   .text._ZN4host12getPrintTimeERhS0_:00000000 _ZN4host12getPrintTimeERhS0_
    {standard input}:1082   .text._ZN4host13stopPrintTimeEv:00000000 $t
    {standard input}:1087   .text._ZN4host13stopPrintTimeEv:00000000 _ZN4host13stopPrintTimeEv
    {standard input}:3036   .bss._ZN4host16last_print_hoursE:00000000 .LANCHOR8
    {standard input}:3145   .bss._ZN4host18last_print_minutesE:00000000 .LANCHOR9
    {standard input}:1127   .text._ZN4host9stopBuildEv:00000000 $t
    {standard input}:1132   .text._ZN4host9stopBuildEv:00000000 _ZN4host9stopBuildEv
    {standard input}:3133   .bss._ZN4host14cancel_timeoutE:00000000 .LANCHOR10
    {standard input}:3023   .bss._ZN4host15last_print_lineE:00000000 .LANCHOR11
    {standard input}:3056   .bss._ZN4host13do_host_resetE:00000000 .LANCHOR12
    {standard input}:1189   .text._ZN4host27handleBuildStopNotificationEh:00000000 $t
    {standard input}:1194   .text._ZN4host27handleBuildStopNotificationEh:00000000 _ZN4host27handleBuildStopNotificationEh
    {standard input}:1232   .text._ZN4host26processExtruderQueryPacketERK8InPacketR9OutPacket:00000000 $t
    {standard input}:1237   .text._ZN4host26processExtruderQueryPacketERK8InPacketR9OutPacket:00000000 _ZN4host26processExtruderQueryPacketERK8InPacketR9OutPacket
    {standard input}:1284   .text._ZN4host26processExtruderQueryPacketERK8InPacketR9OutPacket:0000002c $d
    {standard input}:1324   .text._ZN4host26processExtruderQueryPacketERK8InPacketR9OutPacket:00000078 $t
    {standard input}:1677   .text._ZN4host26processExtruderQueryPacketERK8InPacketR9OutPacket:00000288 $d
    {standard input}:1688   .text._ZN4host18processQueryPacketERK8InPacketR9OutPacket:00000000 $t
    {standard input}:1693   .text._ZN4host18processQueryPacketERK8InPacketR9OutPacket:00000000 _ZN4host18processQueryPacketERK8InPacketR9OutPacket
    {standard input}:1748   .text._ZN4host18processQueryPacketERK8InPacketR9OutPacket:00000032 $d
    {standard input}:1781   .text._ZN4host18processQueryPacketERK8InPacketR9OutPacket:0000006a $t
    {standard input}:3107   .rodata.str1.4:0000000c .LC1
    {standard input}:3112   .rodata.str1.4:0000004c .LC3
    {standard input}:2452   .text._ZN4host18processQueryPacketERK8InPacketR9OutPacket:000004f4 $d
    {standard input}:2458   .text._ZN4host12runHostSliceEv:00000000 $t
    {standard input}:2463   .text._ZN4host12runHostSliceEv:00000000 _ZN4host12runHostSliceEv
    {standard input}:3006   .bss._ZGVZN4UART11getHostUARTEvE8hostUART:00000000 _ZGVZN4UART11getHostUARTEvE8hostUART
    {standard input}:3013   .bss._ZZN4UART11getHostUARTEvE8hostUART:00000000 _ZZN4UART11getHostUARTEvE8hostUART
    {standard input}:3139   .bss._ZN4host10hard_resetE:00000000 .LANCHOR13
    {standard input}:3119   .bss._ZN4host17packet_in_timeoutE:00000000 .LANCHOR14
    {standard input}:3115   .rodata.str1.4:00000058 .LC4
    {standard input}:2901   .text._ZN4host12runHostSliceEv:00000364 $d
    {standard input}:2908   .text._GLOBAL__sub_I__ZN4host17packet_in_timeoutE:00000000 $t
    {standard input}:2912   .text._GLOBAL__sub_I__ZN4host17packet_in_timeoutE:00000000 _GLOBAL__sub_I__ZN4host17packet_in_timeoutE
    {standard input}:3030   .bss._ZL5Port0:00000000 .LANCHOR15
    {standard input}:3043   .bss._ZL5Port1:00000000 .LANCHOR16
    {standard input}:3050   .bss._ZL5Port2:00000000 .LANCHOR17
    {standard input}:3083   .bss._ZL5Port3:00000000 .LANCHOR18
    {standard input}:3097   .bss._ZL5Port4:00000000 .LANCHOR19
    {standard input}:3126   .bss._ZL8NullPort:00000000 .LANCHOR20
    {standard input}:3158   .bss._ZL7NullPin:00000000 .LANCHOR21
    {standard input}:2984   .init_array:00000000 $d
    {standard input}:3072   .bss._ZN4host11cancelBuildE:00000000 _ZN4host11cancelBuildE
    {standard input}:3142   .bss._ZN4host10hard_resetE:00000000 _ZN4host10hard_resetE
    {standard input}:3059   .bss._ZN4host13do_host_resetE:00000000 _ZN4host13do_host_resetE
    {standard input}:3093   .bss._ZN4host10print_timeE:00000000 _ZN4host10print_timeE
    {standard input}:3180   .bss._ZN4host16print_time_hoursE:00000000 _ZN4host16print_time_hoursE
    {standard input}:3026   .bss._ZN4host15last_print_lineE:00000000 _ZN4host15last_print_lineE
    {standard input}:3148   .bss._ZN4host18last_print_minutesE:00000000 _ZN4host18last_print_minutesE
    {standard input}:3039   .bss._ZN4host16last_print_hoursE:00000000 _ZN4host16last_print_hoursE
    {standard input}:3167   .bss._ZN4host10buildStateE:00000000 _ZN4host10buildStateE
    {standard input}:3019   .bss._ZN4host12currentStateE:00000000 _ZN4host12currentStateE
    {standard input}:3154   .bss._ZN4host10buildStepsE:00000000 _ZN4host10buildStepsE
    {standard input}:3174   .bss._ZN4host9buildNameE:00000000 _ZN4host9buildNameE
    {standard input}:3066   .bss._ZN4host11machineNameE:00000000 _ZN4host11machineNameE
    {standard input}:3136   .bss._ZN4host14cancel_timeoutE:00000000 _ZN4host14cancel_timeoutE
    {standard input}:3122   .bss._ZN4host17packet_in_timeoutE:00000000 _ZN4host17packet_in_timeoutE
    {standard input}:3003   .bss._ZGVZN4UART11getHostUARTEvE8hostUART:00000000 $d
    {standard input}:3010   .bss._ZZN4UART11getHostUARTEvE8hostUART:00000000 $d
    {standard input}:3020   .bss._ZN4host12currentStateE:00000000 $d
    {standard input}:3022   .bss._ZN4host15last_print_lineE:00000000 $d
    {standard input}:3029   .bss._ZL5Port0:00000000 $d
    {standard input}:3033   .bss._ZL5Port0:00000000 _ZL5Port0
    {standard input}:3040   .bss._ZN4host16last_print_hoursE:00000000 $d
    {standard input}:3042   .bss._ZL5Port1:00000000 $d
    {standard input}:3046   .bss._ZL5Port1:00000000 _ZL5Port1
    {standard input}:3049   .bss._ZL5Port2:00000000 $d
    {standard input}:3053   .bss._ZL5Port2:00000000 _ZL5Port2
    {standard input}:3060   .bss._ZN4host13do_host_resetE:00000000 $d
    {standard input}:3062   .bss._ZN4host11machineNameE:00000000 $d
    {standard input}:3073   .bss._ZN4host11cancelBuildE:00000000 $d
    {standard input}:3075   .rodata._ZZN4host14getMachineNameEvE18defaultMachineName:00000000 $d
    {standard input}:3079   .rodata._ZZN4host14getMachineNameEvE18defaultMachineName:00000000 _ZZN4host14getMachineNameEvE18defaultMachineName
    {standard input}:3082   .bss._ZL5Port3:00000000 $d
    {standard input}:3086   .bss._ZL5Port3:00000000 _ZL5Port3
    {standard input}:3089   .bss._ZN4host10print_timeE:00000000 $d
    {standard input}:3096   .bss._ZL5Port4:00000000 $d
    {standard input}:3100   .bss._ZL5Port4:00000000 _ZL5Port4
    {standard input}:3103   .rodata.str1.4:00000000 $d
    {standard input}:3110   .rodata.str1.4:00000028 .LC2
    {standard input}:3118   .bss._ZN4host17packet_in_timeoutE:00000000 $d
    {standard input}:3125   .bss._ZL8NullPort:00000000 $d
    {standard input}:3129   .bss._ZL8NullPort:00000000 _ZL8NullPort
    {standard input}:3132   .bss._ZN4host14cancel_timeoutE:00000000 $d
    {standard input}:3143   .bss._ZN4host10hard_resetE:00000000 $d
    {standard input}:3149   .bss._ZN4host18last_print_minutesE:00000000 $d
    {standard input}:3151   .bss._ZN4host10buildStepsE:00000000 $d
    {standard input}:3157   .bss._ZL7NullPin:00000000 $d
    {standard input}:3161   .bss._ZL7NullPin:00000000 _ZL7NullPin
    {standard input}:3168   .bss._ZN4host10buildStateE:00000000 $d
    {standard input}:3170   .bss._ZN4host9buildNameE:00000000 $d
    {standard input}:3181   .bss._ZN4host16print_time_hoursE:00000000 $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
_ZNK6Packet5read8Eh
_ZN6sdcard11isCapturingEv
_ZN6sdcard13capturePacketERK6Packet
_ZN9OutPacket7append8Eh
_ZN6sdcard9isPlayingEv
_ZN7utility9isPlayingEv
_ZN7command4pushEh
_ZN7command20getRemainingCapacityEv
_ZN6sdcard14directoryResetEv
_ZN6sdcard18directoryNextEntryEPchPh
_ZNK6Packet6read16Eh
_ZN6eeprom10getEeprom8Eth
_ZN6sdcard13startPlaybackEPc
_ZN6Heater22set_target_temperatureEi
_ZN7command5resetEv
_ZN8steppers5resetEv
_ZN7planner5abortEv
_ZN11Motherboard11motherboardE
_ZN7utility13startPlaybackEh
_ZN7command8isPausedEv
_ZN7command5pauseEb
_ZN7Timeout5pauseEb
_ZN7Timeout5startEm
strcmp
strcpy
_ZN7command15clearLineNumberEv
_ZN7Timeout10hasElapsedEv
_ZN7Timeout17getCurrentElapsedEv
_ZN7TimeoutC1Ev
_ZN7command13getLineNumberEv
_ZN9OutPacket8append16Et
_ZN6Heater23get_current_temperatureEv
_ZN6Heater30has_reached_target_temperatureEv
_ZN6Heater19get_set_temperatureEv
_ZN6Heater10has_failedEv
_ZN6Heater11GetFailModeEv
_ZN6Heater15getPIDErrorTermEv
_ZN6Heater15getPIDDeltaTermEv
_ZN6Heater16getPIDLastOutputEv
_ZN11Motherboard13indicateErrorEi
_ZN9OutPacket8append32Em
_ZN7planner11getPositionEv
_ZNK5PointixEj
_ZN8steppers16getEndstopStatusEv
_ZN6sdcard12startCaptureEPc
_ZN6sdcard13finishCaptureEv
_ZN6sdcard5resetEv
_ZN8steppers9isRunningEv
_ZN7command7isEmptyEv
xprintf
_ZN6eeprom10setEeprom8Eth
_ZN11Motherboard14GetErrorStatusEv
__cxa_guard_acquire
_ZN4UARTC1Eh18communication_mode
__cxa_guard_release
_Z5resetb
_ZN7Timeout5abortEv
_ZN6Packet5resetEv
_ZN8InPacket5resetEv
_ZN7LPCPortC1Eh
_ZN3PinC1ERK7LPCPorth
GPIO_ClearValue
_ZN9OutPacket5resetEv
_Z18processDebugPacketRK8InPacketR9OutPacket
_ZN4UART9beginSendEv
